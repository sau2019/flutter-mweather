(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{427:function(n,e,r){var o,i;o=[r(3),r(346),r(4),r(7),r(6),r(44),r(2017)],void 0===(i=function(n,e,r,o,i,t,a){"use strict";return new(e.extend({SERVICE_NAME:"branchIo",init:function(){var n=r.branchIoKey;if(n){var e={tracking_disabled:!0},c=function(n,e){if(n)window.marvel.logger.error("[BranchIoController] Failure: Error returned in callback: ",n);else if(e&&e.data_parsed){var r=e.data_parsed;if(!0===r["+clicked_branch_link"]){var i={branchIoReferringLink:"branchIoReferringLink:"+(r["~referring_link"]||"unknown"),branchIoMarketingTitle:"branchIoMarketingTitle:"+(r.$marketing_title||"unknown"),branchIoCampaign:"branchIoCampaign:"+(r["~campaign"]||"unknown"),branchIoChannel:"branchIoChannel:"+(r["~channel"]||"unknown"),branchIoIsFirstSession:"branchIoIsFirstSession:"+(r["+is_first_session"]||"unknown"),branchIoRemixablePostCpid:"branchIoRemixablePostCpid:"+(r.remixable_post_cpid||"unknown")},t="unknown";window.marvel&&window.marvel._siteSection&&(t=window.marvel._siteSection),o.trackEvent("branchIo:referredFromBranchLink",i,t),window.marvel.logger.debug("[BranchIoController] Success: Tracked BranchIo Link Referral")}}else window.marvel.logger.error("[BranchIoController] Failure: No parseable data.")};i.loadIMS().then(function(){a.init(n,e,c),t.isLoadedAndConsented().then(function(n){n&&(a.disableTracking(!1),i.isValid().then(function(){return this._setIdentityForLoggedInUser().catch((function(n){window.marvel.logger.warn("Unexpected failure setting identity with branch!",n)}))}.bind(this)))}.bind(this),function(n){window.marvel.logger.error("[BranchIOController] Unexpected error when attempting to get GDPR consent!",n)}.bind(this))}.bind(this)).done()}else window.marvel.logger.error("[BranchIoController] Failure: No API key found")},_setIdentityForLoggedInUser:function(){var e=i.getProfile();return e&&e.userId&&"US"===e.countryCode&&"type1"===e.account_type?this._hashUserId(e.userId).then((function(n){n&&a.setIdentity(n)})):n()},_hashUserId:function(e){return n.Promise((function(n,r){var o=window.crypto&&window.crypto.subtle&&window.crypto.subtle.digest,i=window.TextEncoder&&window.TextEncoder.prototype.encode,t=window.Promise;if(o&&i&&t){var a=e.replace(/@AdobeID$/,""),c=(new TextEncoder).encode(a);window.crypto.subtle.digest("SHA-256",c).then((function(e){var r=new Uint8Array(e),o=new Array(e.length);r.forEach((function(n,e){var r=Number(n).toString(16);o[e]=1===r.length?"0"+r:r})),n(o.join(""))}),r)}else n(null)}))}}))}.apply(e,o))||(n.exports=i)}}]);
//# sourceMappingURL=6-8b0ce0e9.js.map