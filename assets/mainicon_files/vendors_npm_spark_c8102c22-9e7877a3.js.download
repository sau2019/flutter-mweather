(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[31],{"2Srg":function(e,t,r){var n,o=t,a=r("oAGj"),i=r("cmoc"),l=r("cYVN");o.ImageRoleData=(n=function(e,t,r){l.RoleData.call(this,e,a.clone(t),a.clone(r))},a.defineClass({name:"ImageRoleData",ctor:n,superName:"RoleData",statics:{getImageRoleData:function(e){return e instanceof i.FrameForma?new n(e,[],{}):null}}}),n)},"2wfq":function(e,t,r){r("oAGj")},"3v9D":function(e,t,r){var n,o,a,i,l=t,u=r("oAGj"),s=r("SpAV"),c=r("CaSj"),h=r("FNB+"),g=r("6ZWm"),f=r("tQF8"),p=r("TP4q"),d=r("v/sv"),m=r("bSZx"),S=r("4mVB"),v=r("iCxV"),F=r("Dq5S"),I=r("uxH+"),R=r("8t9B"),C=r("ThKb"),T=r("sIWg");l.LayoutSuggester=(n=function(){this.scoringWeights_=null,this.layoutTypeModel_=null,this.group_=null},u.defineClass({name:"LayoutSuggester",ctor:n,superName:"CoreObject",statics:{KIND:{get:function(){return"LayoutSuggester"}},createContentAwareSuggestions:function(e){var t;return(t=u.opt(u.as(e.controller,I.RootController),(function(e){return e.getGridController()})))?n.init_abc1(t.gridForma).createSuggestions(!0,!1,!1):[]}},props:{init_abc1:function(e,t){void 0===t&&(t=null);var r=u.clone(e.filterWithCallback((function(e){return e.isBackgroundImage()}),h.FormaTraversal.JustChildren)),n=u.clone(e.filterWithCallback((function(e){return null!=e.controller&&e.controller.floating}),h.FormaTraversal.JustChildren));this.layoutItems_=r.map((function(e){return[F.LayoutItem.init_b14a(e)]}),this),this.imageCount_=this.layoutItems_.length;var o=n.map((function(e){return F.LayoutItem.init_b14a(e)}),this);this.layoutItems_.push(u.clone(o)),this.floatingCount_=o.length,s.CoreAssert.isTrue(null!=e.parent,void 0,"LayoutSuggester.init","LayoutSuggester.swift",40),this.scoringWeights_=u.clone(t),this.gridFrame_=e.frame,this.group_=e},init_cb42:function(e,t){void 0===t&&(t=null),this.layoutItems_=[];for(var r=[],n=u.iter(e.layoutItems);!n.done;n.next()){var o=n.value;o.type==F.ItemContentType.Image&&this.layoutItems_.push([o]),o.type==F.ItemContentType.Floating&&r.push(o)}this.imageCount_=this.layoutItems_.length,this.floatingCount_=r.length,this.layoutItems_.push(u.clone(r)),this.scoringWeights_=u.clone(t),this.gridFrame_=e.gridFrame},layoutTypeModel:{get:function(){return this.layoutTypeModel_},set:function(e){this.layoutTypeModel_=e}},createSuggestions:function(e,t,r,n,o){if(void 0===e&&(e=!0),void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=!1),void 0===o&&(o=1),this.imageCount_<1)return[];var a=[];return e&&u.append(a,this.createContentAwareSuggestions(r,o,n)),t&&u.append(a,this.createFixedGridSuggestions(r,o)),u.sortInPlace(a,(function(e,t){return e.score>t.score})),a},createEqualSizeSuggestions:function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=1),this.imageCount_<1?[]:this.getEqualSizeGridSuggestions(e,t)},createFixedGridSuggestions:function(e,t){void 0===t&&(t=1);var r=this;if(this.imageCount_<1)return[];for(var n=u.clone(e&&this.floatingCount_>=1?this.layoutItems_:this.layoutItems_.slice(0,this.imageCount_)),o=n.length,a=u.clone(c.DesignSuggester.getPermutations(o,350)),i=null,l=-1e6,s=u.toArray(u.range(1,o,!0)).map((function(e){return r.getFixedGrids(o,e,!1)}),this),h=u.toArray(u.range(1,o,!0)).map((function(e){return r.getFixedGrids(o,e,!0)}),this),g=u.iter(a);!g.done;g.next()){var f=g.value.map((function(e){return n[e]}),this),p=this.fillFixedGrids(o,[s,h],u.clone(f));p.score>l&&(i=p.suggestion,l=p.score)}return[i]},getEqualSizeGridSuggestions:function(e,t){void 0===t&&(t=1);for(var r=u.clone(e&&this.floatingCount_>=1?this.layoutItems_:this.layoutItems_.slice(0,this.imageCount_)),n=r.length,o=[],a=u.iter(u.range(1,n,!0));!a.done;a.next()){var i=a.value,l=i;if(n%i==0){var s=u.toInt(n/i),h=u.clone(this.getGrids(l,s)),g=u.clone(c.DesignSuggester.getPermutations(n,1))[0].map((function(e){return r[e]}),this),f=g.map((function(e){return e[0]}),this),d=this.createGridStyle(u.clone(h),u.clone(g),"equal_size_layout_"+l+"_"+s),S=new p.GridScore(d,this.gridFrame_,u.clone(f),null,!1,u.clone(this.scoringWeights_)),v=new m.GridSuggestion(void 0,d,S);o.push(v)}}return u.sortInPlace(o,(function(e,t){return e.score>t.score})),o.slice(0,Math.min(o.length,t))},getGrids:function(e,t){for(var r=1/u.toDouble(e),n=1/u.toDouble(t),o=[],a=u.iter(u.range(0,e,!1));!a.done;a.next())for(var i=a.value,l=u.iter(u.range(0,t,!1));!l.done;l.next()){var s=l.value,c=u.toDouble(i)*r,h=u.toDouble(s)*n,g=u.toDouble(i+1)*r,p=u.toDouble(s+1)*n;o.push(new f.GridCell(new T.TheoRect(c,h,g,p)))}return o},createContentAwareSuggestions:function(e,t,r){if(void 0===t&&(t=1),void 0===r&&(r=!1),this.imageCount_<1)return[];for(var n=u.clone(e&&this.floatingCount_>=1?this.layoutItems_:this.layoutItems_.slice(0,this.imageCount_)),o=n.length,a=this.gridFrame_.aspectRatio,i=[],l=Math.max(200-25*o,25),s=u.clone(c.DesignSuggester.getPermutations(o,l)),h=[],g=[],f=[],p=[],d=[],m=[],S=u.iter(u.toSequence(s));!S.done;S.next()){var v=S.value,F=v.offset,I=v.element.map((function(e){return n[e]}),this),R=this.generateContentAwareGrids(o,u.clone(I),a,r);u.append(h,R.heights),u.append(g,R.widths),u.append(f,R.scores),u.append(p,R.orders),u.append(d,R.flipDimensions);for(var C=u.iter(u.range(0,R.scores.length,!1));!C.done;C.next())m.push(F)}for(var T=u.sort(f),_=0;i.length<t&&_<T.length;){for(var y=T[T.length-1-_],L=u.indexOf(f,y),D=u.clone(s[m[L]]).map((function(e){return n[e]}),this),A=u.clone(h[L]),x=u.clone(p[L]),M=u.clone(g[L]),b=d[L],E=A.map((function(e){return 1/e}),this),G=this.buildBestContentAwareGrid(u.clone(D),u.clone(M),a,u.clone(x),b,u.clone(E),r),k=1,N=u.iter(i);!N.done;N.next()){var P=N.value;if((k=Math.min(k,P.gridStyle.similarity(G.gridStyle)))<.05)break}k>.05&&i.push(G),_+=1}return i},createGridStyle:function(e,t,r){var n=S.GridStyle.init_bf40(r,void 0,u.clone(e)),o=u.clone(this.getGridCellFormaMapping(u.clone(e),u.clone(t)));return n.forma=this.group_,n.setFormaMapping(u.clone(o)),n},getGridCellFormaMapping:function(e,t){for(var r={},n=u.iter(u.toSequence(t));!n.done;n.next())for(var o=n.value,a=o.offset,i=o.element,l=u.iter(i);!l.done;l.next())r[l.value.id]=e[a];return r},fillFixedGrids:function(e,t,r){for(var n=null,o=-1e6,a=r.map((function(e){return e[0]}),this),i=u.iter(u.stride(0,e,1));!i.done;i.next())for(var l=i.value,s=u.iter(t);!s.done;s.next())for(var c=s.value,h=u.iter(c[l]);!h.done;h.next()){var g=h.value,f=this.createGridStyle(u.clone(g),u.clone(r),"Test Layout"),d=new p.GridScore(f,this.gridFrame_,u.clone(a),null,!1,u.clone(this.scoringWeights_)),S=d.score;S>o&&(n=new m.GridSuggestion(void 0,f,d),o=S)}return{score:o,suggestion:n}},generateContentAwareGrids:function(e,t,r,n){for(var o=[],a=[],i=[],l=[],s=[],c=u.iter([!1,!0]);!c.done;c.next())for(var h=c.value,g=u.iter(u.stride(1,Math.min(6,e+1),1));!g.done;g.next()){for(var f=g.value,d=u.toArray(u.range(1,f,!0)).map((function(e){return u.toDouble(e)/u.toDouble(f)}),this),m=this.buildCellArray(u.clone(d),u.clone(t),h?1/r:r,void 0,h,void 0,n),S=u.clone(m.heights),v=u.clone(m.order),F=[],I=u.repeat(0,f),R=0;R<10;){var C=u.toArray(u.range(0,f,!1)).map((function(e){return 1/(u.toDouble(f)*u.toDouble(S[e]))+I[e]}),this),T=1/C.reduce((function(e,t){return e+t}),0);F=C.map((function(e){return e*T}),this);for(var _=!1,y=u.iter(u.range(0,F.length,!1));!y.done;y.next()){var L=y.value;F[L]<.1&&(I[L]+=.1,_=!0)}for(var D=0,A=u.iter(u.range(0,F.length,!1));!A.done;A.next()){var x=A.value;F[x]+=D,D=F[x]}if(F[F.length-1]=1,!_)break;R+=1}for(var M=this.buildCellArray(u.clone(F),u.clone(t),h?1/r:r,u.clone(v),h,void 0,n),b=u.clone(M.heights),E=b.map((function(e){return 1/e}),this),G=this.buildCellArray(u.clone(F),u.clone(t),h?1/r:r,u.clone(v),h,u.clone(E),n),k=[],N=u.iter(t);!N.done;N.next()){var P=N.value;u.append(k,P)}var O=u.clone(this.getGridCellFormaMapping(u.clone(G.cells),u.clone(t))),W=new p.GridScore(void 0,this.gridFrame_,u.clone(k),null,!0,u.clone(this.scoringWeights_),u.clone(O),u.clone(G.cells));a.push(u.clone(F)),o.push(u.clone(b)),i.push(W.score),l.push(u.clone(v)),s.push(h)}var w=u.sort(i);return{widths:a,heights:o,orders:l,scores:i,flipDimensions:s,maxScore:w[w.length-1]}},buildBestContentAwareGrid:function(e,t,r,n,o,a,i){var l=this.buildCellArray(u.clone(t),u.clone(e),o?1/r:r,u.clone(n),o,u.clone(a),i),s=u.clone(l.cells),c=u.clone(this.snapBounds(u.clone(s),this.gridFrame_.size,o)),h=this.createGridStyle(u.clone(c),u.clone(e),S.GridStyle.BALANCED_LAYOUT_NAME);h.cropType=i?g.CropType.FillFocus:g.CropType.FitBorder;for(var f=[],d=u.iter(e);!d.done;d.next()){var v=d.value;u.append(f,v)}var F=new p.GridScore(h,this.gridFrame_,u.clone(f),null,!0,u.clone(this.scoringWeights_));return new m.GridSuggestion(this.group_,h,F)},buildCellArray:function(e,t,r,n,o,a,i){var l,s,c;void 0===n&&(n=null),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===i&&(i=!1);var h=null;null==n&&(h=[]);for(var g,p=u.repeat(0,e.length),d=[],m=0,S=u.iter(u.toSequence(t));!S.done;S.next()){var v=S.value,I=v.offset,R=v.element;if(null==n){var C=u.sort(p);g=u.indexOf(p,C[0]),h.push(g)}else g=n[I];var _,y,L=e[g];if(m=0==g?0:e[g-1],1==R.length&&R[0].type==F.ItemContentType.Image){var D=i&&null!=R[0].focusRegion?R[0].focusRegion.width:(l=R[0].width)||null!=l?l:1,A=i&&null!=R[0].focusRegion?R[0].focusRegion.height:(s=R[0].height)||null!=s?s:1;_=1/(o?u.toDouble(A)/u.toDouble(D):u.toDouble(D)/u.toDouble(A))*(L-m)*r}else{var x,M;if(null!=(x=u.opt(u.opt(u.opt(R[0].forma,(function(e){return e.parent})),(function(e){return e.bounds})),(function(e){return e.width})))&&null!=(M=u.opt(u.opt(u.opt(R[0].forma,(function(e){return e.parent})),(function(e){return e.bounds})),(function(e){return e.height})))){for(var b=0,E=u.iter(R);!E.done;E.next()){var G=E.value;b+=(c=u.opt(G.textInfo,(function(e){return e.textLength})))||null!=c?c:0}(_=this.getTextCellHeight(R.length,u.toDouble(b),m*x,L*x,x,M)/M)<.15&&(_=.15)}else _=(L-m)*r}null!=(y=u.opt(a,(function(e){return e[g]})))&&1-(_*=y)<.001&&(_=1);var k=null;k=o?new f.GridCell(new T.TheoRect(p[g],m,_+p[g],L)):new f.GridCell(new T.TheoRect(m,p[g],L,_+p[g])),d.push(k),p[g]=_+p[g]}return{cells:d,heights:p,order:null==h?n:h}},snapBounds:function(e,t,r,n){void 0===n&&(n=60);var o=e.map((function(e){return e.clone()}),this),a=[];e.forEach((function(e){return a.push(e)}));var i=[];if(r)for(var l=u.iter(u.range(0,a.length,!1));!l.done;l.next()){g=l.value,f=a[g],i.push(f);var s=f.bounds.maxX;if(s<1)for(var c=u.iter(u.range(g+1,a.length,!1));!c.done;c.next())if(S=c.value,v=(m=e[g]).bounds,Math.abs(m.bounds.maxX-s)*t.width<n&&1!=m.bounds.maxX&&m.bounds.maxX!=s&&(m=m.copyTo(new T.TheoRect(v.minX,v.minY,s,v.maxY)),a[S]=m),Math.abs(m.bounds.minX-s)*t.width<n&&0!=m.bounds.minX&&m.bounds.minX!=s&&(m=m.copyTo(new T.TheoRect(s,v.minY,v.maxX,v.maxY)),a[S]=m),m.bounds.width<.05)return o}else for(var h=u.iter(u.range(0,a.length,!1));!h.done;h.next()){var g=h.value,f=a[g];i.push(f);var p=f.bounds.maxY;if(p<1)for(var d=u.iter(u.range(g+1,a.length,!1));!d.done;d.next()){var m,S=d.value,v=(m=a[S]).bounds;if(Math.abs(m.bounds.maxY-p)*t.height<n&&1!=m.bounds.maxY&&m.bounds.maxY!=p&&(m=m.copyTo(new T.TheoRect(v.minX,v.minY,v.maxX,p)),a[S]=m),Math.abs(m.bounds.minY-p)*t.height<n&&0!=m.bounds.minY&&m.bounds.minY!=p&&(m=m.copyTo(new T.TheoRect(v.minX,p,v.maxX,v.maxY)),a[S]=m),m.bounds.height<.05)return o}}return i},getTextCellHeight:function(e,t,r,n,o,a){var i=.13358679,l=-.0261477,s=-.11470111,c=.03862264,h=-.02888805,g=.00561106,f=.03671017,p=.13522773,d=-.0499348,m=.02618676,S=1043.48108,v=3.14978552,F=1.15001079,I=167.10292,R=.639915899,C=.0844010175,T=.0901829377,_=.517425544,y=.44141582,L=78.7709665,D=248.39949567,A=2.99889961,x=1.20115851,M=260.27180508,b=.48002452,E=.27798828,G=.28644367,k=.49969626,N=.49655603,P=117.5756354,O=u.toDouble(this.floatingCount_),W=r,w=n,H=.6568033208493654;return H+=(a-S)/D*i,H+=(O-v)/A*l,H+=(u.toDouble(this.imageCount_)-F)/x*s,H+=(W-I)/M*c,H+=((1==e?1:0)-R)/b*h,H+=((3==e?1:0)-C)/E*g,H+=((e>3?1:0)-T)/G*f,H+=(u.toDouble(e)/O-_)/k*p,H+=((w-W)/o-y)/N*d,H+=(t-L)/P*m,H*=1e3},getFixedGrids:function(e,t,r){if(t>e)return[];for(var n=u.toArray(u.range(0,t,!0)).map((function(e){return u.toDouble(e+1)/u.toDouble(t)}),this),o=[u.repeat(1,t)],a=u.iter(u.range(t,e,!1));!a.done;a.next()){for(var i=[],l=u.iter(o);!l.done;l.next())for(var s=l.value,c=u.iter(u.range(0,t,!1));!c.done;c.next()){var h=c.value,g=s.concat();g[h]+=1,i.push(u.clone(g))}o=u.clone(i)}u.shuffleInPlace(o),o=u.clone(o.slice(0,Math.min(350,o.length)));for(var p=[],d=u.iter(o);!d.done;d.next()){for(var m=d.value,S=[],v=u.iter(u.toSequence(m));!v.done;v.next())for(var F=v.value,I=F.offset,R=F.element,C=0==I?0:n[I-1],_=n[I],y=0,L=u.iter(u.stride(1,u.toDouble(R+1),1));!L.done;L.next()){var D=L.value;r?S.push(new f.GridCell(new T.TheoRect(y,C,D/u.toDouble(R),_))):S.push(new f.GridCell(new T.TheoRect(C,y,_,D/u.toDouble(R)))),y=D/u.toDouble(R)}p.push(u.clone(S))}return p},createLayoutIdFeatures:function(e,t,r,n,o){var a=1==n?1:0,i=2==n?1:0,l=3==n?1:0,s=n>3?1:0,c=1==r?1:0,h=2==r?1:0,g=3==r?1:0,f=r>3?1:0,p=Math.atan2(t,e),d=e*t,m=0,S=0,v=0;if(o.length>0){m=o.reduce((function(e,t){return e+t}),0)/u.toDouble(o.length);var F=u.sort(o);v=F[F.length-1],S=F[0]}var I=[e,t,u.toDouble(r),u.toDouble(n),a,i,l,s,c,h,g,f,m,S,v,d,p];return new C.TheoMatrix([I])},predictLayoutIds:function(e,t){var r=u.opt(this.group_,(function(e){return e.root}));if(this.layoutTypeModel_=u.opt(r,(function(e){return e.page.layoutLibrary.layoutSuggestionModel})),null==r||null==this.layoutTypeModel_)return[];for(var n=r.filterWithCallback((function(e){return e.isBackgroundImage()})).length,o=u.clone(r.filterWithCallback((function(e){return e.isTypeLockup()}))),a=[],i=u.iter(o);!i.done;i.next()){var l,s=i.value;(l=u.as(s.controller,R.TypeLockupController))&&a.push(u.toDouble(l.text.length))}for(var c=r.page.pageSize.width,h=r.page.pageSize.height,g=Math.atan2(h,c),f=this.createLayoutIdFeatures(c,h,o.length,n,u.clone(a)),p=this.layoutTypeModel_.featureScalingMean,m=this.layoutTypeModel_.featureScalingStd,S=u.clone(this.layoutTypeModel_.layoutIDs),F=f.subtract(p).divide(m),I=u.repeat(0,this.layoutTypeModel_.models[0].intercepts.asFlatArray.length),C=u.iter(this.layoutTypeModel_.models);!C.done;C.next()){var T=C.value;if(T.minAngle<g&&g<=T.maxAngle){var _=F.matrixMultiply(T.coefficients.transpose()).sumDim(0);I=u.clone(T.intercepts.add(_).asFlatArray)}}if(I.length!=S.length)return u.opt(v.Host.logging,(function(e){return e.error("model scores don't match class labels")})),[];for(var y=u.sort(I,(function(e,t){return e>t})),L=[],D=u.clone(r.page.layoutLibrary.getAllGrids()),A=!1,x=!1,M=u.iter(u.range(0,S.length,!1));!M.done;M.next()){var b=M.value;if(L.length>=e)break;for(var E=S[u.indexOf(I,y[b])],G=u.iter(D);!G.done;G.next()){var k=G.value;if(k.name==E){var N=k.nonOverlappingCells().length;if(N>=n){if(N==n){if(A)continue;A=!0}if(2==N){if(x)continue;x=!0}var P=k;if(k.gridCells.length<=3){var O=k.flipRegion(),W=u.clone(new d.GridSuggester(this.group_,k).createSuggestions()),w=u.clone(new d.GridSuggester(this.group_,O).createSuggestions());W.length>0&&w.length>0&&(P=W[0].score>w[0].score?k:O)}for(var H=!1,U=u.iter(t);!U.done;U.next())if(U.value.similarity(P)<.02){H=!0;break}H||L.includes(P.name)||L.push(P.name)}}}}return L}}}),n),l.GridDocument=(o=function(){},u.defineClass({name:"GridDocument",ctor:o,props:{init_d4b4:function(e,t,r,n,o,a){this.docID=e,this.userID=t,this.database=r,this.gridFrame=n,this.gridStyle=o,this.layoutItems=u.clone(a)},init_implicit:function(e,t,r,n,o,a){this.gridFrame=e,this.gridStyle=t,this.layoutItems=u.clone(r),this.docID=n,this.userID=o,this.database=a},clone:function(){return o.init_implicit(this.gridFrame,this.gridStyle,this.layoutItems,this.docID,this.userID,this.database)}}}),o),l.RangedLayoutLinearModel=(a=function(e,t,r,n){this.minAngle=e,this.maxAngle=t,this.coefficients=r,this.intercepts=n},u.defineClass({name:"RangedLayoutLinearModel",ctor:a,props:{clone:function(){return new a(this.minAngle,this.maxAngle,this.coefficients,this.intercepts)}}}),a),l.LayoutSuggestionsLinearModel=(i=function(e,t,r,n){this.featureScalingMean=e,this.featureScalingStd=t,this.layoutIDs=u.clone(r),this.models=u.clone(n)},u.defineClass({name:"LayoutSuggestionsLinearModel",ctor:i,superName:"CoreObject"}),i)},"6vbT":function(e,t,r){r("oAGj")},"7Ta2":function(e,t,r){var n,o,a,i=t,l=r("oAGj"),u=r("SpAV"),s=r("gXiO"),c=r("6ZWm"),h=r("iCxV"),g=r("2Srg"),f=r("ws+m"),p=r("xRbc"),d=r("zbwF"),m=r("nrTo"),S=r("JO5d"),v=r("ERpL"),F=r("lYNH"),I=r("8t9B");i.RoleSuggesterProtocol=l.defineProtocol("RoleSuggesterProtocol",{getRole:"(RoleData) -> InferredRole"}),i.RoleSuggester=(n=function(){s.CoreObject.call(this)},o={},l.defineClass({name:"RoleSuggester",ctor:n,superName:"CoreObject",statics:{cache:{get:function(){var e;return void 0===o.cache&&(o.cache=((e=l.opt(h.Host.platform,(function(e){return e.isService})))||null!=e)&&e?l.opt(h.Host.learning,(function(e){return e.getHostPredictionCache()})):new m.PredictionCacheInferredRole),o.cache},set:function(e){o.cache=e}},ROLE_SHORT_LABELS:{Undefined:"udf",Title:"ttl",Subtitle:"stl",BodyText:"bdy",ContactInfo:"ctc",SocialMediaReference:"soc",Quote:"qot",CalltoAction:"act",GraphicContent:"gct",Seperator:"sep",Backing:"bkg",Background:"bgd",Decoration:"dec",Logo:"log"},getShortLabel:function(e){var t;return null!=(t=n.ROLE_SHORT_LABELS[e])?t:(u.CoreAssert.fail("didn't find role in short label dictionary!","RoleSuggester.getShortLabel","RoleSuggester.swift",120),"???")}},props:{getRole:function(e){var t,r,o,a,u,s,m=null,R=null;if(l.as(e.controller,I.TypeLockupController)&&(r=p.LockupRoleData.getLockupRoleData(e))&&(m=r,R=d.LockupRoleSuggesterFactory.Create("MLP"),l.clone(R.getRole(r)).role==i.InferredRoleType.Undefined&&(R=d.LockupRoleSuggesterFactory.Create())),e.controller instanceof S.ShapeController&&(o=v.ShapeRoleData.getShapeRoleData(e))&&(m=o,R=e.isGridCell()?F.ShapeRoleSuggesterFactory.Create("Simple"):F.ShapeRoleSuggesterFactory.Create("MLP")),l.as(e.controller,c.FrameController)&&(a=g.ImageRoleData.getImageRoleData(e))&&(m=a,R=f.ImageRoleSuggesterFactory.Create("Simple")),(u=m)&&(s=R)){var C=u.getUniqueKey();return((t=l.opt(h.Host.platform,(function(e){return e.isService})))||null!=t)&&t||n.cache.cleanup(e.page.document.uuid),null==n.cache.getCacheValue(C)&&n.cache.setCacheValue(C,l.clone(this.getRoleForData(u,s))),n.cache.getCacheValue(C)}return i.InferredRole.init_84d1()},getRoleForData:function(e,t){var r=l.clone(t.getRole(e));return u.CoreAssert.isTrue(null!=n.ROLE_SHORT_LABELS[r.role],void 0,"RoleSuggester.getRoleForData","RoleSuggester.swift",92),u.CoreAssert.isTrue(null!=n.ROLE_SHORT_LABELS[r.secondaryRole],void 0,"RoleSuggester.getRoleForData","RoleSuggester.swift",93),r}}}),n),i.InferredRoleType=l.defineEnum("InferredRoleType",{Undefined:"Undefined",Title:"Title",SubTitle:"Subtitle",Body:"BodyText",Contact:"ContactInfo",Social:"SocialMediaReference",Quote:"Quote",Action:"CalltoAction",GraphicContent:"GraphicContent",Seperator:"Seperator",Backing:"Backing",Background:"Background",Decoration:"Decoration",Logo:"Logo"}),i.InferredRole=(a=function(){},l.defineClass({name:"InferredRole",ctor:a,props:{init_84d1:function(e,t,r,n){void 0===e&&(e=i.InferredRoleType.Undefined),void 0===t&&(t=0),void 0===r&&(r=i.InferredRoleType.Undefined),void 0===n&&(n=0),this.role=e,this.confidence=t,this.secondaryRole=r,this.secondaryConfidence=n},init_implicit:function(e,t,r,n){this.role=e,this.confidence=t,this.secondaryRole=r,this.secondaryConfidence=n},clone:function(){return a.init_implicit(this.role,this.confidence,this.secondaryRole,this.secondaryConfidence)}}}),a)},ERpL:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("wc1n"),l=r("cYVN"),u=r("djAF"),s=r("LGJg");o.ShapeRoleFeatures=a.defineEnum("ShapeRoleFeatures",{Area:"Area",ShapeWidth:"ShapeWidth",ShapeHeight:"ShapeHeight",CenterX:"CenterX",CenterY:"CenterY",RotCosine:"RotCosine",RotSine:"RotSine",PercentageDesignArea:"PercentageDesignArea",PercentageOutofBounds:"PercentageOutofBounds",OverlappingGraphicCount:"OverlappingGraphicCount",OverlappingTextCount:"OverlappingTextCount",PercentageTextOverlap:"PercentageTextOverlap",PercentageGraphicOverlap:"PercentageGraphicOverlap",MaskAverage:"MaskAverage",MaskAverageEdge:"MaskAverageEdge",PageHeight:"PageHeight",PageWidth:"PageWidth",ShapeCount:"ShapeCount",TextCount:"TextCount",BackgroundImageCount:"BackgroundImageCount",ForegroundImageCount:"ForegroundImageCount"}),o.ShapeRoleData=(n=function(e,t,r){l.RoleData.call(this,e,a.clone(t),a.clone(r))},a.defineClass({name:"ShapeRoleData",ctor:n,superName:"RoleData",statics:{getShapeRoleData:function(e){var t,r,l;if(l=a.as(e,u.ShapeForma)){var c=[o.ShapeRoleFeatures.Area,o.ShapeRoleFeatures.ShapeWidth,o.ShapeRoleFeatures.ShapeHeight,o.ShapeRoleFeatures.CenterX,o.ShapeRoleFeatures.CenterY,o.ShapeRoleFeatures.RotCosine,o.ShapeRoleFeatures.RotSine,o.ShapeRoleFeatures.PercentageDesignArea,o.ShapeRoleFeatures.PercentageOutofBounds,o.ShapeRoleFeatures.OverlappingGraphicCount,o.ShapeRoleFeatures.OverlappingTextCount,o.ShapeRoleFeatures.PercentageTextOverlap,o.ShapeRoleFeatures.PercentageGraphicOverlap,o.ShapeRoleFeatures.MaskAverage,o.ShapeRoleFeatures.MaskAverageEdge,o.ShapeRoleFeatures.PageHeight,o.ShapeRoleFeatures.PageWidth,o.ShapeRoleFeatures.ShapeCount,o.ShapeRoleFeatures.TextCount,o.ShapeRoleFeatures.BackgroundImageCount,o.ShapeRoleFeatures.ForegroundImageCount],h=i.FeatureExtractorFactory.getFeatureExtractor(i.FeatureExtractorType.Shape,l,a.clone(c)),g={};c.forEach((function(e){g[e]=(t=h.numericFeatureForKey(e))||null!=t?t:-1}));for(var f=a.iter(["line","heart","circle","arrow","square","instagram","rectangle","flower","star","love","triangle","food","music","party","?","birthday","sun","facebook","phone","youtube","badge"]);!f.done;f.next()){var p,d,m=f.value,S="search-"+m;c.push(S),g[S]=0,(p=a.as(l.contentNode,s.VectorContentNode))&&null!=(d=a.opt(a.opt(p.mediaMetadata,(function(e){return e.searchTerm})),(function(e){return e.toLowerCase()})))&&d==m&&(g[S]=1)}r=new n(e,a.clone(c),a.clone(g))}return r}}}),n)},LqGn:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("cZuM"),l=r("XmBt"),u=r("SpAV"),s=r("FNB+"),c=r("6ZWm"),h=r("9Lk3"),g=r("/afT"),f=r("pnSN"),p=r("iCxV"),d=r("c+uM"),m=r("tGKA"),S=r("AxS/"),v=r("MZST"),F=r("8t9B"),I=r("oKlP");o.RetargetSuggestion=(n=function(e,t,r,n,o,i,l){this.correspondence_=a.clone(o),this.modelDoc_=n,this.forma_=e,this.modelForma_=r,this.score_=new v.RetargetScore(t,r,a.clone(o),a.clone(i),a.clone(l))},a.defineClass({name:"RetargetSuggestion",ctor:n,superName:"CoreObject",statics:{_implements:function(e){return"IDesignSuggestion"==e}},props:{getGroupCorrespondences:function(){for(var e=this.forma_,t=[],r=a.iter(this.correspondence_);!r.done;r.next()){for(var n=r.value,o=[],i=a.iter(n.a);!i.done;i.next()){var l=i.value;e.visitAll(s.FormaTraversal.PreOrder,(function(e){e.originalID==l.originalID&&o.push(e)}))}t.push({a:o,b:n.b})}return t},getHeightScale:function(e,t){return a.opt(e.controller,(function(e){return e.kind==a.opt(t.controller,(function(e){return e.kind}))}))?a.opt(t.controller,(function(e){return e.currentHeightScale})):a.opt(e.controller,(function(e){return e.currentHeightScale}))},matchGroups:function(e,t){if(0!=e.length&&0!=t.length){for(var r=e.length,n=t.length,o=null,i=[],l=[],s=a.iter(a.range(0,Math.min(n,r),!1));!s.done;s.next()){var c,h,g=s.value;null!=(c=this.getHeightScale(e[g],t[g]))&&l.push({forma:e[g],height:c}),e[g].match(t[g]),i.push(e[g]),(h=a.as(t[g].controller,F.TypeLockupController))&&(o=h.lockupStyle)}var f=[];if(r>n)for(var p=a.iter(a.range(n,r,!1));!p.done;p.next()){var m,S;if(g=p.value,(m=a.as(e[g].controller,F.TypeLockupController))&&(S=o)){var v=d.LockupStyle.createDefault();v.colors.match(S.colors),v.alignment=S.alignment,v.layout=S.layout,a.opt(m.forma,(function(e){return e.applyStyle(v)}))}f.push(e[g])}this.createAlignmentGroupForFormae(a.clone(t),a.clone(i),a.clone(f),a.clone(l))}else u.CoreAssert.fail("can't have an empty match","RetargetSuggestion.matchGroups","RetargetSuggestion.swift",73)},createAlignmentGroupForFormae:function(e,t,r,n){for(var o=null,u=null,c=a.iter(a.range(0,e.length,!1));!c.done;c.next()){var h=e[w=c.value].controller.visualParentExpansionFrame;o=null==o?h:o.unionWith(h),u=null==u?e[w].frame:u.unionWith(e[w].frame)}var d,S=null,v=null,R=null;if(0==r.length&&(d=a.clone(g.GroupDetector.detectVerticalAlignmentGroups(a.clone(e)))).length>0){var C=d[0],T=(D=a.as(e[0].page.createFormaWithController(f.GroupForma.KIND,l.AlignmentGroupController.KIND),f.GroupForma)).controller;(A=e[0].root).appendChild(D),T.fit(o);var _=C.formae[0].parent;a.opt(T.alignmentGroupStyle,(function(e){return e.numColumns=1})),T.setupWithFormae(a.clone(e),C.alignment),S=T.inferredSpacing,R=Math.max(0,o.maxY-u.maxY),v=Math.max(0,u.minY-o.minY),null!=S&&S<0&&(p.Host.logging.info("possible error in spacing: "+S+"\n"),S=null);for(var y=a.iter(D.visitAsArray(s.FormaTraversal.JustChildren));!y.done;y.next()){var L=y.value;a.opt(_,(function(e){return e.appendChild(L,!0)}))}D.removeFromParent(),T.dispose()}if(1==(d=a.clone(g.GroupDetector.detectVerticalAlignmentGroups(a.clone(t)))).length||r.length>0){var D,A;C=d[0],T=(D=a.as(this.forma_.page.createFormaWithController(f.GroupForma.KIND,l.AlignmentGroupController.KIND),f.GroupForma)).controller,(A=this.forma_).appendChild(D),_=C.formae[0].parent,T.fit(o);for(var x=a.iter(t);!x.done;x.next())1!=(k=x.value).placement.transformValues.rotCosine&&(k.placement=m.Matrix2D.Identity),T.addFormaToGroup(k);if(null!=T.alignmentGroupStyle)for(var M=a.iter(n);!M.done;M.next()){var b=M.value;T.alignmentGroupStyle.setScale(b.forma.formaID,b.height)}T.setHorizontalAlignment(C.alignment),C.alignment==i.AlignmentType.Left?a.opt(T.alignmentGroupStyle,(function(e){return e.marginLeft=u.minX-o.minX})):C.alignment==i.AlignmentType.Right&&a.opt(T.alignmentGroupStyle,(function(e){return e.marginRight=o.maxX-u.maxX})),null!=S?a.opt(T.alignmentGroupStyle,(function(e){return e.spacing=S})):r.length>0&&a.opt(T.alignmentGroupStyle,(function(e){return e.spacing=o.height/15})),null!=v&&a.opt(T.alignmentGroupStyle,(function(e){return e.marginTop=v})),null!=R&&a.opt(T.alignmentGroupStyle,(function(e){return e.marginBottom=R})),0==r.length&&a.opt(T.alignmentGroupStyle,(function(e){return e.numColumns=1})),null!=v&&null!=R&&Math.max(R,v)>o.height/10&&((v-R)/o.height>.2?a.opt(T.alignmentGroupStyle,(function(e){return e.verticalAlignment=i.AlignmentType.Bottom})):(R-v)/o.height>.2&&a.opt(T.alignmentGroupStyle,(function(e){return e.verticalAlignment=i.AlignmentType.Top})));for(var E=0,G=a.iter(r);!G.done;G.next()){var k;1!=(k=G.value).placement.transformValues.rotCosine&&(k.placement=m.Matrix2D.Identity);var N=!1;if(null!=T.alignmentGroupStyle)for(var P=a.iter(n);!P.done;P.next())b=P.value,a.opt(b.forma.controller,(function(e){return e.kind==a.opt(k.controller,(function(e){return e.kind}))}))&&(T.alignmentGroupStyle.setScale(k.formaID,b.height),N=!0);N||null==T.alignmentGroupStyle||(null!=a.as(k.controller,F.TypeLockupController)?T.alignmentGroupStyle.setScale(k.formaID,60):T.alignmentGroupStyle.setScale(k.formaID,A.frame.height/5)),T.insertForma(k,t.length+E),E+=1}T.updateGroup();for(var O=a.iter(D.visitAsArray(s.FormaTraversal.JustChildren));!O.done;O.next())L=O.value,a.opt(_,(function(e){return e.appendChild(L,!0)}));a.opt(D,(function(e){return e.removeFromParent()})),T.dispose()}for(var W=a.iter(a.range(0,e.length,!1));!W.done;W.next()){var w;if((w=W.value)<t.length){var H=e[w].placement.transformValues,U=t[w].frame.center;t[w].move(m.Matrix2D.rotation(H.rotCosine,H.rotSine)),t[w].movePinToPoint(new I.TheoPoint(.5,.5),U)}}},apply:function(){for(var e=this,t=this.forma_,r=this.modelDoc_.beginTransaction("adjust_template"),n=a.clone(t.filterWithCallback((function(e){return e.isTypeLockup()&&e.frame.area>1}))),o=a.iter(n);!o.done;o.next()){var i=o.value;a.opt(a.as(i.controller,F.TypeLockupController),(function(e){return e.updateGroup()}))}for(var u=a.clone(t.filterWithCallback((function(e){return a.opt(e.controller,(function(e){return e.kind==l.AlignmentGroupController.KIND}))}))),c=a.iter(u);!c.done;c.next()){for(var h=c.value,g=a.clone(h.filterWithCallback((function(e){return null!=e.controller&&e.controller.floating}),s.FormaTraversal.JustChildren)),f=a.iter(g);!f.done;f.next()){var p=f.value;a.opt(h.parent,(function(e){return e.appendChild(p,!0)}))}h.removeFromParent()}for(var d=[],m=[],v=[],I=a.iter(this.getGroupCorrespondences());!I.done;I.next()){var R=I.value;if(1==R.a.length&&1==R.b.length){var C,T,_=R.a[0],y=R.b[0];null!=(C=this.getHeightScale(_,y))&&d.push({forma:_,height:C}),(T=a.opt(y.controller,(function(e){return e.getPin()})))&&(T.forma=_,m.push(T)),_.match(y),v.push({design:_,model:y})}else this.matchGroups(a.clone(R.a),a.clone(R.b))}for(var L=a.iter(d);!L.done;L.next()){var D=L.value;a.opt(D.forma.controller,(function(e){return e.setHeightScale(D.height)}))}a.opt(t.page.document,(function(t){return t.content.root.setTag(S.RootContentNode.THEME_ID_TAG,e.modelDoc_.uuid)})),t.page.colorLibraryController.restoreUndoState(a.as(this.modelDoc_.firstPage.colorLibrary.state.allProperties,"AnyObject")),t.applyStyle(t.style),r.rollback(),this.cleanupForma(t)},distanceTo:function(e){return u.CoreAssert.fail("no distance","RetargetSuggestion.distanceTo","RetargetSuggestion.swift",438),0},score:{get:function(){return a.opt(this.score_,(function(e){return e.score}))}},weightedScore:{get:function(){return this.score_}},forma:{get:function(){return this.forma_}},isLogoMatchedWithModelLogo:function(e){var t=this.modelForma_;return a.clone(t.filterWithCallback((function(e){return e.isLogo()}))).length>0&&this.correspondence_.filter((function(t){var r=t.a[0];return r.isLogo()&&r.originalID==e.originalID&&t.b[0].isLogo()}),this).length>0},cleanupForma:function(e){for(var t=a.clone(e.filterWithCallback((function(e){return e.isTypeLockup()&&e.frame.area>1}))),r=a.iter(t);!r.done;r.next()){var n,o=r.value;(A=a.as(o.controller,F.TypeLockupController))&&(A.snapSizeToBounds(),null!=(n=A.averageLineHeight)&&n<F.TypeLockupController.MIN_LINE_HEIGHT&&A.setHeightScale(F.TypeLockupController.MIN_LINE_HEIGHT))}for(var i=a.clone(e.filterWithCallback((function(e){return e.isLogo()}))),l=a.iter(i);!l.done;l.next()){var u,g=l.value;(u=a.as(g.controller,c.FrameController))&&(this.isLogoMatchedWithModelLogo(g)||u.placeAsLogo())}if(e.visible&&!this.modelForma_.visible)for(var p=a.iter(t);!p.done;p.next()){var m,S;if(o=p.value,(A=a.as(o.controller,F.TypeLockupController))&&(m=a.opt(A.lockupStyle,(function(e){return e.colors.fieldSecondary})))&&(S=a.opt(A.lockupStyle,(function(e){return e.colors.fieldPrimary})))){for(var v=e.page.colorLibraryController,I=-1,R=null,C=a.iter(v.getColorThemeAsArrayOfTheoColors());!C.done;C.next()){var T;if((T=C.value)!=m&&T!=S){var _=T.rgbColor.distanceTo(S)+T.rgbColor.distanceTo(m);_>I&&(I=_,R=T)}}(T=R)&&a.opt(e.controller,(function(e){return e.applyColors([T])}))}}a.sortInPlace(t,(function(e,t){var r=a.as(e,f.GroupForma),n=a.as(t,f.GroupForma),o=null!=r?r.childrenFinalFrame:null,i=null!=n?n.childrenFinalFrame:null;return null!=o&&null!=i&&o.area<i.area}));for(var y=[],L=0,D=a.iter(t);!D.done;D.next()){var A,x,M;if(o=D.value,L+=1,(A=a.as(o.controller,F.TypeLockupController))&&A.lockupStyle&&(x=a.as(o,f.GroupForma))&&(M=x.childrenFinalFrame))for(var b=a.iter(a.range(0,L-1,!1));!b.done;b.next()){var E,G=b.value;if((E=(w=t[G].controller).textFinalFrame)&&M.intersects(E)){y.push(t[G]);break}}}for(var k=a.clone(e.filterWithCallback((function(e){return e.hasIntent(s.Forma.INTENT_ICON)}))),N=a.iter(k);!N.done;N.next()){var P=N.value;a.opt(P.controller,(function(e){return e.contrastCheck(!1)}))}for(var O=a.iter(y);!O.done;O.next())(H=(o=O.value).parent).removeChild(o),H.appendChild(o);for(var W=a.iter(t);!W.done;W.next()){var w=(o=W.value).controller,H=o.parent,U=w.lockupStyle.backing==d.LockupBacking.Knockout&&d.LockupStyle.isKnockoutLook(w.lockupStyle.textLook);if(null!=H&&U){var Y=a.clone(H.filterWithCallback((function(e){return(e.isBackgroundImage()||e.isShape())&&null!=e.controller&&!e.controller.floating}),s.FormaTraversal.JustChildren));H.insertChildAt(o,Y.length)}}for(var B=a.iter(e.filterByControllerKind(h.GridController.KIND));!B.done;B.next()){var V,X=B.value;if(V=a.as(X.controller,h.GridController))for(var j=a.iter(V.gridStyle.gridCells);!j.done;j.next()){var z,K=j.value;if(null!=(z=K.colorID)&&null==e.page.colorLibrary.color(z)){var q=a.clone(e.page.colorLibraryController.unusedColorKeys(null,!0));q.length>0&&V.gridStyle.updateCell(K,null,q[0],null)}}}},dummy:function(e){}}}),n)},LwcA:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("gXiO"),l=r("wc1n"),u=r("cmoc"),s=r("fdtz"),c=r("WlyK"),h=r("jV/A"),g=r("sIWg"),f=r("1NAc");o.RetargetCompatibilitySuggester=(n=function(){i.CoreObject.call(this)},a.defineClass({name:"RetargetCompatibilitySuggester",ctor:n,superName:"CoreObject",statics:{sortDocuments:function(e,t){for(var r=a.clone(n.scoreDocuments(e,a.clone(t))),o=[],i=a.iter(r);!i.done;i.next()){var l=i.value;o.push(l.data)}return o},scoreDocuments:function(e,t){for(var r=n.createRetargetDocumentData(e),o=(t.filter((function(e){return 0==e.numImages}),this),a.clone(e.filterWithCallback((function(e){return e instanceof s.ImageForma&&e.parent instanceof u.FrameForma&&!e.isLogo()}))),a.clone(r.lockupStrings)),i=(r.numImages,[]),l=a.iter(t);!l.done;l.next()){var h=l.value;a.isEmpty(h.layoutID);for(var g=(I=a.clone(h.lockupStrings)).length,f=!1,p=a.iter(i);!p.done;p.next()){var d=p.value;if(d.lockupStrings.length==g){for(var m=a.clone(d.lockupStrings),S=a.iter(a.range(0,g,!1));!S.done&&I[C=S.value]==m[C];S.next())C+1==g&&(f=!0);if(f)break}}f||o.length>3&&g<3||i.push(h)}for(var v=[],F=a.iter(i);!F.done;F.next()){var I;if(h=F.value,g=(I=a.clone(h.lockupStrings)).length,f=!1,o.length==g)for(var R=a.iter(a.range(0,g,!1));!R.done;R.next()){var C;if(I[C=R.value]!=o[C])break;C+1==g&&(f=!0)}if(!f){var T=new c.RetargetCompatibilityScore(e.frame,r,h);v.push({data:h,score:T})}}return a.sort(v,(function(e,t){return e.score.score>t.score.score}))},createRetargetDocumentData:function(e){var t=l.FeatureExtractorFactory.getFeatureExtractor(l.FeatureExtractorType.Retarget,e),r=a.clone(t.allFeatures_),n=a.as(r.Focus,"AnyObject"),o=n.length;return new h.RetargetDocumentExemplar("","","","","",f.TheoSize.decodeJson(a.as(r.Size,"AnyObject"))||f.TheoSize.Zero,2,2,"","",a.clone(r.LockupStrings),null!=n&&o>0?g.TheoRect.decodeJson(n):null,r.NumImages,a.clone(a.as(r.Edges,["Array","Double"])),r.LayoutId,r.NumGridsCells,r.NumMoveable,r.NumShapes,a.clone(r.VisualGroupInfo),a.clone(r.TextRoles),a.clone(r.ShapeRoles),r.SalientCoverage,r.GifsCount)}}}),n)},MZST:function(e,t,r){var n,o,a=t,i=r("oAGj"),l=r("FNB+"),u=r("c+uM"),s=r("8t9B"),c=r("9BFu");a.RetargetScore=(n=function e(t,r,n,o,a){this.rejectThreshold=-1e3,this.root_=t,this.model_=r,this.correspondence_=i.clone(n),this.designRoles_=i.clone(o),this.modelRoles_=i.clone(a),c.WeightedScore.call(this,e.Features.NUM_FEAT),this.setWeight(e.Features.MIN_TEXT_SIZE,0),this.setWeight(e.Features.LENGTH_TEXT_DIFF,-30),this.setWeight(e.Features.WEIGHT_DIFF,0),this.setWeight(e.Features.RELATIVE_WEIGHT,-20),this.setWeight(e.Features.RELATIVE_LOCATION,-10),this.setWeight(e.Features.GROUP_SIZE_DIFF,-100),this.setWeight(e.Features.GROUP_COUNT_DIFF,-40),this.setWeight(e.Features.MISSING_TEXT,-5e3),this.setWeight(e.Features.TYPE_MISMATCH,-80),this.setWeight(e.Features.STYLE_MISMATCH,-80),this.setWeight(e.Features.ROLES_MISMATCH,-1e3),this.setFeatureName(e.Features.MIN_TEXT_SIZE,"Min Text Size"),this.setFeatureName(e.Features.LENGTH_TEXT_DIFF,"Text Length Difference"),this.setFeatureName(e.Features.WEIGHT_DIFF,"Weight Difference"),this.setFeatureName(e.Features.RELATIVE_WEIGHT,"Relative Weight"),this.setFeatureName(e.Features.RELATIVE_LOCATION,"Relative Location"),this.setFeatureName(e.Features.GROUP_SIZE_DIFF,"Group Size Diff"),this.setFeatureName(e.Features.GROUP_COUNT_DIFF,"Group Count Diff"),this.setFeatureName(e.Features.MISSING_TEXT,"Missing Text"),this.setFeatureName(e.Features.TYPE_MISMATCH,"Type Mismatch"),this.setFeatureName(e.Features.STYLE_MISMATCH,"Style Mismatch"),this.setFeatureName(e.Features.ROLES_MISMATCH,"Roles Mismatch"),this.setFeature(e.Features.MIN_TEXT_SIZE,0),this.setFeature(e.Features.LENGTH_TEXT_DIFF,0),this.setFeature(e.Features.WEIGHT_DIFF,0),this.setFeature(e.Features.RELATIVE_WEIGHT,0),this.setFeature(e.Features.RELATIVE_LOCATION,0),this.setFeature(e.Features.GROUP_SIZE_DIFF,0),this.setFeature(e.Features.GROUP_COUNT_DIFF,0),this.setFeature(e.Features.MISSING_TEXT,0),this.setFeature(e.Features.TYPE_MISMATCH,0),this.setFeature(e.Features.STYLE_MISMATCH,0),this.setFeature(e.Features.ROLES_MISMATCH,0),this.evaluateLayout()},o={},i.defineClass({name:"RetargetScore",ctor:n,superName:"WeightedScore",statics:{Features:{get:function(){return void 0===o.Features&&(o.Features=i.defineEnum("Features",{MIN_TEXT_SIZE:0,WEIGHT_DIFF:1,LENGTH_TEXT_DIFF:2,RELATIVE_WEIGHT:3,RELATIVE_LOCATION:4,MISSING_TEXT:5,GROUP_SIZE_DIFF:6,GROUP_COUNT_DIFF:7,TYPE_MISMATCH:8,STYLE_MISMATCH:9,ROLES_MISMATCH:10,NUM_FEAT:11})),o.Features}}},props:{evaluateLayout:function(){var e,t,r=this;this.setFeature(n.Features.MIN_TEXT_SIZE,0);for(var o=[],a={},c={},h=0,g=0,f=i.iter(this.correspondence_);!f.done;f.next()){var p=f.value;g+=i.toDouble(Math.abs(p.a.length-p.b.length));for(var d=0,m=0,S=i.iter(p.a);!S.done;S.next())d+=(F=S.value).frame.area/F.root.frame.area;for(var v=i.iter(p.b);!v.done;v.next()){var F;m+=(F=v.value).frame.area/F.root.frame.area}var I=d-m;h+=i.toDouble(I*I);for(var R=i.iter(i.range(0,Math.min(p.a.length,p.b.length),!1));!R.done;R.next()){var C=R.value,T=p.a[C],_=p.b[C];o.push({forma:T,placed:_}),a[T.formaID]={forma:T,length:0,size:(e=T.controller.currentHeightScale)||null!=e?e:T.finalFrame.height,center:T.frame.center},c[_.formaID]={forma:_,length:0,size:(t=_.controller.currentHeightScale)||null!=t?t:_.finalFrame.height,center:_.frame.center}}}this.setFeature(n.Features.GROUP_SIZE_DIFF,h),this.setFeature(n.Features.GROUP_COUNT_DIFF,g/i.toDouble(this.correspondence_.length));for(var y=0,L=0,D=0,A=0,x=0,M=0,b=this.root_.frame.area,E=i.iter(o);!E.done;E.next()){var G,k,N,P,O=E.value;if((O.forma.isTypeLockup()&&O.placed.isGraphic()||O.forma.isGraphic()&&O.placed.isTypeLockup())&&(A+=1,(G=i.as(O.placed.controller,s.TypeLockupController))&&(G.lockupStyle.backing==u.LockupBacking.None&&G.lockupStyle.textLook==u.LockupTextLook.Fill||null!=(k=G.averageLineHeight)&&(x+=k/100))),null!=(N=a[O.forma.formaID])&&null!=(P=c[O.placed.formaID])){y+=Math.abs(N.size-P.size)/b;for(var W=i.iter(o);!W.done;W.next()){var w,H,U=W.value;i.eq(l._equality_Forma_Forma,O.forma,U.forma)||i.eq(l._equality_Forma_Forma,O.placed,U.placed)||null!=(w=a[U.forma.formaID])&&null!=(H=c[U.placed.formaID])&&((N.size-w.size>5&&P.size-H.size<-5||N.size-w.size<-5&&P.size-H.size>5)&&i.opt(N.forma.controller,(function(e){return e.kind==i.opt(w.forma.controller,(function(e){return e.kind}))}))&&i.opt(P.forma.controller,(function(e){return e.kind==i.opt(H.forma.controller,(function(e){return e.kind}))}))&&(L+=1),(N.center.x-w.center.x>20&&P.center.x-H.center.x<-20||N.center.x-w.center.x<-20&&P.center.x-H.center.x>20)&&(D+=.5),(N.center.y-w.center.y>20&&P.center.y-H.center.y<-20||N.center.y-w.center.y<-20&&P.center.y-H.center.y>20)&&(D+=1))}}var Y=i.clone(this.designRoles_[O.forma.formaID]),B=i.clone(this.modelRoles_[O.placed.formaID]);null!=Y&&null!=B&&i.opt(Y,(function(e){return e.role!=i.opt(B,(function(e){return e.role}))}))&&(M+=1)}for(var V=i.iter(this.correspondence_);!V.done;V.next()){p=V.value;for(var X=i.clone(p.a),j=i.iter(i.range(0,X.length,!1));!j.done;j.next()){C=j.value;for(var z=i.iter(i.range(0,X.length,!1));!z.done;z.next()){var K=z.value;C>K&&X[C].frame.center.y>X[K].frame.center.y&&(D+=1)}}}this.setFeature(n.Features.WEIGHT_DIFF,y/i.toDouble(o.length)),this.setFeature(n.Features.RELATIVE_WEIGHT,L/i.toDouble(o.length)),this.setFeature(n.Features.RELATIVE_LOCATION,.5*D/i.toDouble(o.length)),this.setFeature(n.Features.TYPE_MISMATCH,A/i.toDouble(o.length)),this.setFeature(n.Features.STYLE_MISMATCH,x/i.toDouble(o.length)),this.setFeature(n.Features.ROLES_MISMATCH,M/i.toDouble(o.length));var q=0;this.model_.visit(l.FormaTraversal.PreOrder,(function(e,t,n){var o;if(o=i.as(e.controller,s.TypeLockupController)){for(var a=!1,u=i.iter(r.correspondence_);!u.done;u.next())for(var c=u.value,h=i.iter(c.b);!h.done;h.next()){var g=h.value;i.eq(l._equality_Forma_Forma,e,g)&&(a=!0)}if(!a){var f=i.toDouble(o.text.length);q+=e.frame.area/f}}return!1})),this.setFeature(n.Features.MISSING_TEXT,q/this.root_.frame.area)},reject:function(){return this.score<this.rejectThreshold}}}),n)},WlyK:function(e,t,r){var n,o,a=t,i=r("oAGj"),l=r("SpAV"),u=r("3DEm"),s=r("sIWg"),c=r("9BFu");a.RetargetCompatibilityScore=(n=function e(t,r,n){this.rejectThreshold=-500,c.WeightedScore.call(this,e.Features.NUM_FEAT),this.setFeature(e.Features.LENGTH_TEXT_DIFF,0),this.setFeature(e.Features.NUM_MOVEABLE_DIFF,0),this.setFeature(e.Features.NUM_IMAGE_DIFF,0),this.setFeature(e.Features.IMAGE_SIMILARITY,0),this.setFeature(e.Features.DESIGN_SIZE_DIFF,0),this.setFeature(e.Features.GRID_DESIGN,0),this.setFeature(e.Features.VISUAL_GROUP_DISSIMILARITY,0),this.setFeature(e.Features.LOCKUP_ROLE_DISSIMILARITY,0),this.setFeature(e.Features.SHAPE_ROLE_DISSIMILARITY,0),this.setFeature(e.Features.SALIENT_COVERAGE_DISSSIMILARITY,0),this.setFeature(e.Features.NUM_GRIDCELL_DIFF,0),this.setFeature(e.Features.NUM_SHAPE_DIFF,0),this.setFeature(e.Features.NUM_GIFS_DIFF,0),this.setWeight(e.Features.LENGTH_TEXT_DIFF,-100),this.setWeight(e.Features.FAKE_DESIGN,-100),this.setWeight(e.Features.NUM_IMAGE_DIFF,-1e4),this.setWeight(e.Features.IMAGE_SIMILARITY,-50),this.setWeight(e.Features.DESIGN_SIZE_DIFF,-1e4),this.setWeight(e.Features.GRID_DESIGN,50),this.setWeight(e.Features.VISUAL_GROUP_DISSIMILARITY,-1e3),this.setWeight(e.Features.LOCKUP_ROLE_DISSIMILARITY,-1e3),this.setWeight(e.Features.SHAPE_ROLE_DISSIMILARITY,-1e3),this.setWeight(e.Features.SALIENT_COVERAGE_DISSSIMILARITY,-100),this.setWeight(e.Features.NUM_GRIDCELL_DIFF,-1e3),this.setWeight(e.Features.NUM_SHAPE_DIFF,-1e3),this.setWeight(e.Features.NUM_GIFS_DIFF,-1e3),this.setFeatureName(e.Features.NUM_MOVEABLE_DIFF,"Moveable Count Difference"),this.setFeatureName(e.Features.FAKE_DESIGN,"Fake Design"),this.setFeatureName(e.Features.LENGTH_TEXT_DIFF,"Text Length Difference"),this.setFeatureName(e.Features.NUM_IMAGE_DIFF,"Image Count Difference"),this.setFeatureName(e.Features.IMAGE_SIMILARITY,"Image Similarity"),this.setFeatureName(e.Features.DESIGN_SIZE_DIFF,"Design Size Difference"),this.setFeatureName(e.Features.GRID_DESIGN,"Grid Design"),this.setFeatureName(e.Features.VISUAL_GROUP_DISSIMILARITY,"Visual Group Dissimilarity"),this.setFeatureName(e.Features.LOCKUP_ROLE_DISSIMILARITY,"Lockup Roles Dissimilarity"),this.setFeatureName(e.Features.SHAPE_ROLE_DISSIMILARITY,"Shape Roles Dissimilarity"),this.setFeatureName(e.Features.SALIENT_COVERAGE_DISSSIMILARITY,"Salient Coverage Dissimilarity"),this.setFeatureName(e.Features.NUM_GRIDCELL_DIFF,"Grid Cells Difference"),this.setFeatureName(e.Features.NUM_SHAPE_DIFF,"Shape Count Difference"),this.setFeatureName(e.Features.NUM_GIFS_DIFF,"Gifs Count Difference");var o=i.clone(r.edgeMap),a=i.clone(n.edgeMap);if(null!=a&&null!=o)if(o.length==a.length){for(var h=1e-5,g=i.iter(i.range(0,a.length,!1));!g.done;g.next())h+=a[d=g.value];for(var f=0,p=i.iter(i.range(0,o.length,!1));!p.done;p.next()){var d=p.value;f+=Math.abs(o[d]-a[d]/h)}isNaN(f)&&l.CoreAssert.fail("nan ","RetargetCompatibilityScore.init","RetargetCompatibilityScore.swift",104),this.setFeature(e.Features.IMAGE_SIMILARITY,f)}else this.setFeature(e.Features.IMAGE_SIMILARITY,0);var m=i.toDouble(r.numMoveable-n.numMoveable),S=-2e3;function v(e,t){return e.length>t.length}m<0&&(S=-1e3),this.setWeight(e.Features.NUM_MOVEABLE_DIFF,S),this.setFeature(e.Features.NUM_MOVEABLE_DIFF,Math.abs(m));for(var F=i.sort(r.lockupStrings.concat(),v),I=i.sort(n.lockupStrings.concat(),v),R=(f=[],[]),C=i.iter(i.range(0,Math.min(F.length,I.length),!1));!C.done;C.next()){d=C.value;var T=i.toDouble(F[d].length),_=i.toDouble(I[d].length);f.push(T-_),R.push(Math.max(T,_))}function y(e){for(var t=0,r=i.iter(e);!r.done;r.next()){var n=r.value;t+=n*n}return Math.sqrt(t)}var L=y(i.clone(f))/(y(i.clone(R))+.001);this.setFeature(e.Features.LENGTH_TEXT_DIFF,L);for(var D=i.iter(n.lockupStrings);!D.done;D.next())D.value.toLowerCase().includes("lorem ipsum")&&this.setFeature(e.Features.FAKE_DESIGN,1);var A=i.toDouble(Math.abs(r.numImages-n.numImages));this.setFeature(e.Features.NUM_IMAGE_DIFF,A);var x=s.TheoRect.fromSize(n.size),M=s.TheoRect.fromSize(r.size).similarity(x);this.setFeature(e.Features.DESIGN_SIZE_DIFF,M),this.setFeature(e.Features.GRID_DESIGN,""==n.layoutID?0:1);var b=u.MathUtils.absDouble(r.salientCoverage-n.salientCoverage);this.setFeature(e.Features.SALIENT_COVERAGE_DISSSIMILARITY,b);var E=i.toDouble(Math.abs(r.numShapes-n.numShapes));this.setFeature(e.Features.NUM_SHAPE_DIFF,E);var G=i.toDouble(Math.abs(r.gifsCount-n.gifsCount));this.setFeature(e.Features.NUM_GIFS_DIFF,G);var k=this.scoreVisualGroups(i.clone(r.visualGroupInfo),i.clone(n.visualGroupInfo));this.setFeature(e.Features.VISUAL_GROUP_DISSIMILARITY,k);var N=i.toDouble(Math.abs(r.numGridCells-n.numGridCells));this.setFeature(e.Features.NUM_GRIDCELL_DIFF,N);var P=i.clone(r.textRoles),O=i.clone(n.textRoles),W=i.toDouble(this.roleDifference(i.clone(P),i.clone(O)));this.setFeature(e.Features.LOCKUP_ROLE_DISSIMILARITY,W);var w=i.clone(r.shapeRoles),H=i.clone(n.shapeRoles),U=i.toDouble(this.roleDifference(i.clone(w),i.clone(H)));this.setFeature(e.Features.LOCKUP_ROLE_DISSIMILARITY,U)},o={},i.defineClass({name:"RetargetCompatibilityScore",ctor:n,superName:"WeightedScore",statics:{Features:{get:function(){return void 0===o.Features&&(o.Features=i.defineEnum("Features",{NUM_MOVEABLE_DIFF:0,LENGTH_TEXT_DIFF:1,NUM_IMAGE_DIFF:2,IMAGE_SIMILARITY:3,DESIGN_SIZE_DIFF:4,FAKE_DESIGN:5,GRID_DESIGN:6,NUM_SHAPE_DIFF:7,NUM_GIFS_DIFF:8,VISUAL_GROUP_DISSIMILARITY:9,NUM_GRIDCELL_DIFF:10,LOCKUP_ROLE_DISSIMILARITY:11,SHAPE_ROLE_DISSIMILARITY:12,SALIENT_COVERAGE_DISSSIMILARITY:13,NUM_FEAT:14})),o.Features}}},props:{scoreVisualGroups:function(e,t){var r,n,o=0;if(null!=e.children&&null!=t.children&&(r=e.children)&&(n=t.children)){o+=u.MathUtils.absDouble(i.toDouble(r.length-n.length)),e.layoutStrategy!=t.layoutStrategy&&(o+=1);var a=this.computeAreaofGroups(i.clone(r)),l=this.computeAreaofGroups(i.clone(n));o+=u.MathUtils.absDouble(a-l)/Math.max(a,l);for(var s=[],c=i.iter(r);!c.done;c.next()){for(var h=c.value,g=1e5,f=0,p=i.iter(i.range(0,n.length,!1));!p.done;p.next()){var d=p.value,m=i.clone(n[d]);if(!s.includes(d)){var S=this.subTreeMisMatchScore(i.clone(h),i.clone(m));S<g&&(g=S,f=d)}}o+=g/i.toDouble(r.length),s.push(f)}}return o},computeAreaofGroups:function(e){for(var t=0,r=i.iter(e);!r.done;r.next()){var n,o=r.value;(n=s.TheoRect.decodeJson(o.frame))&&(t+=n.area)}return t},subTreeMisMatchScore:function(e,t){var r=this,n=0,o=i.clone(i.as(e.children,["Array",["Dictionary","String","AnyObject"]])),a=i.clone(i.as(t.children,["Array",["Dictionary","String","AnyObject"]]));if(null!=o&&null!=a){e.layoutStrategy!=t.layoutStrategy&&(n+=1);var l=i.clone(i.opt(o,(function(e){return e.filter((function(e){return"Group"!=i.as(e.type,"String")}),r)}))),s=i.clone(i.opt(a,(function(e){return e.filter((function(e){return"Group"!=i.as(e.type,"String")}),r)}))),c=i.clone(i.opt(l,(function(e){return e.map((function(e){return e.role}),r)}))),h=i.clone(i.opt(s,(function(e){return e.map((function(e){return e.role}),r)})));n+=i.toDouble(this.roleDifference(i.clone(c),i.clone(h)));var g=i.clone(i.opt(o,(function(e){return e.filter((function(e){return"Group"==i.as(e.type,"String")}),r)}))),f=i.clone(i.opt(a,(function(e){return e.filter((function(e){return"Group"==i.as(e.type,"String")}),r)})));if(g.length>0||f.length>0){var p=this.computeAreaofGroups(i.clone(g)),d=this.computeAreaofGroups(i.clone(f));n+=u.MathUtils.absDouble(p-d)/Math.max(p,d)}}return n},roleDifference:function(e,t,r){void 0===r&&(r=!0);var n=0,o=i.clone(e),a=i.clone(t);r||(o=i.clone(t),a=i.clone(e));for(var l=i.iter(o);!l.done;l.next()){var u=l.value;a.includes(u)||(n+=1)}return n},reject:function(){return this.score<this.rejectThreshold}}}),n)},cYVN:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("SpAV");o.RoleData=(n=function(e,t,r){for(var n=a.iter(t);!n.done;n.next()){var o=n.value;i.CoreAssert.isTrue(null!=r[o],void 0,"RoleData.init","RoleData.swift",24)}for(var l=a.iter(a.keys(r));!l.done;l.next())o=l.value,i.CoreAssert.isTrue(t.includes(o),void 0,"RoleData.init","RoleData.swift",27);this.forma=e,this.featureOrder=a.clone(t),this.featureValues=a.clone(r)},a.defineClass({name:"RoleData",ctor:n,props:{feat:function(e){return this.featureValues[e]},getUniqueKey:function(){for(var e="",t=a.iter(this.getFeatureVector());!t.done;t.next()){var r=t.value;e=e+a.toString("%.2f",r)+"-"}return e=a.replace(e,".","")},asString:{get:function(){for(var e="",t=a.iter(this.featureOrder);!t.done;t.next()){var r=t.value,n=Math.round(1e3*this.featureValues[r])/1e3;e+=r+": "+a.toString(n)+",\n"}return e}},asJson:{get:function(){return"{\n"+this.asString+"\n}"}},getFeatureVector:function(){for(var e=[],t=a.iter(this.featureOrder);!t.done;t.next()){var r=t.value;e.push(this.featureValues[r])}return e}}}),n)},hywZ:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("SpAV"),l=r("UGKO"),u=r("cmoc"),s=r("xe42"),c=r("16hp"),h=r("9Lk3"),g=r("3DEm"),f=r("uxH+"),p=r("K0Rh"),d=r("sIWg");o.LogoPlacementSuggester=(n=function(e,t){this.CONTRAST_WEIGHT=-10,this.END_BORDER=.98,this.START_BORDER=.02,this.MID_CANONICAL=.5,this.MIN_LIGHTNESS_DIFF=20,this.SYMMETRIC_THRESHOLD=300,c.FormaPlacementSuggester.call(this,e,t)},a.defineClass({name:"LogoPlacementSuggester",ctor:n,superName:"FormaPlacementSuggester",statics:{KIND:{get:function(){return"LogoPlacementSuggester"}}},props:{createPlacementSuggestions:function(e,t){void 0===t&&(t=null);var r=this;if(null==this.group.frame)return[];var n=this.group.frame;if(this.group.kind==p.RootForma.KIND){var o=this.group.page.pageSize;n=d.TheoRect.fromSize(o);var i,u=0,m=this.group.root;if(null!=a.as(m.controller,f.RootController)){var S,v=a.clone(m.filterByControllerKind(h.GridController.KIND));v.length>0&&(S=a.as(v[0].controller,h.GridController))&&(u=S.margin)}(i=this.forma.finalFrame)&&u>0&&(u<i.height||u<i.width)&&(n=d.TheoRect.fromXYWH(u,u,o.width-2*u,o.height-2*u))}for(var F,I=c.FormaPlacementSuggester.createPlacementInputs(this.forma,this.group),R=a.clone(this.getSearchLocations(this.forma,n,I,e,t)),C=-1/0,T=this.initializeLogoPlacementScore(I),_=a.iter(R);!_.done;_.next()){for(var y=_.value,L=c.FormaPlacementSuggester.createPlacementSuggestion(this.forma,y,n,I,T),D=0,A=a.iter(I.backgroundRegions);!A.done;A.next()){var x=A.value;if(null!=y.intersectionWith(x.finalFrame)){var M=a.opt(this.forma.controller,(function(e){return e.getAverageColor(r.forma.finalFrame)})),b=a.opt(x.controller,(function(e){return e.getAverageColor(y)}));if(null!=M&&null!=b&&!a.opt(b,(function(e){return e.contrasts(M)}))){var E=g.MathUtils.absDouble(this.MIN_LIGHTNESS_DIFF-a.opt(b,(function(e){return e.lightnessDifference(M)})));D=g.MathUtils.maxDouble(D,E)}}}a.opt(L.weightedScore,(function(e){return e.setFeature(s.FormaPlacementScore.Features.CONTRAST,a.toDouble(D))})),L.weightedScore.reject()||(T=this.initializeLogoPlacementScore(I)),L.score>C&&(C=L.score,F=L,T=this.initializeLogoPlacementScore(I))}return[a.as(F,l.IDesignSuggestion)]},getSearchLocations:function(e,t,r,n,o){void 0===o&&(o=null),null!=o&&i.CoreAssert.warning("LogoPlacementSuggestor.getSearchLocations ignores requested aspect ratio");var l,u=[];if(l=e.finalFrame){var s=l.height,c=l.width,h=t.evalXY(this.END_BORDER,this.END_BORDER),g=new d.TheoRect(h.x-c,h.y-s,h.x,h.y),f=t.evalXY(this.END_BORDER,this.START_BORDER),p=new d.TheoRect(f.x-c,f.y,f.x,f.y+s);u.push(g),u.push(p);for(var m=a.iter(this.getContentAlignedLocations(t));!m.done;m.next()){var S=m.value;t.contains(S)&&u.push(S)}var v=t.evalXY(this.MID_CANONICAL,this.START_BORDER),F=new d.TheoRect(v.x-c/2,v.y,v.x+c/2,v.y+s),I=t.evalXY(this.START_BORDER,this.START_BORDER),R=new d.TheoRect(I.x,I.y,I.x+c,I.y+s),C=t.evalXY(this.START_BORDER,this.END_BORDER),T=new d.TheoRect(C.x,C.y-s,C.x+c,C.y),_=t.evalXY(this.MID_CANONICAL,this.END_BORDER),y=new d.TheoRect(_.x-c/2,_.y-s,_.x+c/2,_.y),L=this.getSymmetricContentLocations();L&&(u.push(y),u.push(T)),u.push(F),u.push(R),L||(u.push(T),u.push(y))}return u},initializeLogoPlacementScore:function(e){var t=new s.FormaPlacementScore(e);return t.setWeight(s.FormaPlacementScore.Features.XSYMM,0),t.setWeight(s.FormaPlacementScore.Features.YSYMM,0),t.setWeight(s.FormaPlacementScore.Features.EDGE,0),t.setWeight(s.FormaPlacementScore.Features.DISTANCE_TO_CENTER,0),t.setWeight(s.FormaPlacementScore.Features.ALIGNMENT,0),t.setWeight(s.FormaPlacementScore.Features.CONTRAST,a.toDouble(this.CONTRAST_WEIGHT)),t.setWeight(s.FormaPlacementScore.Features.TEXT_OVERLAP,-1e4),t.setWeight(s.FormaPlacementScore.Features.FLOATING_ELEMENT_OVERLAP,-5e3),t},getContentAlignedLocations:function(e){var t,r,n,o;if((t=a.as(this.forma,u.FrameForma))&&(r=t.root)&&(n=r.finalFrame)&&(o=this.forma.finalFrame)){var i=o.height,l=o.width,s=a.clone(r.filterWithCallback((function(e){return null!=e.controller&&e.controller.floating})));if(s.length>0){var c=a.sort(s,(function(e,t){return e.finalFrame.maxY-n.minY<t.finalFrame.maxY-n.minY})),h=a.clone(c[c.length-1].finalFrame.points),g=a.clone(c[0].finalFrame.points),f=a.opt(r.finalFrame,(function(e){return e.locate(h[1].x,h[1].y)})),p=e.evalXY(a.opt(f,(function(e){return e.x})),a.opt(f,(function(e){return e.y}))+this.START_BORDER+.03),m=new d.TheoRect(p.x,p.y,p.x+l,p.y+i),S=a.opt(r.finalFrame,(function(e){return e.locate(h[3].x,h[3].y)})),v=e.evalXY(a.opt(S,(function(e){return e.x})),a.opt(S,(function(e){return e.y}))+this.START_BORDER+.03),F=new d.TheoRect(v.x-l,v.y,v.x,v.y+i),I=a.opt(r.finalFrame,(function(e){return e.locate(g[0].x,g[0].y)})),R=e.evalXY(a.opt(I,(function(e){return e.x})),a.opt(I,(function(e){return e.y}))-this.START_BORDER-.03);return[m,F,new d.TheoRect(R.x-l/2,R.y-i,R.x+l/2,R.y)]}}return[]},getSymmetricContentLocations:function(){var e,t,r,n=this;if((e=a.as(this.forma,u.FrameForma))&&(t=e.root)&&(r=t.finalFrame)){var o=a.clone(t.filterWithCallback((function(e){return null!=e.controller&&e.controller.floating})));return!(o.filter((function(e){return g.MathUtils.absDouble(r.center.distanceTo(e.finalFrame.center))<n.SYMMETRIC_THRESHOLD}),this).length<=a.toInt(o.length/2))}return!1}}}),n)},i0RJ:function(e,t,r){r("oAGj")},iSwi:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("cZuM"),l=r("Z25M"),u=r("CaSj"),s=r("FNB+"),c=r("cmoc"),h=r("9Lk3"),g=r("ZK0l"),f=r("/afT"),p=r("c+uM"),d=r("LqGn"),m=r("7Ta2"),S=r("T6jX"),v=r("8t9B"),F=r("sIWg");o.RetargetSuggester=(n=function e(t,r,n){var o=n.beginTransaction("cleanupRoot");n.controller.setAutomaticLayoutInteractionMode(),n.firstPage.root.isModel=!0,n.firstPage.root.bounds=F.TheoRect.fromSize(n.firstPage.pageSize),this.origModelSize_=n.firstPage.pageSize,this.model_=n.firstPage.root,e.cleanupRoot(this.model_),n.firstPage.setPageSize(t.page.pageSize),o.end(),this.modelDoc_=n,this.originalRoot_=r,u.DesignSuggester.call(this,t,t)},a.defineClass({name:"RetargetSuggester",ctor:n,superName:"DesignSuggester",statics:{KIND:{get:function(){return"RetargetSuggester"}},cleanupRoot:function(e){for(var t=a.clone(e.filterWithCallback((function(e){return e.isTypeLockup()}))),r=a.iter(t);!r.done;r.next()){var o,i,l=r.value;if((o=a.as(l.controller,v.TypeLockupController))&&(i=o.lockupStyle)&&(o.updateGroup(),o.snapSizeToBounds(),1==o.numLines()))for(var u=a.iter(t);!u.done;u.next()){var c=u.value;if(!a.eq(s._equality_Forma_Forma,l,c)){var h=a.as(c.controller,v.TypeLockupController);h.updateGroup();var g=h.numLines(),f=a.opt(h.lockupStyle,(function(e){return e.alignment})),d=1==g||g>1&&(f==p.LockupAlignment.Center||f==p.LockupAlignment.UNSET),m=1==g||g>1&&f==p.LockupAlignment.Left,S=1==g||g>1&&f==p.LockupAlignment.Right;o.beginBlockedUpdate(),n.frameAligned(l,c,.5,null)&&d?(i.alignment=p.LockupAlignment.Center,i.layout=p.LockupLayout.Standard):n.frameAligned(l,c,0,null)&&m?(i.alignment=p.LockupAlignment.Left,i.layout=p.LockupLayout.Standard):n.frameAligned(l,c,1,null)&&S?(i.alignment=p.LockupAlignment.Right,i.layout=p.LockupLayout.Standard):(i.alignment=p.LockupAlignment.Center,i.layout=p.LockupLayout.Standard),o.endBlockedUpdate(),o.styleChanged()}}}},frameAligned:function(e,t,r,n){var o=e.frame,l=t.frame;if(null==o||null==l||null==r&&null==n)return!1;var u,s=1;(u=a.opt(e.page.view,(function(e){return e.getViewportTransform()})))&&(s=Math.sqrt(Math.abs(u.determinant)));var c=i.AlignmentDetector.DISTANCE_THRESHOLD/s,h=!0;return null!=r&&(h=h&&Math.abs(o.evalXY(r,.5).x-l.evalXY(r,.5).x)<c),null!=n&&(h=h&&Math.abs(o.evalXY(.5,n).y-l.evalXY(.5,n).y)<c),h}},props:{model:{get:function(){return this.model_}},createFormaMatches:function(e,t){function r(e){return!(!e.isTypeLockup()&&!e.hasIntent(s.Forma.INTENT_ICON))||!!(t=a.as(e,c.FrameForma))&&t.isLogo();var t}var n=a.clone(e.filterWithCallback(r)),o=a.clone(t.filterWithCallback(r)),i=!S.TheoDocumentUtils.enableFastHeuristicsForComplexPage(e.page),l=!S.TheoDocumentUtils.enableFastHeuristicsForComplexPage(t.page),g=a.clone(f.GroupDetector.detectProximityGroups(a.clone(n),null,i)),p=a.clone(f.GroupDetector.detectProximityGroups(a.clone(o),e.bounds.height/this.origModelSize_.height*150,l));p.length>g.length&&(g=a.clone(f.GroupDetector.splitFormaGroups(a.clone(g),p.length)));var d=a.clone(e.filterWithCallback((function(e){return a.opt(e.controller,(function(e){return e.kind==h.GridController.KIND}))}),s.FormaTraversal.JustChildren)),m=a.clone(t.filterWithCallback((function(e){return a.opt(e.controller,(function(e){return e.kind==h.GridController.KIND}))}),s.FormaTraversal.JustChildren)),v=a.clone(e.filterWithCallback((function(e){return e.isLogo()}))),F=a.clone(t.filterWithCallback((function(e){return e.isLogo()})));a.sortInPlace(g,(function(e,t){return e.length>t.length})),a.sortInPlace(p,(function(e,t){return e.length>t.length})),a.sortInPlace(F,(function(e,t){var r=e.root.finalFrame.center;return e.finalFrame.center.distanceTo(r)<t.finalFrame.center.distanceTo(r)}));for(var I=n.length!=o.length||n.length>4,R=[],C=a.iter(u.DesignSuggester.getPermutations(I?p.length:o.length));!C.done;C.next()){var T=C.value,_=[];if(_.push({a:[a.as(e,s.Forma)],b:[a.as(t,s.Forma)]}),d.length>0&&m.length>0)for(var y=a.iter(a.range(0,d.length,!1));!y.done;y.next()){var L=y.value;_.push({a:[d[L]],b:[m[L%m.length]]})}if(F.length>0)for(var D=a.iter(a.range(0,v.length,!1));!D.done;D.next())L=D.value,_.push({a:[v[L]],b:[F[L%F.length]]});if(n.length>0&&o.length>0)if(I){for(var A=p.concat(),x=[],M=a.iter(a.range(0,A.length,!1));!M.done;M.next())x.push([]);for(var b=a.iter(a.range(0,g.length,!1));!b.done;b.next()){var E=b.value,G=a.clone(g[E]),k=T[E%T.length];a.append(x[k],G)}for(var N=a.iter(a.range(0,A.length,!1));!N.done;N.next())x[L=N.value].length>0&&_.push({a:x[L],b:A[L]})}else for(var P=a.iter(a.range(0,n.length,!1));!P.done;P.next())E=P.value,_.push({a:[n[E]],b:[o[T[E%T.length]]]});R.push(a.clone(_));for(var O=a.iter(a.range(0,_.length,!1));!O.done;O.next()){var W=_[L=O.value],w=Math.max(W.a.length,W.b.length);if(w>1)for(var H=W.a.length==w,U=a.clone(u.DesignSuggester.getPermutations(w,10)),Y=a.iter(a.range(1,U.length,!1));!Y.done;Y.next()){var B=Y.value,V=a.clone(U[B]),X=_.concat(),j=a.clone(X[L].a),z=a.clone(X[L].b);if(H){j=[];for(var K=a.iter(a.range(0,w,!1));!K.done;K.next()){var q=K.value;j.push(X[L].a[V[q]])}}else{z=[];for(var Z=a.iter(a.range(0,w,!1));!Z.done;Z.next())q=Z.value,z.push(X[L].b[V[q]])}X[L]={a:j,b:z},R.push(a.clone(X))}}}return R},createSuggestions:function(){for(var e=this.forma,t=a.clone(this.createFormaMatches(this.originalRoot_,this.model)),r=a.clone(this.originalRoot_.filterWithCallback(l.DesignFeatureUtils.isFloating)),n=a.clone(this.model.filterWithCallback(l.DesignFeatureUtils.isFloating)),o={},i={},u=new m.RoleSuggester,s=this.model.filterWithCallback((function(e){return e.isTypeLockup()})).concat(this.originalRoot_.filterWithCallback((function(e){return e.isTypeLockup()}))),c=a.iter(s);!c.done;c.next()){var h=c.value;a.opt(a.as(h.controller,g.GroupController),(function(e){return e.beginBlockedUpdate()}))}if(!S.TheoDocumentUtils.enableFastHeuristicsForComplexPage(e.page)){for(var f=a.iter(r);!f.done;f.next()){var p=f.value;o[p.formaID]=a.clone(u.getRole(p))}for(var v=a.iter(n);!v.done;v.next()){var F=v.value;i[F.formaID]=a.clone(u.getRole(F))}}for(var I=[],R=a.iter(t);!R.done;R.next()){var C=R.value;I.push(new d.RetargetSuggestion(this.forma,this.originalRoot_,this.model,this.modelDoc_,a.clone(C),a.clone(o),a.clone(i)))}for(var T=a.iter(s);!T.done;T.next())h=T.value,a.opt(a.as(h.controller,g.GroupController),(function(e){return e.endBlockedUpdate()}));return a.sort(I,(function(e,t){return e.score>t.score}))}}}),n)},lYNH:function(e,t,r){var n,o,a,i=t,l=r("oAGj"),u=r("uj1m"),s=r("7Ta2"),c=r("taeg");i.ShapeRoleSuggesterFactory=(n=function(){},l.defineClass({name:"ShapeRoleSuggesterFactory",ctor:n,statics:{Create:function(e){return void 0===e&&(e=""),"MLP"==e?new i.ShapeRoleSuggesterMLP:new i.ShapeRoleSuggesterSimple}}}),n),i.ShapeRoleSuggesterMLP=(o=function(){c.RoleSuggesterMLP.call(this)},l.defineClass({name:"ShapeRoleSuggesterMLP",ctor:o,superName:"RoleSuggesterMLP",statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRoleModel:function(){var e=u.MLPModel.loadNNModel("ShapeRole");return l.opt(e,(function(e){return e.finalSoftmax=!1})),e}}}),o),i.ShapeRoleSuggesterSimple=(a=function(){},l.defineClass({name:"ShapeRoleSuggesterSimple",ctor:a,statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRole:function(e){var t=s.InferredRoleType.Undefined;return e.forma.isGridCell()&&(t=e.forma.controller.floating?s.InferredRoleType.Backing:s.InferredRoleType.Background),s.InferredRole.init_84d1(t,1)}}}),a)},"p+tC":function(e,t,r){var n,o,a,i=t,l=r("oAGj"),u=r("SpAV"),s=r("uj1m"),c=r("txj3"),h=r("nrTo"),g=r("35Q0"),f=r("UqVc"),p=r("ThKb");i.predictCategory=!0,i.RawDataShapeSuggester=(n=function(){},l.defineClass({name:"RawDataShapeSuggester",ctor:n,props:{init_b1f8:function(e,t,r,n,o,a,i,l,u,s){this.numImages=e,this.numShapes=t,this.charLength=r,this.lineHeight=n,this.font=o,this.layout=a,this.textWidth=i,this.textHeight=l,this.centerX=u,this.centerY=s},getUniqueKey:function(){var e="";return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e+l.toString(this.numImages)+"-")+l.toString(this.numShapes)+"-")+l.toString(this.charLength)+"-")+l.toString(this.lineHeight)+"-")+this.font+"-")+this.layout+"-")+l.toString(this.textWidth)+"-")+l.toString(this.textHeight)+"-")+l.toString(this.centerX)+"-")+l.toString(this.centerY)+"-"},init_implicit:function(e,t,r,n,o,a,i,l,u,s){this.numImages=e,this.numShapes=t,this.charLength=r,this.lineHeight=n,this.font=o,this.layout=a,this.textWidth=i,this.textHeight=l,this.centerX=u,this.centerY=s},clone:function(){return n.init_implicit(this.numImages,this.numShapes,this.charLength,this.lineHeight,this.font,this.layout,this.textWidth,this.textHeight,this.centerX,this.centerY)}}}),n),i.ShapeSuggester=(o=function(){this.shapeCatMap={},this.shapeCatMap.banner=g.TagGroup.banner,this.shapeCatMap.square=g.TagGroup.square,this.shapeCatMap.other=g.TagGroup.other,this.shapeCatMap.circle=g.TagGroup.circle,this.shapeCatMap.decorative=g.TagGroup.decorative,this.shapeCatMap.none=g.TagGroup.none,l.defctor(this)},a={},l.defineClass({name:"ShapeSuggester",ctor:o,statics:{cache:{get:function(){return void 0===a.cache&&(a.cache=new h.PredictionCacheDouble),a.cache},set:function(e){a.cache=e}}},props:{getShapeSuggesterFeatures:function(e,t){var r=e.numImages,n=e.shapeCount,a=e.selectedLockup.charCount,u=l.toInt(e.selectedLockup.lineHeight),s=e.selectedLockup.font,c=e.selectedLockup.styleAttributes.layout,h=l.clone(e.selectedLockup.pts),g=(h[0].x+h[3].x)/2/e.width,f=(h[0].y+h[3].y)/2/e.height,p=l.toInt(e.selectedLockup.width),d=l.toInt(e.selectedLockup.height),m=l.clone(i.RawDataShapeSuggester.init_b1f8(r,n,a,u,s,c,p,d,g,f));return o.cache.cleanup(t.page.document.uuid),m},getScores:function(e,t){var r=this,n=t.getUniqueKey();if(null==o.cache.getCacheValue(n)){var a,h=[],d=0;if(a=s.MLPModel.loadNNModel("Shape")){var m,S,v,F=l.repeat(0,55),I=l.repeat(0,4),R=l.repeat(0,8);R[0]=l.toDouble(t.numShapes),R[1]=l.toDouble(t.numShapes),R[2]=l.toDouble(t.charLength),R[3]=l.toDouble(t.lineHeight),R[4]=l.toDouble(t.textWidth),R[5]=l.toDouble(t.textHeight),R[6]=l.toDouble(t.centerX),R[7]=l.toDouble(t.centerY),null!=(S=l.indexOf(a.fonts,t.font))&&(F[S]=1),null!=(v=l.indexOf(a.layouts,t.layout))&&(I[v]=1);var C=l.clone(R.concat(l.clone(F)).concat(l.clone(I)));u.CoreAssert.isTrue(67==C.length,void 0,"ShapeSuggester.getScores","ShapeSuggester.swift",148);var T=new p.TheoMatrix([C]).subtract(a.featureScalingMean).divide(a.featureScalingStd),_=new c.NNMLPClassifier(l.clone(a.coefficients),l.clone(a.intercepts)).predict(T.transpose()),y=l.clone(_.transpose().asArray);m=l.clone(a.shapes);for(var L={},D=l.iter(l.toSequence(y[0]));!D.done;D.next()){var A=D.value,x=A.offset,M=A.element;L[m[x]]=M,d=Math.max(d,M)}0==i.predictCategory?e.forEach((function(e){var t;null!=(t=L[e])?h.push(t+.2):h.push(0)})):e.forEach((function(e){var t=0;m.forEach((function(n){var o;l.opt(g.ShapeLibrary.getShapeDataForArtworkId(e),(function(e){return 1==e.tags.includes(r.shapeCatMap[n])}))&&null!=(o=L[n])&&(t=o)})),"row"==e?t=d+.5:l.opt(g.ShapeLibrary.getShapeDataForArtworkId(e),(function(e){return 1==e.tags.includes(r.shapeCatMap.none)}))&&(t=.1),h.push(t)}))}o.cache.setCacheValue(n,l.clone((new f.SuggestionUtils).normalizedWeights(l.clone(h))))}return o.cache.getCacheValue(n)}}}),o)},taeg:function(e,t,r){var n,o,a=t,i=r("oAGj"),l=r("iCxV"),u=r("txj3"),s=r("nrTo"),c=r("7Ta2"),h=r("ThKb");a.RoleSuggesterMLP=(n=function(){},o={},i.defineClass({name:"RoleSuggesterMLP",ctor:n,statics:{cache:{get:function(){var e;return void 0===o.cache&&(o.cache=((e=i.opt(l.Host.platform,(function(e){return e.isService})))||null!=e)&&e?i.opt(l.Host.learning,(function(e){return e.getHostPredictionCache()})):new s.PredictionCacheInferredRole),o.cache},set:function(e){o.cache=e}},_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRoleModel:function(){return null},getRole:function(e){var t,r,o=i.clone(c.InferredRole.init_84d1()),a=e.getUniqueKey();if(null==n.cache.getCacheValue(a)){var l,s=0,g="",f=0,p="";if(l=this.getRoleModel()){var d,m=i.clone(e.getFeatureVector()),S=i.clone(m),v=new h.TheoMatrix([S]).subtract(l.featureScalingMean).divide(l.featureScalingStd),F=new u.NNMLPClassifier(i.clone(l.coefficients),i.clone(l.intercepts),l.finalSoftmax).predict(v.transpose()),I=i.clone(F.transpose().asArray);d=i.clone(l.roles);for(var R={},C=i.iter(i.toSequence(I[0]));!C.done;C.next()){var T=C.value,_=T.offset,y=T.element;R[d[_]]=y,y>s?(f=s,p=g,s=y,g=d[_]):y>f&&(f=y,p=d[_])}}var L=(t=c.InferredRoleType.toCaseValue(g))||null!=t?t:c.InferredRoleType.Undefined,D=(r=c.InferredRoleType.toCaseValue(p))||null!=r?r:c.InferredRoleType.Undefined;o=i.clone(c.InferredRole.init_84d1(L,s,D,f)),n.cache.setCacheValue(a,i.clone(o))}return n.cache.getCacheValue(a)}}}),n)},"ws+m":function(e,t,r){var n,o,a=t,i=r("oAGj"),l=r("6ZWm"),u=r("7Ta2");a.ImageRoleSuggesterFactory=(n=function(){},i.defineClass({name:"ImageRoleSuggesterFactory",ctor:n,statics:{Create:function(e){return void 0===e&&(e=""),new a.ImageRoleSuggesterSimple}}}),n),a.ImageRoleSuggesterSimple=(o=function(){},i.defineClass({name:"ImageRoleSuggesterSimple",ctor:o,statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRole:function(e){var t,r=e.forma,n=u.InferredRoleType.Undefined;if(t=i.as(r.controller,l.FrameController)){if(r.isGridCell())return u.InferredRole.init_84d1(u.InferredRoleType.Background,1);if(r.isLogo())return u.InferredRole.init_84d1(u.InferredRoleType.Logo,1,u.InferredRoleType.GraphicContent,.5);if(t.floating)return u.InferredRole.init_84d1(u.InferredRoleType.GraphicContent,1)}return u.InferredRole.init_84d1(n,1)}}}),o)},xRbc:function(e,t,r){var n,o=t,a=r("oAGj"),i=r("wc1n"),l=r("cYVN"),u=r("35Q0");o.LockupRoleFeatures=a.defineEnum("LockupRoleFeatures",{WordCount:"WordCount",CharacterCount:"CharacterCount",intsSpecialsCount:"intsSpecialsCount",webReferencesCount:"webReferencesCount",checkSocialChar:"checkSocialChar",Spacing:"Spacing",Padding:"Padding",ShapeFilled:"ShapeFilled",TextWidth:"TextWidth",TextHeight:"TextHeight",PercentageArea:"PercentageArea",CenterX:"CenterX",CenterY:"CenterY",PageHeight:"PageHeight",PageWidth:"PageWidth",otherLockupPercDesignArea:"otherLockupPercDesignArea",TextCount:"TextCount",actionWordsCount:"actionWordsCount",TextString:"TextString",BackingShape:"BackingShape",PerAreaAllLockups:"PercentageAreaAllLockups",CollisionPercentage:"CollisionPercentage",SurroundingAlignment:"SurroundingAlignment"}),o.LockupRoleData=(n=function(e,t,r){l.RoleData.call(this,e,a.clone(t),a.clone(r))},a.defineClass({name:"LockupRoleData",ctor:n,superName:"RoleData",statics:{digits:"0123456789/@|",webReferenceStrings:[".com","http",".edu",".org",".gov"],actionWordStrings:["join","now","today","try","view","swipe"],socialMediaStrings:["#","instagram"],getLockupRoleData:function(e){var t=[o.LockupRoleFeatures.WordCount,o.LockupRoleFeatures.CharacterCount,o.LockupRoleFeatures.intsSpecialsCount,o.LockupRoleFeatures.checkSocialChar,o.LockupRoleFeatures.webReferencesCount,o.LockupRoleFeatures.Spacing,o.LockupRoleFeatures.Padding,o.LockupRoleFeatures.ShapeFilled,o.LockupRoleFeatures.TextWidth,o.LockupRoleFeatures.TextHeight,o.LockupRoleFeatures.PercentageArea,o.LockupRoleFeatures.CenterX,o.LockupRoleFeatures.CenterY,o.LockupRoleFeatures.PageWidth,o.LockupRoleFeatures.PageHeight,o.LockupRoleFeatures.otherLockupPercDesignArea,o.LockupRoleFeatures.TextCount,o.LockupRoleFeatures.actionWordsCount],r=[o.LockupRoleFeatures.TextString,o.LockupRoleFeatures.BackingShape,o.LockupRoleFeatures.PerAreaAllLockups],l=i.FeatureExtractorFactory.getFeatureExtractor(i.FeatureExtractorType.LockupStyle,e,a.clone(a.as(t.concat(r),["Array","String"]))),u=a.clone(l.numericalFeatures);a.removeKey(u,o.LockupRoleFeatures.PerAreaAllLockups);var s=l.categoricalFeatureForKey(o.LockupRoleFeatures.TextString),c=l.categoricalFeatureForKey(o.LockupRoleFeatures.BackingShape),h=l.numericFeatureForKey(o.LockupRoleFeatures.PerAreaAllLockups);return u[o.LockupRoleFeatures.actionWordsCount]=a.toDouble(n.getNumActionWordReferences(s)),u[o.LockupRoleFeatures.checkSocialChar]=n.checkSocialMediaCharacters(s,c)?1:0,u[o.LockupRoleFeatures.intsSpecialsCount]=a.toDouble(n.getNumIntsAndSpecials(s)),u[o.LockupRoleFeatures.webReferencesCount]=a.toDouble(n.getNumWebReferences(s)),u[o.LockupRoleFeatures.otherLockupPercDesignArea]=h-u[o.LockupRoleFeatures.PercentageArea],new n(e,a.clone(t),a.clone(u))},getNumIntsAndSpecials:function(e){for(var t=0,r=a.iter(a.range(0,e.length,!1));!r.done;r.next()){var o=r.value,i=e.substr(o,1);n.digits.includes(i)&&(t+=1)}return t},getNumWebReferences:function(e){for(var t=0,r=a.iter(n.webReferenceStrings);!r.done;r.next()){var o=r.value;e.toLowerCase().includes(o)&&(t+=1)}return t},getNumActionWordReferences:function(e){for(var t=0,r=a.iter(n.actionWordStrings);!r.done;r.next()){var o=r.value;e.toLowerCase().includes(o)&&(t+=1)}return t},checkSocialMediaCharacters:function(e,t){for(var r,o=!1,i=a.iter(n.socialMediaStrings);!i.done;i.next()){var l=i.value;e.includes(l)&&(o=!0)}return(r=u.ShapeLibrary.shapeDictionary[t])&&r.category==u.ShapeCategory.Social&&(o=!0),o},checkLockupIsGraphic:function(e,t){for(var r=!1,n="",o=a.iter(a.range(0,e.length,!1));!o.done;o.next()){var i=o.value,l=e.substr(i,1);" "!=l&&"\n"!=l&&"\t"!=l&&"\r"!=l&&(n+=l)}return n.length<=1&&t.category!=u.ShapeCategory.None&&(r=!0),r}}}),n)},zbwF:function(e,t,r){var n,o,a,i=t,l=r("oAGj"),u=r("xRbc"),s=r("uj1m"),c=r("7Ta2"),h=r("taeg");i.LockupRoleSuggesterFactory=(n=function(){},l.defineClass({name:"LockupRoleSuggesterFactory",ctor:n,statics:{Create:function(e){return void 0===e&&(e=""),"MLP"==e?new i.LockupRoleSuggesterMLP:new i.LockupRoleSuggesterSimple}}}),n),i.LockupRoleSuggesterMLP=(o=function(){h.RoleSuggesterMLP.call(this)},l.defineClass({name:"LockupRoleSuggesterMLP",ctor:o,superName:"RoleSuggesterMLP",statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRoleModel:function(){return s.MLPModel.loadNNModel("TextRole")}}}),o),i.LockupRoleSuggesterSimple=(a=function(){},l.defineClass({name:"LockupRoleSuggesterSimple",ctor:a,statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRole:function(e){var t,r=c.InferredRoleType.Undefined;if(t=l.as(e,u.LockupRoleData)){var n=t.feat(u.LockupRoleFeatures.WordCount),o=t.feat(u.LockupRoleFeatures.TextCount),a=t.feat(u.LockupRoleFeatures.TextHeight),i=t.feat(u.LockupRoleFeatures.intsSpecialsCount),s=t.feat(u.LockupRoleFeatures.checkSocialChar)>0,h=t.feat(u.LockupRoleFeatures.PercentageArea),g=t.feat(u.LockupRoleFeatures.otherLockupPercDesignArea);r=n<=5&&a>=80?c.InferredRoleType.Title:n<=9&&a>=250?c.InferredRoleType.Title:n<=14?c.InferredRoleType.SubTitle:c.InferredRoleType.Body,i>=5&&n<=18&&a<=220&&(r=c.InferredRoleType.Contact),s&&(r=c.InferredRoleType.Social),o<=3&&h>g&&(r!=c.InferredRoleType.Body&&r!=c.InferredRoleType.Social||(r=c.InferredRoleType.Title))}return c.InferredRole.init_84d1(r,1)}}}),a)}}]);
//# sourceMappingURL=vendors_npm_spark_c8102c22-9e7877a3.js.map