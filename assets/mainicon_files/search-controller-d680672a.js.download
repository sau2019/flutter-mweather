(window.webpackJsonp=window.webpackJsonp||[]).push([["search-controller"],{1873:function(e,s,t){var r,i;r=[t(1),t(0),t(2),t(3)],void 0===(i=function(e,s,t,r){"use strict";return new(t.Model.extend({isClipboardSupported:function(){return document.queryCommandSupported("copy")},copyFieldToClipboard:function(e){var s;e.select();try{document.execCommand("copy")||(s="execCommand returned false")}catch(e){s="caught-error: "+e.message,window.marvel.logger.debug("Clipboard copy error:"+e.message,e)}if(s)throw new Error("Could not copy string to clipboard: "+s)},copyStringToClipboard:function(s){var t=e("<input>");t.css({position:"absolute",transform:"translateX(-5000px)"}),e("body").append(t),t.val(s);try{this.copyFieldToClipboard(t)}finally{t.remove()}}}))}.apply(s,r))||(e.exports=i)},2072:function(e,s,t){var r=t(3050);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};t(35)(r,i);r.locals&&(e.exports=r.locals)},3048:function(e,s){e.exports='<ul class="search-results-ul show-group-lines">\n{{#selectedTags}}\n<div class="search-result-group-line search-result-group-line-tags search-result-group-line-tags-{{id}}" data-id="{{id}}">{{npw-vb-search-box-section-filters}}\n    {{#numSelected}}\n    <button class="search-box-filters-clear-all enabled" title="{{npw-vb-search-box-section-filters-clear-title}}">{{npw-vb-search-box-section-filters-clear}}</button>\n    {{/numSelected}}\n    {{^numSelected}}\n    <button class="search-box-filters-clear-all"  title="{{npw-vb-search-box-section-filters-clear-title}}" disabled>{{npw-vb-search-box-section-filters-clear}}</button>\n    {{/numSelected}}\n<div class="search-result-group-line-tags-tags{{#atMaxTags}} at-max-tags{{/atMaxTags}}">\n{{#items}}\n    <button class="search-result-group-line-tag search-results-selected-tag search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}}{{#ifShowingAll}} if-showing-all{{/ifShowingAll}} search-result-group-line-tag-tag-{{id}} {{debugCssStr}}" title="{{itemTitle}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{label}}</button>\n{{/items}}\n{{#numMoreItems}}\n    <button class="search-result-group-line-tag search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}} search-result-group-line-tag-tag-{{id}} show-more-tags-btn {{debugCssStr}}" data-group-id="{{groupId}}" data-id="{{id}}" >...</button>\n{{/numMoreItems}}\n</div>\n</div>\n<div class="search-result-group-line search-result-group-line-rule"></div>\n{{/selectedTags}}\n{{#numResults}}\n{{#tagLines}}\n    <li class="search-result-result-line search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n{{/tagLines}}\n{{#hasTextOrSuggestionLines}}\n<li class="search-result-group-line-tags-label">{{npw-vb-search-box-section-searching-for}}</li>\n{{#hasTextLines}}\n    {{#textLines}}\n    <li class="search-result-result-line search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n    {{/textLines}}\n{{/hasTextLines}}\n{{#hasSuggestionLines}}\n    {{#suggestionLines}}\n    <li class="search-result-search-suggest-line no-indent search-result-search-suggest-line-user-text search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n    {{/suggestionLines}}\n{{/hasSuggestionLines}}\n{{/hasTextOrSuggestionLines}}\n<div class="search-result-group-line search-result-group-line-rule"></div>\n{{#tagLinesGroups}}\n<li class="search-result-group-line-tags-label">{{npw-vb-search-box-section-related}}</li>\n{{#items}}\n    <li class="search-result-group-line-tag {{#isAddText}} search-add-text-tag{{/isAddText}}{{^ifShowingAll}} search-result-line-can-arrow-nav{{/ifShowingAll}}{{#ifShowingAll}} if-showing-all{{/ifShowingAll}} search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}} search-result-group-line-tag-tag-{{id}} {{debugCssStr}}" title="{{itemTitle}}" data-group-id="{{groupId}}" data-text="{{label}}" data-id="{{id}}" data-src-key="{{srcKey}}">&mldr; {{label}}</li>\n{{/items}}\n{{#numMoreItems}}\n    <li class="search-result-group-line-tag search-results-tag-button search-result-line-can-arrow-nav search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}} search-result-group-line-tag-tag-{{id}} show-more-tags-btn{{#isAddText}} search-add-text-tag{{/isAddText}} {{debugCssStr}}" data-group-id="{{groupId}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{npw-vb-search-results-related-more}}</li>\n{{/numMoreItems}}\n{{/tagLinesGroups}}\n{{/numResults}}\n{{^numResults}}\n{{#fromNoResults}}\n{{^selectedTags.numSelected}}\n<div class="search-result-group-line search-result-no-results-line">{{npw-vb-search-box-section-sorry}}</div>\n{{/selectedTags.numSelected}}\n{{#selectedTags.numSelected}}\n<div class="search-result-group-line search-result-no-results-line">{{npw-vb-search-box-section-sorry-filters}}</div>\n{{/selectedTags.numSelected}}\n{{/fromNoResults}}\n{{#historySearches}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-previous}}</div>\n{{#searches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-history search-result-line-can-arrow-nav" data-app="{{app}}" data-label="{{label}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{label}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label-{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/searches}}\n{{/historySearches}}\n{{#popularSearches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-use-cases" data-term="{{term}}">{{term}}</li>\n{{/popularSearches}}\n{{/numResults}}\n{{#showPopular}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-popular}}</div>\n{{#searches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-search search-result-line-can-arrow-nav{{#commandType}} is-command{{/commandType}}" data-app="{{app}}" data-command-type="{{commandType}}" data-label="{{label}}" data-src-label="{{srcLabel}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{label}}{{#translation}}<span class="search-result-line-popular-translation">&nbsp;({{.}})</span>{{/translation}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/searches}}\n{{/showPopular}}\n{{#showCategorySearches}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-categories}}</div>\n{{#categorySearches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-category search-result-line-can-arrow-nav{{#commandType}} is-command{{/commandType}}" data-app="{{app}}" data-command-type="{{commandType}}" data-label="{{label}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{labelG11n}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/categorySearches}}\n{{/showCategorySearches}}\n\n</ul>\n'},3049:function(e,s){e.exports='{{#displayArray}}<span class="search-result-line-span-tag search-result-colored-tag-{{prefix}} {{debugCssStr}}" title="{{#debugCssStr}}{{tag}}{{/debugCssStr}}">{{#chunks}}{{#src}}<span class="search-result-result-line-span-src">{{{.}}}</span>{{/src}}{{#hint}}<span class="search-result-result-line-span-hint">{{{.}}}</span>{{/hint}}{{{space}}}{{/chunks}}</span>{{/displayArray}}{{#showAnyCounts}}{{#totalCount}}<span class="search-result-result-line-span-count search-app-color-all"> ({{totalCount}})</span>{{/totalCount}}{{/showAnyCounts}}'},3050:function(e,s,t){(e.exports=t(34)(!1)).push([e.i,'@-webkit-keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes appear{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeTo{0%{opacity:0}to{opacity:.15}}@keyframes fadeTo{0%{opacity:0}to{opacity:.15}}.search-app-color-all{color:#35414c}.search-results-grid-item-thumb-premium-icon{display:none;background-image:url(/images/icon-premium-template-badge.svg);width:20px;height:27px;background-repeat:no-repeat;background-size:contain;position:absolute;right:4px;top:-4px}.search-results-grid-view-holder{display:block;left:0;position:relative;width:100%;height:calc(100vh - 112px);padding:0 0 10px;z-index:1;background-color:#fff;opacity:1}.search-results-grid-view-holder.search-view-in-container{height:calc(100% - 72px);top:72px;position:absolute;background-color:inherit}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder{z-index:1}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header{z-index:1;top:-32px;width:100%}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas{display:none}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-create{left:auto;right:0;top:-57px;-webkit-transform:none;transform:none;right:16px}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow{top:-40px;position:relative;height:100%;width:50px;background-color:transparent;background-position:0;background-image:url(/images/spectrum-back-arrow-valley.svg);background-repeat:no-repeat;background-size:18px;margin-left:34px;cursor:pointer}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow:hover{background-image:url(/images/spectrum-back-arrow-midnight.svg)}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow.has-text{padding-left:30px;line-height:66px;text-transform:uppercase;width:auto;outline:none;font-weight:700;font-size:12px;color:#82919b;transition:color .2s ease-in-out}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow.has-text:hover{color:#35414c}.search-results-grid-view-holder .search-results-grid-view{position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);height:100%;width:100%;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container{width:100%;text-align:center}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder{position:relative;width:calc(100% - 48px);display:inline-block}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder .search-results-tags-scroller{width:100%;left:0;overflow:auto;height:80px;position:relative;-webkit-flex-shrink:0;flex-shrink:0}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder .search-results-tags-scroller .search-results-tags{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;align-items:flex-start;-webkit-justify-content:center;justify-content:center;padding-top:13px;height:100%}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder.narrow-tags-area{width:calc(100% - 24px)}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder.narrow-tags-area .search-results-tags-scroller{width:100%}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder.scrolling-disabled .search-results-tags-scroller{overflow:hidden}.search-results-grid-view-holder .search-results-grid-view .search-results-tags-container .search-results-tags-scroller-holder .search-results-tags.at-max-tags .search-results-tag:not(.selected):not(.search-results-tag-tag-premium){background-color:#f2f4f5;opacity:.5}.search-results-grid-view-holder .search-results-grid-view .search-results-pagination{color:#35414c;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;font-weight:500;text-align:center;-webkit-align-items:center;align-items:center;height:100px;overflow-y:hidden}.search-results-grid-view-holder .search-results-grid-view .search-results-pagination .search-results-pagination-more{margin-top:12px}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item .search-results-grid-item-thumb-icon{display:none}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-page .search-results-grid-item-thumb-icon{width:100%;height:35px;left:0;bottom:0;display:block;background-image:url(/images/npw/visualBrowse/thumb-icon-page-footer35.svg);position:absolute;background-repeat:no-repeat;background-size:contain;background-color:#fff;background-position:50%}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-page .search-results-grid-item-thumb-icon.non-expandable{height:25px;background-size:cover}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item .search-results-grid-item-thumb-favorite-icon{background-repeat:no-repeat;background-position:0;background-size:contain;background-image:url(/images/npw/visualBrowse/icon-heart-empty.svg);width:24px;height:24px;position:absolute;top:3px;right:3px;opacity:0;display:block;cursor:pointer;transition:opacity .2s ease-in-out;z-index:2}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-favorite-icon:hover,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item .search-results-grid-item-thumb-favorite-icon:hover{background-image:url(/images/npw/visualBrowse/icon-heart-empty-no-background-hover.svg)}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.is-favorite .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.is-favorite .search-results-grid-item-thumb-favorite-icon{background-image:url(/images/npw/visualBrowse/icon-heart-solid-with-border.svg);opacity:1}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.is-favorite .search-results-grid-item-thumb-favorite-icon:hover,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.is-favorite .search-results-grid-item-thumb-favorite-icon:hover{background-image:url(/images/npw/visualBrowse/icon-heart-solid-no-border.svg)}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon{opacity:0}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item:not(.is-favorite):hover .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item:not(.is-favorite):hover .search-results-grid-item-thumb-favorite-icon{opacity:1}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.expand:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.expand:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon{display:block}.search-results-grid-view-holder .search-results-grid-holder{overflow-y:auto;overflow-x:hidden;width:100%;padding:0 12px}.search-results-grid-view-holder .search-results-grid-holder:hover{overflow-y:auto;overflow-x:hidden}.search-results-grid-view-holder .search-results-grid-item-detail-holder{top:60px;height:calc(100vh - 175px);min-height:240px;width:100%;position:absolute;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;transition:opacity .2s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder.revealing{opacity:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .share-results-share-button{cursor:pointer;color:#35414c;background-color:#fff;margin-top:12px;border-radius:16px;padding:8px;width:100%;text-align:center;opacity:1;font-weight:700;font-size:14px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .share-results-share-button:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-overlay-bg{z-index:105;position:fixed;left:0;top:-120px;width:101vw;height:110vh;background-color:rgba(0,0,0,.5)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal{display:block;padding:0 10%;overflow:hidden}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg{overflow:hidden;background-color:#fff;border-radius:6px;-webkit-transform:translateY(75%);transform:translateY(75%);padding:16px 5px 0;color:#82919b;margin:0 auto;max-width:240px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg.field-view{max-width:300px;padding-bottom:24px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .x-close-btn{position:absolute;right:8px;top:8px;background-image:url(/images/close_active.svg);background-color:transparent;background-repeat:no-repeat;background-size:contain;background-position:50%;width:16px;height:16px;border:none;outline:none;cursor:pointer;color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .x-close-btn:hover{background-image:url(/images/close_hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-header{background-color:#e8ebed;border-top-left-radius:6px;border-top-right-radius:6px;padding:6px 16px 5px;margin:-16px -5px 8px;font-size:15x;font-weight:700;height:30px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-title{color:#35414c;margin-bottom:10px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea{width:100%;resize:none;height:38px;border:1px solid #e1e1e1;border-radius:6px;padding:8px;box-sizing:border-box;color:#35414c}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea.embed{height:80px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea.textarea-edit-display{text-overflow:clip}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea:focus{border:1px solid #82919b;outline:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line{font-weight:700;padding:11px 16px 12px 46px;background-repeat:no-repeat;background-position:13px;background-size:22px;border-radius:6px;cursor:pointer;opacity:.75;line-height:normal;margin-bottom:8px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line:hover{background-color:#dce0e3;color:#35414c;opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.twitter{background-size:24px;background-image:url(/images/icon-social-twitter.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.facebook{background-image:url(/images/icon-social-facebook.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.embed{background-image:url(/images/icon-social-embed-sp.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy{background-image:url(/images/icon-social-copy.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy span{font-size:inherit;font-weight:inherit}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy span.copied-span{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover{background-color:#82919b;color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover.copied span.copied-span{display:inline-block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover.copied span.copy-span{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.message{background-image:url(/images/icon-social-message.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.email{background-image:url(/images/icon-social-email.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right{position:relative;width:25%;height:100%;background:#35414c;padding:24px 12px;display:none;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-ctas .search-results-grid-item-detail-right-cta{font-size:14px;font-weight:700;color:#fff;border-radius:16px;background-color:#1473e6;padding:8px;text-align:center;width:100%;cursor:pointer;opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-ctas .search-results-grid-item-detail-right-cta:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-tags{display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-tags .search-results-grid-item-detail-right-tag{padding:4px 8px;font-size:13px;margin:4px 4px 0 0;border-radius:18px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header{position:fixed;width:100vw;height:66px;top:-113px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-create{background-color:#1473e6;color:#fff;font-size:15px;font-weight:700;border-radius:20px;width:auto;padding:0 20px;height:40px;line-height:40px;position:fixed;top:-100px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas{display:-webkit-flex;display:flex;position:absolute;top:20px;right:32px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta{cursor:pointer;color:#35414c;font-size:14px;font-weight:700;height:32px;line-height:30px;border:1px solid #fff;border-radius:20px;padding:0 8px 0 26px;background-position:4px;background-repeat:no-repeat;opacity:1;transition:opacity .1s ease-in-out,background-color .1s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta span{font-weight:inherit;font-size:inherit;color:inherit}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-share{background-image:url(/images/spectrum-share-midnight.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite{width:134px;text-align:left;padding-left:30px;background-image:url(/images/npw/visualBrowse/icon-heart-empty-with-background.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite .search-results-grid-item-detail-header-cta-favorite-is-not{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite .search-results-grid-item-detail-header-cta-favorite-is{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite{background-image:url(/images/npw/visualBrowse/icon-heart-solid-no-border.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite .search-results-grid-item-detail-header-cta-favorite-is-not{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite .search-results-grid-item-detail-header-cta-favorite-is{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail{background-color:#fff;width:100%;height:100%;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller-holder{height:25%;background-color:#fff;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller{width:100%;height:100%;overflow-y:hidden;overflow-x:scroll}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section{width:auto;height:100%;display:-webkit-flex;display:flex;-webkit-align-items:flex-start;align-items:flex-start}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item{margin:0 4px;height:100%;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item:first-child{margin-left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item:last-child{margin-right:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-thumb{height:calc(100% - 5px);background-repeat:no-repeat;background-size:contain;background-position:50%;position:relative;opacity:.5;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-thumb .search-results-grid-item-detail-other-results-item-thumb-loader{left:2px;top:2px;width:calc(100% - 4px);height:calc(100% - 4px);position:absolute}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-selection{position:absolute;bottom:0;background-color:transparent;width:100%;height:3px;margin-top:2px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item.selected .search-results-grid-item-detail-other-results-item-selection{display:block;background-color:#1473e6}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item.selected .search-results-grid-item-detail-other-results-item-thumb{width:calc(100% - 4px);height:calc(100% - 4px);opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section{width:100%;height:75%;min-height:160px;display:-webkit-flex;display:flex;background-color:#f2f4f5}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{position:relative;width:100%;max-width:calc(100% - 100px);height:100%}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{margin:8px 0 0;height:40px;-webkit-justify-content:left;justify-content:left;overflow-x:auto;overflow-y:hidden;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder{height:100%;width:auto;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading{position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;width:100%;height:100%}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-image{z-index:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-nav{width:50px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav{position:relative;top:0;background-repeat:no-repeat;width:75px;height:calc(100% - (3vh + 36px));z-index:1;pointer-events:none;opacity:.5}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav .search-results-grid-item-detail-nav-icon{background-size:24px;background-repeat:no-repeat;height:100%;width:32px;position:absolute;pointer-events:auto}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left{left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon{right:0;background-position:100%;background-image:url(/images/caret-left.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon:hover{background-image:url(/images/caret-left-hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right{right:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon{left:0;background-position:0;background-image:url(/images/caret-right.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon:hover{background-image:url(/images/caret-right-hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail.can-nav .search-results-grid-item-detail-nav{opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail-right{display:-webkit-flex;display:flex}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail{width:75%}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail-header{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder{z-index:2;top:-47px;height:calc(100% + 47px)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section{width:100%;height:calc(82vh - 66px);padding-top:5vh}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;margin:3vh 0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags .search-results-tag-button{padding:0 10px;margin:0 3px;border:1px solid #35414c;height:28px;line-height:25px;opacity:1;font-weight:500;transition:opacity .1s ease-in-out,background-color .1s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags .search-results-tag-button:hover{background-color:rgba(0,0,0,.05)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-other-results-section-scroller-holder{height:18vh;padding-top:1.75vh}.search-results-grid-view-holder .search-results-grid{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;padding-bottom:66px;width:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);position:relative}.search-results-grid-view-holder .search-results-grid .search-results-grid-row{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-between;justify-content:space-between;width:100%;margin-top:20px}.search-results-grid-view-holder .search-results-grid .search-results-grid-row:first-child{margin-top:0}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row{-webkit-justify-content:flex-start;justify-content:flex-start}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow{-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow:after,.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow:before{content:"";display:block}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item{position:relative;text-decoration:none;color:#35414c;cursor:default}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:hover{color:#000}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:1}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:last-child{margin-right:0}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-thumb{background-size:contain;background-repeat:no-repeat;background-position:50%;z-index:1;position:relative;opacity:1;transition:opacity .3s ease-in-out,-webkit-transform .3s ease-in-out;transition:opacity .3s ease-in-out,transform .3s ease-in-out;transition:opacity .3s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out;-webkit-transform:scale(1);transform:scale(1)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label{font-size:15px;font-weight:600;color:inherit;text-decoration:none;margin-top:6px}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label:first-letter{text-transform:uppercase}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label:not(.debug-tagging){display:none}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-thumb-bg-load{position:absolute;top:1px;left:1px;z-index:-1;background-color:#f2f4f5;width:calc(100% - 2px);height:calc(100% - 2px)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item.not-loaded .search-results-grid-item-thumb{opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item.had-load-error{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang{opacity:0;width:100%;height:100%;position:absolute;top:0;left:0;transition:opacity .3s ease-in-out .1s}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang.is-IE,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang.is-IE,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang.is-IE{transition-delay:0s}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background{width:100%;height:100%;background-color:rgba(0,0,0,.7);position:absolute;top:0;left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-main-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-main-cta,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-main-cta{height:30px;width:auto;color:#fff;border:2px solid #fff;font-size:15px;font-weight:700;line-height:25px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);border-radius:15px;padding:0 12px;white-space:nowrap;background-color:rgba(0,0,0,.25);transition:color .2s ease-in-out,background-color .2s ease-in-out;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover{background-color:#fff;color:#35414c}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas{z-index:1;width:100%;position:absolute;top:0;left:0;display:-webkit-flex;display:flex;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-flex-wrap:wrap;flex-wrap:wrap;padding:2px 26px 0 4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta{border-radius:16px;font-size:12px;font-weight:500;color:#35414c;padding:4px 6px;margin:3px;background-repeat:no-repeat;background-size:contain;width:22px;height:22px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail{background-image:url(/images/spectrum-magnify-white.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover{opacity:.85}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags{z-index:1;width:100%;position:absolute;bottom:0;left:0;height:auto;display:none;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-justify-content:flex-start;justify-content:flex-start;padding-bottom:4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging{display:-webkit-flex;display:flex;max-height:100%;overflow:hidden auto}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag{font-size:10px;border-radius:16px;padding:4px 6px;margin:3px;height:20px;background-color:hsla(0,0%,100%,.8)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score{background-color:rgba(126,13,13,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id{background-color:rgba(13,13,126,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size{background-color:rgba(13,126,13,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template .search-results-grid-item-thumb-premium-icon{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon{display:block;z-index:1;top:-1px;width:16px;background-position:top}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.is-premium-template .search-results-grid-item-hover-thang{height:calc(100% + 4px);top:-4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta{outline:3px solid transparent;transition:outline .2s ease-in-out .1s;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta.is-IE,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta.is-IE,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta.is-IE{transition-delay:0s}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon{z-index:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang{border:1px solid #35414c;height:100%;top:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background{background-color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded){outline:2px solid #35414c}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:1}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row.hide-assets .search-results-grid-item:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:0}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row.hide-assets .search-results-grid-item .search-results-grid-item-thumb{opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.search-results-tag-button{font-size:15px;padding:8px 12px;margin:9px 6px 0 0;color:#82919b;border:1px solid #35414c;font-weight:500;cursor:pointer;background-color:#fff;border-radius:18px;font-weight:700;height:30px;line-height:10px;-webkit-flex-shrink:0;flex-shrink:0;box-sizing:border-box;background-color:transparent}.search-results-tag-button.search-add-text-tag{height:28px;padding:6px 10px;border:none;color:#35414c;margin-top:0;margin-bottom:0}.search-results-tag-button.search-add-text-tag:hover{color:#1473e6}.search-results-tag-button.search-add-text-tag.arrow-selected{background-color:#f2f4f5;color:#1473e6}.search-results-tag-button.search-add-text-tag.show-more-tags-btn{text-align:center;color:#82919b;margin:auto}.search-results-tag-button:hover{background-color:rgba(0,0,0,.05)}.search-results-tag-button.selected{border:1px solid transparent;color:#fff;background-color:#35414c}.search-results-tag-button.if-showing-all{display:none}.search-results-tag-button.debug-tagging.search-results-tag-prefix-categories,.search-results-tag-button.debug-tagging.search-results-tag-prefix-explore{color:red}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spcase,.search-results-tag-button.debug-tagging.search-results-tag-prefix-tasks{color:blue}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spterm,.search-results-tag-button.debug-tagging.search-results-tag-prefix-topics{color:orange}.search-results-tag-button.debug-tagging.search-results-tag-prefix-colors,.search-results-tag-button.debug-tagging.search-results-tag-prefix-spcolor{color:#000}.search-results-tag-button.debug-tagging.search-results-tag-prefix-multi{color:green}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spstyle,.search-results-tag-button.debug-tagging.search-results-tag-prefix-styles{color:#fe0}.search-results-tag-button.debug-tagging.selected{background-color:#aaa}.search-view{color:#fff;height:66vh;min-height:400px}.search-view .search-overlay{display:block;position:fixed;left:0;top:0;width:100%;height:100%;opacity:.15;background-color:#0b0f1d;z-index:1}.search-view .search-input,.search-view .search-input-disabled{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.search-view .search-top-container{position:relative;top:0;width:100%;height:inherit;min-height:400px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;-ms-grid-column-align:center;justify-items:center;padding-top:120px}.search-view .search-top-container .search-bar{padding-top:46px;font-size:0;z-index:1;position:relative;max-width:90vw}.search-view .search-top-container .search-bar .search-input-holder{position:relative}.search-view .search-top-container .search-bar .search-input,.search-view .search-top-container .search-bar .search-input-disabled{margin:0 auto;height:40px;width:500px;max-width:90vw;border-radius:4px;font-size:15px;line-height:23px;padding:0 30px 0 40px;text-overflow:ellipsis;color:#35414c;outline:none;caret-color:#1473e6;background-color:#fff;position:relative;font-weight:500;border-radius:24px}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::-webkit-input-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::-webkit-input-placeholder{color:#82919b;font-style:italic}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::-moz-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::-moz-placeholder{color:#82919b;font-style:italic}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled:-ms-input-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input:-ms-input-placeholder{color:#82919b;font-style:italic}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::placeholder{color:#82919b;font-style:italic}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input.search-input-disabled{line-height:40px;text-align:left}.search-view .search-top-container .search-bar .search-input-disabled::-ms-clear,.search-view .search-top-container .search-bar .search-input::-ms-clear{display:none;width:0;height:0}.search-view .search-top-container .search-bar .search-button,.search-view .search-top-container .search-bar .search-clear{position:absolute;height:32px;width:30px;top:4px;background-position:50%;background-repeat:no-repeat;background-color:#fff;z-index:2;cursor:pointer;opacity:.7;transition:opacity .02s ease-in-out}.search-view .search-top-container .search-bar .search-button.search-clear,.search-view .search-top-container .search-bar .search-clear.search-clear{background-image:url(/images/search/search-clear-x-midnight.svg);right:4px;border-top-right-radius:24px;border-bottom-right-radius:24px;background-size:14px}.search-view .search-top-container .search-bar .search-button.search-button,.search-view .search-top-container .search-bar .search-clear.search-button{background-image:url(/images/search/search.svg);left:8px;border-top-left-radius:24px;border-bottom-left-radius:24px;background-size:18px;opacity:.7;transition:opacity .2s ease-in-out}.search-view .search-top-container .search-bar .search-button.search-button:not(.searching).active,.search-view .search-top-container .search-bar .search-button:not(.searching):hover,.search-view .search-top-container .search-bar .search-clear.search-button:not(.searching).active,.search-view .search-top-container .search-bar .search-clear:not(.searching):hover{opacity:1}.search-view .search-top-container .search-bar .search-button:not(.searching):hover.active,.search-view .search-top-container .search-bar .search-clear:not(.searching):hover.active{opacity:.7}.search-view .search-top-container .search-bar .search-button.disabled,.search-view .search-top-container .search-bar .search-clear.disabled{cursor:default;opacity:0}.search-view .search-top-container .search-bar .search-button.disabled:hover,.search-view .search-top-container .search-bar .search-clear.disabled:hover{opacity:0}.search-view.search-view-in-container{height:100%;width:100%}.search-view.search-view-in-container .search-top-container{padding:16px;position:absolute;top:0}.search-view.search-view-in-container .search-top-container .search-bg-underlay{display:none;position:absolute;width:100vw;height:100vh;top:0;right:0;z-index:-1;background-color:rgba(0,0,0,.4)}.search-view.search-view-in-container .search-top-container .search-bg-underlay.showing{display:block}.search-view.search-view-in-container .search-top-container .search-bar{padding-top:0;max-width:500px;width:100%}.search-view.search-view-in-container .search-top-container .search-bar .search-results{width:100%;margin-top:0;box-shadow:0 3px 6px 0 rgba(0,0,0,.16)}.search-view.search-view-in-container .search-top-container .search-bar .search-results .earch-results-pagination{color:#fff}.search-view.search-view-in-container .search-top-container .search-bar .search-input,.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled{width:100%;box-shadow:none}.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled:active,.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled:focus,.search-view.search-view-in-container .search-top-container .search-bar .search-input:active,.search-view.search-view-in-container .search-top-container .search-bar .search-input:focus{box-shadow:0 3px 6px 0 rgba(0,0,0,.16)}.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view.search-view-in-container .search-top-container .search-bar .search-input.search-input-disabled{text-align:left;line-height:40px}.search-view .search-results{position:absolute;display:block;background-color:#fff;max-height:500px;width:500px;max-width:90vw;margin:0 auto;border:1px solid #f2f4f5;border-top:none;color:#35414c;font-size:15px;overflow-y:auto;overflow-y:overlay;font-weight:400;z-index:1;border-radius:16px;top:50px;margin-top:50px}.search-view .search-results ul{margin:14px 0}.search-view .search-results ul div.search-result-group-line,.search-view .search-results ul li{display:block;text-align:left;padding:8px 16px;font-weight:400;font-size:15px;cursor:default}.search-view .search-results ul div.search-result-group-line.if-showing-all:not(.show-more-tags-tags),.search-view .search-results ul div.search-result-group-line.is-more-tags-tag:not(.show-more-tags-tags),.search-view .search-results ul li.if-showing-all:not(.show-more-tags-tags),.search-view .search-results ul li.is-more-tags-tag:not(.show-more-tags-tags){display:none}.search-view .search-results ul div.search-result-group-line.search-result-result-line,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line,.search-view .search-results ul li.search-result-result-line,.search-view .search-results ul li.search-result-search-suggest-line{cursor:pointer;margin-left:8px;margin-right:8px;border-radius:20px}.search-view .search-results ul div.search-result-group-line.search-result-result-line.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line.selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line:hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:hover,.search-view .search-results ul li.search-result-result-line.arrow-selected,.search-view .search-results ul li.search-result-result-line.selected,.search-view .search-results ul li.search-result-result-line:hover,.search-view .search-results ul li.search-result-search-suggest-line.arrow-selected,.search-view .search-results ul li.search-result-search-suggest-line.selected,.search-view .search-results ul li.search-result-search-suggest-line:hover{background-color:#f2f4f5;color:#1473e6}.search-view .search-results ul div.search-result-group-line.search-result-result-line .search-result-line-app-label,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line .search-result-line-app-label,.search-view .search-results ul li.search-result-result-line .search-result-line-app-label,.search-view .search-results ul li.search-result-search-suggest-line .search-result-line-app-label{font-size:13px;text-transform:uppercase;line-height:16px}.search-view .search-results ul div.search-result-group-line.search-result-result-line .search-result-line-popular-translation,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line .search-result-line-popular-translation,.search-view .search-results ul li.search-result-result-line .search-result-line-popular-translation,.search-view .search-results ul li.search-result-search-suggest-line .search-result-line-popular-translation{font-style:italic}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases{color:#1473e6;padding-left:32px}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases:hover{background-color:#f2f4f5;color:#1473e6;cursor:pointer}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.selected{background-color:#f2f4f5;color:#1473e6}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line,.search-view .search-results ul div.search-result-group-line.search-result-group-line,.search-view .search-results ul li.search-result-create-one-line,.search-view .search-results ul li.search-result-group-line{font-size:15px;font-weight:500;color:#82919b;padding-left:24px}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line:not(.search-result-group-line),.search-view .search-results ul div.search-result-group-line.search-result-group-line:not(.search-result-group-line),.search-view .search-results ul li.search-result-create-one-line:not(.search-result-group-line),.search-view .search-results ul li.search-result-group-line:not(.search-result-group-line){display:none}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.search-result-group-line-rule,.search-view .search-results ul div.search-result-group-line.search-result-group-line.search-result-group-line-rule,.search-view .search-results ul li.search-result-create-one-line.search-result-group-line-rule,.search-view .search-results ul li.search-result-group-line.search-result-group-line-rule{padding:0;margin:8px 24px;width:calc(100% - 48px);opacity:.25;border-bottom:1px solid #82919b}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-group-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-group-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul li.search-result-create-one-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul li.search-result-create-one-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul li.search-result-group-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul li.search-result-group-line.show-all .search-results-tag-button.if-showing-all{display:block}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line,.search-view .search-results ul li.search-result-no-results-line{line-height:25px}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line .search-term-link,.search-view .search-results ul li.search-result-no-results-line .search-term-link{font-weight:500;cursor:pointer;opacity:.85}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line .search-term-link:hover,.search-view .search-results ul li.search-result-no-results-line .search-term-link:hover{opacity:1}.search-view .search-results ul div.search-result-group-line span,.search-view .search-results ul li span{font-size:inherit;font-weight:inherit}.search-view .search-results ul div.search-result-group-line span:not(.search-result-result-line-span-count),.search-view .search-results ul li span:not(.search-result-result-line-span-count){color:inherit}.search-view .search-results ul div.search-result-group-line span.search-result-result-line-span-hint,.search-view .search-results ul li span.search-result-result-line-span-hint{font-weight:700}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-search-suggest-line:not(.no-indent),.search-view .search-results ul.show-group-lines li.search-result-search-suggest-line:not(.no-indent){padding-left:24px}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line-tags-label,.search-view .search-results ul.show-group-lines li.search-result-group-line-tags-label{color:#82919b}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line,.search-view .search-results ul.show-group-lines li.search-result-create-one-line,.search-view .search-results ul.show-group-lines li.search-result-group-line{display:block}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all{position:absolute;right:16px;color:#82919b;font-weight:500;font-size:15px;opacity:.5;background-color:transparent}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all.enabled{cursor:pointer;opacity:1}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all.enabled:hover{color:#35414c}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line:first-letter,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line:first-letter,.search-view .search-results ul.show-group-lines li.search-result-create-one-line:first-letter,.search-view .search-results ul.show-group-lines li.search-result-group-line:first-letter{text-transform:uppercase}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines li.search-result-group-line.search-result-group-line-tags .search-result-group-line-tags-tags{margin-top:5px;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag{display:block}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn{display:none}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.search-result-group-line-tag-tag-premium):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.search-result-group-line-tag-tag-premium):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.search-result-group-line-tag-tag-premium):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines li.search-result-group-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.search-result-group-line-tag-tag-premium):not(.show-more-tags-btn){background-color:#f2f4f5;opacity:.5}.search-view .search-results ul.show-group-lines div.search-result-group-line .search-result-line-span-tag,.search-view .search-results ul.show-group-lines li .search-result-line-span-tag{display:inline-block}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-explore,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-explore{color:red}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spcase,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spcase{color:blue}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spterm,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spterm{color:orange}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-color,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-color{color:#000}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-multi,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-multi{color:green}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spstyle,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spstyle{color:#fe0}.search-view .search-overlay.overlay-showing{-webkit-animation-name:fadeTo;animation-name:fadeTo;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}.search-view .search-overlay.overlay-opaque{opacity:1;-webkit-animation-name:none;animation-name:none;background-color:#f2f4f5}.search-view.searching .search-results{-webkit-animation-name:appear;animation-name:appear;-webkit-animation-duration:.2s;animation-duration:.2s;-webkit-animation-timing-function:cubic-bezier(.22,.61,.36,1);animation-timing-function:cubic-bezier(.22,.61,.36,1);border-top:1px solid #dce0e3;z-index:1}.search-view.searching .search-results .search-results-scroller{width:calc(100% - 8px)}.search-view .search-bar.show-search-button .search-input,.search-view .search-bar.show-search-button .search-input-disabled{border-radius:4px 0 0 4px}.search-view .search-bar.show-search-button .search-results{-webkit-transform:translateX(-43px);transform:translateX(-43px)}.search-view.search-view-parent-height-control{height:auto;min-height:0}.search-view.search-view-parent-height-control .search-top-container{min-height:0;padding-top:0}.search-view.search-view-bar-only{min-height:66px;height:66px;padding:16px}.search-view.search-view-bar-only .search-top-container{min-height:66px}.search-view.search-view-bar-only .search-bar{width:100%;padding-top:0}.search-view.search-view-bar-only .search-welcome-text{display:none}.search-view.in-main-search-header{position:relative}.search-view.in-vb-search-header{padding-top:0;padding-bottom:120px;width:auto}.search-view.in-vb-search-header .search-top-container{padding-top:0}.search-view.in-vb-search-header.search-view-bar-only{padding-top:50px;padding-bottom:100px}.search-view.in-vb-search-header.search-view-fixed{position:fixed;top:0;left:50vw;-webkit-transform:translateX(-50%);transform:translateX(-50%);padding:13px 0 0;z-index:2;width:500px;max-width:90vw}@media (max-width:950px){.search-view.in-vb-search-header.search-view-fixed{top:50px}}.search-view.in-vb-search-header.search-view-fixed .search-overlay{width:200vw;height:200vh;top:-100px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-overlay{background-color:#0b0f1d}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-overlay.overlay-opaque{background-color:#f2f4f5}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input-disabled{box-shadow:none;border:1px solid #82919b}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input-disabled:focus,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input:focus{background-color:#fff}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-input,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-input-disabled{border:1px solid #dce0e3;background-color:#fff}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-button,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-clear{background-color:#fff}.search-in-main-header,.vb-search-header{height:66px}.search-in-main-header.vb-search-header,.vb-search-header.vb-search-header{position:fixed;top:0;left:0;width:100%;z-index:2000}.search-in-main-header .vb-search-header-background,.vb-search-header .vb-search-header-background{position:absolute;height:100%;width:100%;top:0;left:0;background-color:#fff;opacity:1;z-index:-1}.search-in-main-header .search-view .search-top-container,.vb-search-header .search-view .search-top-container{min-height:40px;height:40px}.search-in-main-header .search-view .search-top-container .search-bar .search-results,.vb-search-header .search-view .search-top-container .search-bar .search-results{width:100%;max-height:calc(100vh - 100px);overflow-y:auto;margin-top:0}.search-in-main-header .search-view .search-top-container .search-bar .search-input,.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled,.vb-search-header .search-view .search-top-container .search-bar .search-input,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled{height:40px;width:100%;opacity:1;background-position:left 12px center;background-size:18px;border-radius:20px}.search-in-main-header .search-view .search-top-container .search-bar .search-button,.search-in-main-header .search-view .search-top-container .search-bar .search-clear,.vb-search-header .search-view .search-top-container .search-bar .search-button,.vb-search-header .search-view .search-top-container .search-bar .search-clear{height:32px}.search-in-main-header .npw-visual-browse-header-back-arrow,.vb-search-header .npw-visual-browse-header-back-arrow{height:100%;width:50px;background-color:transparent;background-position:0;background-image:url(/images/spectrum-back-arrow-valley.svg);background-repeat:no-repeat;background-size:18px;margin-left:34px;cursor:pointer}.search-in-main-header .npw-visual-browse-header-back-arrow:hover,.vb-search-header .npw-visual-browse-header-back-arrow:hover{background-image:url(/images/spectrum-back-arrow-midnight.svg)}.search-in-main-header .npw-visual-browse-header-back-arrow.has-text,.vb-search-header .npw-visual-browse-header-back-arrow.has-text{padding-left:30px;line-height:66px;text-transform:uppercase;width:auto;outline:none;font-weight:700;font-size:12px;color:#82919b;transition:color .2s ease-in-out}.search-in-main-header .npw-visual-browse-header-back-arrow.has-text:hover,.vb-search-header .npw-visual-browse-header-back-arrow.has-text:hover{color:#35414c}.search-in-main-header .npw-visual-browser-header-favorites,.vb-search-header .npw-visual-browser-header-favorites{text-transform:uppercase;cursor:pointer;color:#35414c;font-size:14px;font-weight:700;height:32px;line-height:30px;border:1px solid #fff;border-radius:20px;padding:0 8px 0 26px;background-position:4px;background-repeat:no-repeat;background-image:url(/images/npw/visualBrowse/icon-heart-empty-with-background.svg);opacity:1;transition:opacity .1s ease-in-out,background-color .1s ease-in-out;position:absolute;right:280px;top:18px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown,.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer{position:absolute;min-width:160px;height:40px;line-height:23px;top:13px;right:36px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown-v-spacer,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown-v-spacer{height:0;top:55px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown{opacity:1}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider{background-color:transparent}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay{height:100vh}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover{-webkit-transform:translate(-40px,6px);transform:translate(-40px,6px)}.search-in-main-header.white,.vb-search-header.white{background-color:#fff}.search-in-main-header.short-header .in-vb-search-header,.search-in-main-header.short-header .npw-visual-browse-header-back-arrow,.search-in-main-header.short-header .npw-visual-browse-header-create-new-dropdown,.search-in-main-header.short-header .search-input,.vb-search-header.short-header .in-vb-search-header,.vb-search-header.short-header .npw-visual-browse-header-back-arrow,.vb-search-header.short-header .npw-visual-browse-header-create-new-dropdown,.vb-search-header.short-header .search-input{display:none}.search-in-main-header.short-header .grid-detail-header-back-arrow,.vb-search-header.short-header .grid-detail-header-back-arrow{display:block}.search-in-main-header.short-header .vb-search-header-short-v-filler,.vb-search-header.short-header .vb-search-header-short-v-filler{height:66px}.search-in-main-header.search-in-main-header,.vb-search-header.search-in-main-header{position:absolute;height:66px;top:0;z-index:104}.search-in-main-header.search-in-main-header .vb-search-header-background,.vb-search-header.search-in-main-header .vb-search-header-background{background-color:transparent}.search-in-main-header.search-in-main-header:not(.showing-results-grid),.vb-search-header.search-in-main-header:not(.showing-results-grid){width:500px;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:calc(50% + 8px)}.search-in-main-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-back-arrow,.search-in-main-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-create-new-dropdown,.vb-search-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-back-arrow,.vb-search-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-create-new-dropdown{display:none}.search-in-main-header.search-in-main-header.showing-results-grid,.vb-search-header.search-in-main-header.showing-results-grid{background-color:#fff;width:100vw}.search-in-main-header.search-in-main-header.showing-results-grid .search-view,.vb-search-header.search-in-main-header.showing-results-grid .search-view{top:-66px;width:500px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-in-main-header.search-in-main-header .search-overlay,.vb-search-header.search-in-main-header .search-overlay{width:calc(100vw + 30px);height:100vh;left:50%;position:absolute;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-in-main-header.search-in-main-header .search-results,.vb-search-header.search-in-main-header .search-results{top:50px}.search-in-main-header.search-in-main-header .search-view,.vb-search-header.search-in-main-header .search-view{padding:13px}.search-in-main-header.search-in-main-header .search-view .search-input,.search-in-main-header.search-in-main-header .search-view .search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input,.vb-search-header.search-in-main-header .search-view .search-input-disabled{width:100%;box-shadow:none;border:1px solid #dce0e3}.search-in-main-header.search-in-main-header .search-view .search-input-disabled:active,.search-in-main-header.search-in-main-header .search-view .search-input-disabled:focus,.search-in-main-header.search-in-main-header .search-view .search-input:active,.search-in-main-header.search-in-main-header .search-view .search-input:focus,.vb-search-header.search-in-main-header .search-view .search-input-disabled:active,.vb-search-header.search-in-main-header .search-view .search-input-disabled:focus,.vb-search-header.search-in-main-header .search-view .search-input:active,.vb-search-header.search-in-main-header .search-view .search-input:focus{box-shadow:0 3px 6px 0 rgba(0,0,0,.16);border-color:transparent}.search-in-main-header.search-in-main-header .search-view .search-input-disabled.search-input-disabled,.search-in-main-header.search-in-main-header .search-view .search-input.search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input-disabled.search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input.search-input-disabled{text-align:left;line-height:40px}.vb-search-header-filters-background{width:100%;background-color:#fff;position:relative;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;padding:8px 0 0}.vb-search-header-filters-background.filters-if-npw{display:none;position:absolute;top:66px}.vb-search-header-filters-background .vb-search-header-formats{display:-webkit-flex;display:flex;position:relative;max-width:90vw;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-justify-content:center;justify-content:center}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep{font-size:12px;font-weight:700;color:#82919b;margin:0;padding:12px;text-transform:uppercase;cursor:pointer;border-bottom:3px solid transparent}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep.selected,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format.selected{color:#1473e6;border-bottom-color:#1473e6}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep:hover,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format:hover{color:#1473e6}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep:first-child,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format:first-child{margin-left:0}.vb-search-header-filters-background.filters-if-npw .vb-search-header-formats .vb-search-header-formats-format{font-size:14px;padding:12px 16px 12px 4px}.vb-search-header-filters-background.filters-if-npw .vb-search-header-formats .vb-search-header-formats-format.selected{border-bottom-color:transparent}@media (max-width:950px){.vb-search-header-filters-background.in-header{height:84px}.vb-search-header-filters-background.in-header .vb-search-header-formats{top:36px;height:40px}}.vb-search-header-filters-background.in-header .vb-search-header-formats{margin-top:0}.vb-search-header-filters-background.in-header.hide-formats{height:47px}.vb-search-header-filters-background.in-header.hide-formats .vb-search-header-formats{display:none}.vb-search-header-filters-background:not(.in-header){border-radius:6px;margin-top:14px;display:inline-block;width:auto;padding:4px 16px 0}@-webkit-keyframes auto-load-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes auto-load-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.search-view-common .load-more-toggle{display:block;clear:both;padding:0 18px;height:40px;margin:40px auto;cursor:pointer;text-align:center;font-size:1.3em;font-weight:600;text-decoration:none;line-height:36px;color:#35414c;background:transparent;border-radius:40px;border:2px solid #35414c;opacity:1;transition:opacity .3s ease-out}.search-view-common .load-more-toggle:not(.spinner):hover{background:#35414c;color:#fff}.search-view-common .load-more-toggle:not(.spinner).melting{opacity:0;transition:opacity .3s ease-out}.search-view-common .load-more-toggle:not(.spinner).disabled{cursor:default;border:2px solid #dce0e3;color:#dce0e3;background-color:transparent}.search-view-common .load-more-toggle.spinner{color:transparent;border-color:transparent;background-color:transparent;cursor:default;width:40px;height:40px;outline:none}.search-view-common .load-more-toggle.spinner.spinner-loading{background-repeat:no-repeat;background-position:50%;background-size:40px;background-image:url(/marvel-core/images/common/light-spinner.svg);transition:opacity;transition-duration:.75s;-webkit-animation-name:auto-load-spinner-rotate;animation-name:auto-load-spinner-rotate;-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear}.search-view-common .load-more-toggle.spinner.no-more{cursor:default}.search-view .search-top-container.filters-in-search-top-container .search-bar{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}.search-view .search-top-container.filters-in-search-top-container .search-bar .search-input-holder{width:500px;max-width:90vw}.search-results-grid-item-detail-confirm-overlay{width:100vw;height:100vh;position:absolute;top:0;left:0;background-color:rgba(0,0,0,.6);z-index:2002}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-button{cursor:pointer;z-index:2}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right{width:40%;min-width:350px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:340px;-webkit-justify-content:space-around;justify-content:space-around;padding:0 40px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-message-and-ctas{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:330px;-webkit-justify-content:space-around;justify-content:space-around}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-premium-blurbs{height:30%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb{display:block;color:#82919b;font-size:14px;font-weight:400;height:18px;padding-left:32px;background-position:0;background-repeat:no-repeat;background-size:contain}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template{height:20px;line-height:20px;padding-left:22px;background-image:url(/images/icon-premium-gold-no-border.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb-fonts{background-image:url(/images/npw/visualBrowse/premium-blurb-fonts.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-title{font-size:26px;font-weight:900}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-subtitle{font-size:16px;font-weight:400;line-height:23px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;width:100%;max-width:300px;-webkit-justify-content:flex-start;justify-content:flex-start}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta{display:block;cursor:pointer;height:34px;font-weight:700;font-size:16px;z-index:1;padding:16px;line-height:0;color:#fff;background-color:#1473e6;border-radius:20px;transition:width .3s,background-color .3s,top .2s,opacity .3s ease-in-out .2s;opacity:1}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta:hover{background-color:#1269d0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta:active{background-color:#1056a7}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail{padding:0;height:60vh;width:75vw;max-width:1024px;max-height:800px;min-height:450px;min-width:800px;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background-color:#fff;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;align-items:center;border-radius:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default{-webkit-flex-direction:column;flex-direction:column;height:calc(100vh - 100px);width:auto}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-image-section{width:100%;height:100%;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-left-radius:0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right{height:25%;min-height:140px;max-height:200px;width:100%;padding:20px 40px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-premium-blurbs{height:30px;width:auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-message-and-ctas{height:120px;-webkit-align-items:center;align-items:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas{-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas:after,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas:before{content:"";display:block}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.has-premium-ingredient-fonts) .show-if-premium-ingredient-fonts,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.is-premium-template) .hide-if-not-premium{display:none}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .detail-close-button{position:absolute;height:24px;width:24px;top:16px;right:16px;background-color:transparent;background-image:url(/images/search/search-clear-x-midnight.svg);background-size:20px;background-repeat:no-repeat}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section{width:60%;height:100%;min-height:160px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;background-color:#f2f4f5;border-top-left-radius:10px;border-bottom-left-radius:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section.show-preview-nav-side{-webkit-flex-direction:row;flex-direction:row}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-preview-nav{display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;height:32px;margin-top:16px;width:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{position:relative;width:100%;max-width:100%;height:100%;background-color:#f2f4f5;padding:32px 0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{margin:8px 0 0;height:40px;-webkit-justify-content:left;justify-content:left;overflow-x:auto;overflow-y:hidden;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder{height:100%;width:auto;position:relative;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading{position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;width:100%;height:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-image{z-index:1}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-nav{width:32px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav{position:relative;top:0;background-repeat:no-repeat;width:32px;height:100%;z-index:1;pointer-events:none;opacity:0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav .search-results-grid-item-detail-nav-icon{background-size:24px;background-repeat:no-repeat;height:100%;width:32px;position:absolute;pointer-events:auto}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left{margin-right:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon{right:0;background-position:100%;background-image:url(/images/npw/visualBrowse/caret-left-valley.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left:hover .search-results-grid-item-detail-nav-icon{background-image:url(/images/npw/visualBrowse/caret-left-dark-midnight.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right{margin-left:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon{left:0;background-position:0;background-image:url(/images/npw/visualBrowse/caret-right-valley.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right:hover .search-results-grid-item-detail-nav-icon{background-image:url(/images/npw/visualBrowse/caret-right-dark-midnight.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.can-nav .search-results-grid-item-detail-nav{opacity:1}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox,.search-results-tags-container .spectrum-Checkbox{display:-webkit-inline-flex;display:inline-flex;-webkit-align-items:center;align-items:center;position:relative;height:32px;max-width:100%;margin-right:16px;vertical-align:top}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox:hover .spectrum-Checkbox-box-border,.search-results-tags-container .spectrum-Checkbox:hover .spectrum-Checkbox-box-border{border-color:#6e6e6e}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox:hover .spectrum-Checkbox-label,.search-results-tags-container .spectrum-Checkbox:hover .spectrum-Checkbox-label{color:#2c2c2c}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-input{font-family:inherit;font-size:100%;line-height:1.15;margin:0;overflow:visible;box-sizing:border-box;padding:0;position:absolute;top:0;left:-8px;width:calc(100% + 16px);height:100%;opacity:.0001;z-index:1;cursor:pointer}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:disabled,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-input:disabled{cursor:default}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-check,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-check{opacity:1}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-border,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-border{border-width:7px;border-color:#1473e6}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-border,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-box-border{border:2px solid #8e8e8e;position:absolute;width:14px;height:14px;border-radius:2px;transition:border .13s ease-in-out,box-shadow .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-check,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-box-check{background-image:url(/images/npw/visualBrowse/spectrum-checkbox-check.svg);background-size:28px;width:14px;height:14px;position:absolute;left:1px;top:1px;display:block;opacity:0;transition:opacity .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-label,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-label{margin-left:10px;font-size:14px;font-weight:400;transition:color .13s ease-in-out;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#4b4b4b}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-holder,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-box-holder{position:relative;box-sizing:border-box;width:14px;height:14px;-webkit-flex-grow:0;flex-grow:0;-webkit-flex-shrink:0;flex-shrink:0}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-checkmark,.search-results-tags-container .spectrum-Checkbox .spectrum-Checkbox-checkmark{position:absolute;top:50%;left:50%;margin-top:-5px;margin-left:-5px;opacity:0;-webkit-transform:scale(0);transform:scale(0);transition:opacity .13s ease-in-out,-webkit-transform .13s ease-in-out;transition:opacity .13s ease-in-out,transform .13s ease-in-out;transition:opacity .13s ease-in-out,transform .13s ease-in-out,-webkit-transform .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay.search-results-tags-container .spectrum-Checkbox-box-check,.search-results-tags-container.search-results-tags-container .spectrum-Checkbox-box-check{left:8px}.search-results-grid-item-detail-confirm-overlay.search-results-tags-container .spectrum-Checkbox-label,.search-results-tags-container.search-results-tags-container .spectrum-Checkbox-label{margin-top:0}.main-header-search-results.search-results-grid-view-holder{position:absolute;height:calc(100vh - 66px);width:100vw;left:0;top:66px}.search-input-tooltip{position:relative;display:inline-block;color:#fff;background:#1473e6 0 0 no-repeat padding-box;border-radius:4px;opacity:1;pointer-events:none;font-size:14px;font-weight:500;padding:10px 20px;text-align:center;top:-1px;transition:top .25s ease-in,opacity .5s ease-in}.search-input-tooltip:after{position:absolute;bottom:100%;left:50%;margin-left:-5px;width:0;border-top:5px solid transparent;border-bottom:5px solid #1473e6;border-right:5px solid transparent;border-left:5px solid transparent;content:" ";font-size:0;line-height:0}.search-input-tooltip-holder{text-align:center;height:auto}.search-input-tooltip-holder.off{opacity:0;height:0}.search-input-tooltip-holder.off .search-input-tooltip{top:10px}',""])},3051:function(e,s,t){var r,i;r=[t(1),t(0),t(2),t(3),t(1873),t(42),t(7),t(22),t(883),t(8),t(20),t(225),t(3052),t(3053),t(3054),t(3055),t(3056),t(2072)],void 0===(i=function(e,s,t,r,i,a,l,o,n,h,c,d,u,g,p,m,v,f){"use strict";return t.View.extend({events:{"click .search-results-tag":"handleTagClick","click .search-results-tag-button":"handleTagClick","click .search-results-grid-item-hover-id":"handleDebugIdClick","click .search-results-pagination-more":"handleLoadMoreClick","click .search-results-grid-item":"handleItemClick","click .search-results-grid-main-cta":"handleItemMainCtaClick","click .search-results-grid-item-thumb-favorite-icon":"handleFavoriteIconClick","click .search-results-grid-item-hover-cta":"handleItemCtaClick","click .search-results-grid-item-detail-nav":"handleDetailNavClick","click .search-results-grid-item-detail-other-results-item-thumb":"handleDetailResultNavClick","click .search-results-grid-item-detail-cta":"handleDetailCtaClick","click .social-line":"handleShareTemplateCtaClick","click .social-overlay-bg":"handleShareModalCloseClick","click .js-close-modal":"handleShareModalCloseClick","click .grid-detail-header-back-arrow":"handleDetailBackArrowClick"},initialize:function(e){s.bindAll(this,s.functionsIn(this)),(e=e||{}).resultsData&&this.setResultsData(e.resultsData),this.parentRerendersOnResize=e.parentRerendersOnResize,this._debouncedBound||(this._debouncedBound=!0,this._debouncedVerticalScroll=s.debounce(this.handleScroll.bind(this),500),this.parentRerendersOnResize||(this._debouncedResize=s.debounce(this.handleResize.bind(this),500)))},applyNewInitOptions:function(t){this.setElement(t.el),t.parentRerendersOnResize!==this.parentRerendersOnResize&&(this.parentRerendersOnResize=t.parentRerendersOnResize,this.parentRerendersOnResize?(this._debouncedResize.cancel(),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize))):this._debouncedResize=s.debounce(this.handleResize.bind(this),500))},_partialRowClass:"partial-row",_getRowWidth:function(e){var t=0;return s.each(e.assets,(function(e){t+=e.widthInGrid})),t+=this.gridDims.borderSpace*(e.assets.length-1)},_reduceHeight:function(e,t){var r=this.gridDims.borderSpace*(e.assets.length-1),i=0;return t=t||1,s.each(e.assets,(function(e){e.heightInGrid-=t,i=Math.max(i,e.heightInGrid),e.widthInGrid=Math.floor(e.width*e.heightInGrid/e.height),r+=e.widthInGrid})),e.heightInGrid=i,r},_rerenderGridAfterResize:function(){this._render({isResize:!0})},_getViewportWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width},_getViewportHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height},_imagePreloads:{},_setBackgroundUrl:function(e,s){e.css("background-image","url("+s+")")},_couldNotLoadBackgroundFromLoad:function(e){var s=this.resultsGrid$.find("#"+e.thumbId);if(e.hadLoadError=!0,this.gridOptions.assetLoadFailed(e),this.pagination.lastShowing--,this.pagination.total--,this._updatePaginationDisplay(),s.length){var t=s.parents(".search-results-grid-item");t.parent(".search-results-grid-row").addClass(this._partialRowClass),t.addClass("had-load-error"),this.gridOptions.detailViewEnabled&&this.detailView$.find("#"+e.thumbId).parents(".search-results-grid-item-detail-other-results-item").addClass("had-load-error")}},_setBackgroundFromLoad:function(e){var s="url("+e.renditions[this._currentPreload.fieldId]+")",t=this.resultsGrid$.find("#"+e.thumbId);if(t.length){this.gridOptions.detailViewEnabled&&this.detailView$.find("#"+e.thumbId).css("background-image",s);var r=t.parents(".search-results-grid-item");t.css("background-image",s),r.removeClass("not-loaded")}},_preloadNextAsset:function(){if(this._currentPreload&&this._currentPreload.nextIndex<this._currentPreload.assetsToPreload.length){var e=this._currentPreload,t=this._currentPreload.assetsToPreload[this._currentPreload.nextIndex],r=t.renditions[this._currentPreload.fieldId],i=this._currentPreload.nextIndex;this._currentPreload.nextIndex++;var a=this._currentPreload.nextIndex==this._currentPreload.assetsToPreload.length;this._currentPreload.currentAsset=t;var l=new Image;l.onload=function(s){if(e===this._currentPreload&&(t.hideUntilLoaded=!1,this._currentPreload.loadedByIndex[i]=t,this._lastGridData.successfulPreloads[t.id]=!0,i==this._currentPreload.nextLoadedIndex&&(this._currentPreload.nextLoadedIndex++,this._lastGridData.hideAssetsUntilLoaded))){this._setBackgroundFromLoad(t);for(var r=this._currentPreload.nextLoadedIndex;r<this._currentPreload.assetsToPreload.length;r++){var a=this._currentPreload.loadedByIndex[r];if(!a)break;this._currentPreload.nextLoadedIndex=r+1,a.hadLoadError||this._setBackgroundFromLoad(a)}}}.bind(this),l.onerror=function(s){if(e===this._currentPreload&&(window.marvel.logger.warn("error loading image in template search results",l.src),this._currentPreload.loadedByIndex[i]=t,this._couldNotLoadBackgroundFromLoad(t),i==this._currentPreload.nextLoadedIndex&&(this._currentPreload.nextLoadedIndex++,this._lastGridData.hideAssetsUntilLoaded)))for(var r=this._currentPreload.nextLoadedIndex;r<this._currentPreload.assetsToPreload.length;r++){var a=this._currentPreload.loadedByIndex[r];if(!a)break;this._currentPreload.nextLoadedIndex=r+1,this._setBackgroundFromLoad(a)}}.bind(this),l.src=r,a||s.defer(this._preloadNextAsset.bind(this))}},_setupAssetRenditionsLoader:function(e){e.assetsToPreload.length?this._currentPreload={assetsToPreload:e.assetsToPreload,nextIndex:0,nextLoadedIndex:0,fieldId:this.isRetina()?"rendition2x":"rendition",loadedByIndex:[]}:this._currentPreload=null},_generateGrid:function(e){var t=(e=e||{}).containerDims;t||(t={height:this.$el.height(),width:this.$el.width()},this.$el.hasClass("hide")&&(this.$el.removeClass("hide"),t.width=this.$el.width(),t.height=this.$el.height(),this.$el.addClass("hide")),t.height<=0&&(t.height=this._getViewportHeight()-122),t.width<=0&&(t.width=this._getViewportWidth()));var r=t.width-2*this.gridDims.rowHMargin,i=this.gridDims.minHeight,a=this.gridDims.minPerRowForMinHeight||2,l=this.gridDims.maxWidth?Math.min(r,this.gridDims.maxWidth):r,o=Math.floor(this.gridDims.targetNumRows)-1,n=t.height-o*this.gridDims.rowVSpace,h=this.gridDims.targetNumRows?Math.round(n/this.gridDims.targetNumRows):this.gridDims.maxHeight,c=this.gridOptions.hideAssetUntilLoaded;c&&e.preLoadMoreGridData&&e.preLoadMoreGridData.stylesData.length;this._partialRowClass=t.width<=300?"partial-row-narrow":"partial-row",h<this.gridDims.minHeight?h=this.gridDims.minHeight:h>this.gridDims.maxHeight&&(h=this.gridDims.maxHeight);var d=[],u={assets:[],width:0};d.push(u),s.each(this.assets,function(e){var t=e.width,r=e.height;if(e.heightInGrid=h,e.widthInGrid=t*e.heightInGrid/r,e.heightInGrid=parseInt(e.heightInGrid),e.widthInGrid=parseInt(e.widthInGrid),e.originalHeightInGrid=e.heightInGrid,e.originalWidthInGrid=e.widthInGrid,u.assets.push(e),u.width+=e.widthInGrid,u.width>=l){var o=null;if(u.assets.length>a){for(var n=this._getRowWidth(u),c=!1;n>l;)if(n=this._reduceHeight(u),u.heightInGrid<=i){n>l&&(c=!0);break}s.each(u.assets,(function(e){e.widthInGrid=e.originalWidthInGrid,e.heightInGrid=e.originalHeightInGrid})),c&&(o=u.assets.pop())}u={assets:[],width:0},o&&(u.assets.push(o),u.width+=o.widthInGrid),d.push(u)}}.bind(this)),0===d[d.length-1].length&&d.pop();var g=[],p=[],m=[],v=1e6,f=(this.gridDims.detailResultsThumbHeight,this.gridDims.detailResaultsMinThumbHeight||0),w={},b=[];s.each(d,function(t){for(var r=this._getRowWidth(t),i={assets:[]};r>l;)r=this._reduceHeight(t);i.partialRow=l-r>this.gridDims.borderSpace&&this._partialRowClass;var a=t.assets.length-1;s.each(t.assets,function(t,r){var l=t.usecases&&t.usecases[0]||t.app,o=t.favoriteData&&t.favoriteData.favDate>0,n="thumb_"+t.id,h=c,d=t.templatedImgHref,u={rendition:this._getRenditionUrl(d,t.heightInGrid),rendition2x:this._getRenditionUrl(d,2*t.heightInGrid)};e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads[t.id]&&(h=!1),v=Math.min(v,t.heightInGrid);var g={id:n,w:t.widthInGrid+"px",h:t.heightInGrid+"px"};h?g.hideAssetUntilLoaded=!0:s.assign(g,u),p.push(g);var f={id:t.id,ctaItemId:t.id,thumbId:n,title:t.title,type:t.app,bgLoadWidth:t.widthInGrid-3+"px",bgLoadHeight:t.heightInGrid-3+"px",assetW:t.width,assetH:t.height,assetAspectRatio:t.width/t.height,label:l,isFavorite:o,tagsForData:t.tagsForData,allTags:t.allTags,score:t._score,hideUntilLoaded:h,isPremiumTemplate:t.isPremiumTemplate,marginRight:r!==a&&this.gridDims.borderSpace+"px"||0};h&&(f.renditions=u,b.push(f)),w[n]=f,i.assets.push(f),m.push(f)}.bind(this)),g.push(i)}.bind(this));var _=t.height,x=Math.floor(.25*_)-40,y=this.detailResultHSpace*(m.length-2);s.each(m,(function(e){e.detailResultWidth=e.assetW*x/e.assetH,y+=e.detailResultWidth})),s.each(m,(function(e){e.detailResultWidth=100*e.detailResultWidth/y+"%",e.detailResultHeight="100%"})),c&&this._setupAssetRenditionsLoader({assetsToPreload:b});var S=t.width<=300?"optimizedMore":t.width<=400&&"optimized",k=e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads||{};return{hideAssetsUntilLoaded:c,delayAllAssets:!c,rowsData:g,stylesData:p,successfulPreloads:k,maxRowWidth:l+"px",rowVSpace:this.gridDims.rowVSpace,containerDims:t,narrowTagsArea:S,detailData:this.gridOptions.detailViewEnabled&&{detailAssetsData:{assets:m,maxH:x+"px",totalWidth:y+"px",thumbHeight:"100%",maxTotalWidth:y+"px",minThumbHeight:f&&f+"px",minTotalWidth:f&&y*f/v+"px"},detailBackArrowText:this.gridOptions.backArrowTextForDetail}}},scrollToPreLoadMoreTop:function(){this.verticalScroller$.scrollTop(this._preLoadMoreScrollTop)},scrollToGridRow:function(s){s>=this.rows$.length&&(s=this.rows$.length-1);var t=e(this.rows$[s]),r=e(this.rows$[0]),i=t.position(),a=r.position(),l=i&&a&&i.top-a.top||0;this._verticalScrollRegistered&&(this._ignoreNextVerticalScroll=!0),this.verticalScroller$.scrollTop(l)},_getRenditionUrl:function(e,s,t){return t=t||"height",e.replace("{format}","jpg").replace("{dimension}",t).replace("{size}",s)},setResultsData:function(e,t){this.assets=e.assets,this.assetsById=e.assetsById,this.tagsData=e.tagsData,this.tagsData.tags||(this.tagsData.tags=s.reduce(this.tagsData.tagsInOrder,(function(e,s){return e[s.id]=s,e}),{})),this._setAtMaxSelectedTagsForTagsData(this.tagsData,t),this.pagination={total:e.hasMore&&e.total||this.assets.length,firstShowing:1,lastShowing:this.assets.length,hasMore:e.hasMore}},_addPaginationToTemplateOptions:function(e){return e.paginationTotal=this.pagination.total,e.paginationFirst=this.pagination.firstShowing,e.paginationLast=this.pagination.lastShowing,e},_updatePaginationDisplay:function(){var e=this.$el.find(".search-results-pagination-pages-info"),s=this._addPaginationToTemplateOptions({}),t=this.pagination.total?"npw-vb-search-results-pagination-some":"npw-vb-search-results-pagination-none",r=h.formatMessage(t,s);e.text(r)},renderResults:function(e,s){this.gridOptions=s,this.gridDims=this.gridOptions.gridDims,this.setResultsData(e,s),this.render(s)},_extendDebugSettingsToTemplateSettings:function(e){return this.gridOptions.debugSettings&&(e.debugCssStr=this.gridOptions.debugSettings.debugCssStr),e},_recordExperiment:function(){return this._recordExperimentDefer||(this._recordExperimentDefer=r.defer(),a.run("npwSearchResults*").then(function(e){this._recordExperimentDefer.resolve(e)}.bind(this)).catch(function(e){window.marvel.logger.error("Error loading experiment in npw search results: ",e),this._recordExperimentDefer.resolve(null)}.bind(this)).done()),this._recordExperimentDefer.promise},render:function(e){return e.isReRender?this._render(e):this._recordExperiment().then(function(){this._render(e)}.bind(this)).done(),this},_isEdge:function(){return-1!==window.navigator.userAgent.indexOf("Edge/")},_isIE:function(){var e=window.navigator.userAgent;return-1!==e.indexOf("Trident/")||-1!==e.indexOf("MSIE ")},_setAtMaxSelectedTagsForTagsData:function(e,t){var r=!1;if(t.maxNumSelectedTags&&e.currentSelectedTags&&e.currentSelectedTags.length){var i=0;s.find(e.currentSelectedTags,(function(e){if(!e.selected)return!0;e.isPremium||i++})),r=i>=this.gridOptions.maxNumSelectedTags}e.atMaxSelectedTags=r},_render:function(t){t=t||{},this._verticalScrollRegistered&&(this.verticalScroller$.off("scroll.searchresultsgridview",this._debouncedVerticalScroll),this._verticalScrollRegistered=!1),this._resizeRegistered||this.parentRerendersOnResize||(this._resizeRegistered=!0,e(window).on("resize.srgv",this._debouncedResize));var r=0;this.gridOptions.repeatOptions&&this.gridOptions.repeatOptions.loadNext&&(r=this.rows$&&this.rows$.length),this.detailResultMaxHeight=this.gridDims.maxHeight,this.detailResultHSpace=8,this._showingDetail=!1;var i={numCtas:0,ctas:[]},a=this._parseTags(this.gridOptions.debugSettings),l=this._generateGrid({preLoadMoreGridData:this._preLoadMoreGridData,containerDims:t.containerDims}),o=this.tagsData.atMaxSelectedTags,n=t.uiStrings||{};n.resultItemCreateFrom||(n.resultItemCreateFrom=h.getString("npw-vb-search-results-item-create-from"));var g={rows:l.rowsData,maxRowWidth:l.maxRowWidth,narrowTagsArea:l.narrowTagsArea,rowVSpace:l.rowVSpace,hoverCtas:i,detailData:l.detailData,tagsAboveResults:this._tagsAboveResultsEnabled(),tags:a,pagination:this.pagination,favoritesEnabled:this.gridOptions.favoritesEnabled,assetsStyles:c.to_html(d,{assets:l.stylesData}),isEdge:this._isEdge(),isIE:this._isIE(),uiStrings:n,implicitCreateCta:this.gridOptions.implicitCreateCta,delayAllAssets:l.delayAllAssets,atMaxSelectedTags:o};this._addPaginationToTemplateOptions(g),this._lastGridData=l,this._preLoadMoreGridData=null,g.detailData&&i.ctas.push({id:"detail"}),i.numCtas=i.ctas.length,this._extendDebugSettingsToTemplateSettings(g);var p,v=h.mustacheRender(m,g,{itemDetail:l.detailData&&u});return this.$el.html(v),this._applySelectedTagsToResultsAfterRender(),l.hideAssetsUntilLoaded&&this._preloadNextAsset(),this.verticalScroller$=this.$el.find(".search-results-grid-holder"),this.resultsGrid$=this.$el.find(".search-results-grid"),this.rows$=this.verticalScroller$.find(".search-results-grid-row"),this.detailView$=this.$el.find(".search-results-grid-item-detail-holder"),this.detailImage$=this.detailView$.find(".search-results-grid-item-detail-image"),this.detailThumbsRowScroller$=this.detailView$.find(".search-results-grid-item-detail-other-results-section-scroller"),this.detailRightSide$=this.detailView$.find(".search-results-grid-item-detail-right"),this.gridOptions.rightRailForDetail?this.detailView$.addClass("show-right-rail"):this.detailView$.removeClass("show-right-rail"),t.jumpToDetailAssetId&&this.jumpToDetailAsset(t.jumpToDetailAssetId),this.$el.removeClass("hide"),this._setupVisibleTags(),this.pagination.div$=this.$el.find(".search-results-pagination").removeClass("loading-more"),this.pagination.moreBtn$=this.pagination.div$.find(".load-more-toggle"),p=this.pagination.hasMore?this.gridOptions.showLoadMoreButton?this.pagination.lastShowing>t.maxResultsBeforeAutoLoadFromScroll?"spinner-loaded":"load-more":"spinner-loaded":"no-more",this._setMoreBtnState(p),"spinner-loaded"===p?(this._verticalScrollRegistered=!0,r&&!t.isReRender&&this.scrollToPreLoadMoreTop(),this.verticalScroller$.on("scroll.searchresultsgridview",this._debouncedVerticalScroll)):"no-more"===p&&r&&this.scrollToPreLoadMoreTop(),l.delayAllAssets&&s.delay(function(){this.rows$.removeClass("hide-assets")}.bind(this),5),this},hide:function(){this.$el.addClass("hide"),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize))},handleLoadMoreClick:function(e){if(!this.pagination.moreBtn$.hasClass("no-more")){this.pagination.div$.addClass("loading-more"),this._setMoreBtnState("spinner-loading"),this._preLoadMoreScrollTop=this.verticalScroller$.scrollTop(),this._preLoadMoreGridData=this._lastGridData;var t=s.map(this.tagsData.currentSelectedTags,(function(e){return e.id}));this.gridOptions.loadMoreClickHandler({isClick:!!e,pagination:this.pagination,selectedTags:t})}},handleResize:function(e){this._rerenderGridAfterResize()},handleScroll:function(e){if(this._ignoreNextVerticalScroll)this._ignoreNextVerticalScroll=!1;else{var s=this.verticalScroller$.scrollTop(),t=this.verticalScroller$[0].scrollHeight;s+this.verticalScroller$.height()>=t&&this.pagination.moreBtn$.hasClass("spinner")&&!this.pagination.moreBtn$.hasClass("spinner-loading")&&this.pagination.hasMore&&this.handleLoadMoreClick()}},_setMoreBtnState:function(e){"load-more"===e?(this.pagination.moreBtn$.removeClass("disabled").removeClass("spinner"),s.delay(function(){this.pagination.moreBtn$.removeClass("hide").removeClass("melting")}.bind(this),300)):"spinner-loaded"===e||"no-more"===e?(this.pagination.moreBtn$.removeClass("disabled").addClass("spinner").removeClass("spinner-loading"),"no-more"===e?this.pagination.moreBtn$.addClass("no-more"):this.pagination.moreBtn$.removeClass("no-more")):"spinner-loading"===e&&this.pagination.moreBtn$.removeClass("disabled").addClass("spinner").addClass("spinner-loading").removeClass("no-more")},handleItemClick:function(s){if(this.gridOptions.implicitCreateCta){var t=e(s.currentTarget),r=(t.data("cta"),t.closest(".search-results-grid-item"));this._handleCreateFromItem(s,r,{uiId:"thumb-hover-create"})}},_handleCreateFromItem:function(e,t,r){var i=t.data("id"),a=this.assetsById[i];r=s.assign({},{context:"item-grid",alias:a.alias,sparkFormat:a.app},r||{}),this.gridOptions.createFromThumbClickHandler(a,{analytics:r,event:e})},getDataForRedraw:function(){return{showingDetailId:this._showingDetail&&this._detailInfo.asset&&this._detailInfo.asset.id}},handleItemMainCtaClick:function(s){var t=e(s.currentTarget),r=t.data("cta"),i=t.data("analytics-id"),a=t.closest(".search-results-grid-item");"create"===r&&this._handleCreateFromItem(s,a,{uiId:i})},isRetina:function(){return window.devicePixelRatio>1||!(!window.matchMedia||!window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(min--moz-device-pixel-ratio: 1.5),(-o-min-device-pixel-ratio: 3/2),(min-resolution: 1.5dppx)").matches)},_getAssetFromClickTarget:function(e,s){s=s||".search-results-grid-item";var t=e.closest(s).data("id");return this.assetsById[t]},handleItemCtaClick:function(s){var t=e(s.currentTarget),r=t.data("id"),i=this._getAssetFromClickTarget(t);if(s.preventDefault(),s.stopImmediatePropagation(),"detail"===r){if(this.gridOptions.preDetailViewCallback){var a=this.gridOptions.preDetailViewCallback(i);a.resized&&this.containerResized(a)}this._showDetailViewForAsset(i,this.assets,{context:"from-results-cta"})}},jumpToDetailAsset:function(e){"string"==typeof e&&(e=this.assetsById[e]),e&&this._showDetailViewForAsset(e,this.assets,{context:"from-jump"})},handleFavoriteIconClick:function(s){s.preventDefault(),s.stopImmediatePropagation();var t,r,i,a,l=e(s.currentTarget),o=l.parents(".search-results-grid-item");l.hasClass("search-results-grid-item-detail-cta")?(i=!0,a=this._detailInfo.asset,o=l,r=this.detailView$.find("#other-results-item-"+a.id)):(o.length||(o=l.parents(".search-results-grid-item-detail-other-results-item"),i=!0),a=this.assetsById[o.data("id")]);var n=o.hasClass("is-favorite");o.hasClass("is-setting-favorite")||(o.addClass("is-setting-favorite"),n=!n,i&&(t=this.resultsGrid$.find("#thumb_"+a.id).parents(".search-results-grid-item")),n?(o.addClass("is-favorite"),t&&t.addClass("is-favorite"),r&&r.addClass("is-favorite")):(o.removeClass("is-favorite"),t&&t.removeClass("is-favorite"),r&&r.removeClass("is-favorite")),this.gridOptions.setFavorite(a,n).then((function(){o.removeClass("is-setting-favorite")})))},remove:function(){return this.$el.empty(),this.$el.addClass("hide"),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize)),e(document.body).find(".vb-search-header").removeClass("short-header"),this},searchViewShown:function(e){var t=!1;if(e.gridDims||e.containerDims){this.gridDims&&this._lastGridData||window.marvel.logger.debug("null gridDims or lastGridData in searchViewShown",{gridDims:this.gridDims,lastGridData:this._lastGridData}),t=!0;var r=s.find(e.gridDims,function(e,s){return this.gridDims[s]!==e}.bind(this));if(s.isUndefined(r)){var i=s.find(e.containerDims,function(e,s){return this._lastGridData.containerDims[s]!==e}.bind(this));t=!s.isUndefined(i)}}t?this.containerResized(e):this._setupVisibleTags()},containerResized:function(e){e.gridDims&&s.assign(this.gridDims,e.gridDims),this._render({isResize:!0,containerDims:e.containerDims}),this._detailConfirmInfo&&this._detailConfirmInfo.showing&&this._redrawCurrentConfirm()},_parseTags:function(e){var t=[],r=this.tagsData.tagsInOrder;return this.gridOptions.maxNumTagsInResults&&r.length>this.gridOptions.maxNumTagsInResults&&(r=r.slice(0,this.gridOptions.maxNumTagsInResults)),s.each(r,(function(r){var i={label:r.keyword.replace(/\-/g," ")},a=r.prefix;if(!a&&r.fields&&(a=r.fields.length>1?"multi":r.fields[0]),a&&(i.prefix=a),e){var l=[];r.tags&&(l=r.tags),l.length&&(i.title=l.join(","))}t.push(s.assign(i,r))})),t},_applySelectedTagsToResultsAfterRender:function(){s.each(this.tagsData.currentSelectedTags,function(e){this._setTagDivsSelected(e.id,!0)}.bind(this))},_tagsAboveResultsEnabled:function(){return!this.gridDims.hideTagsAboveResults},_setupVisibleTags:function(e){if(this._tagsAboveResultsEnabled()){e=e||{};var s,t=this.$el.find(".search-results-tags-scroller-holder"),r=t.find(".search-results-tags-scroller"),i=t.find(".search-results-tags");s=i[0].scrollWidth,this._tagsScroll={scrollerHolder$:t,scroller$:r,scrollerWidth:r.innerWidth(),contentWidth:s,tagsRow$:i,currentScroll:0},this._fitVisibleTags()}},_fitVisibleTags:function(){if(this._tagsScroll.tags$=this._tagsScroll.scrollerHolder$.find(".search-results-tag"),"optimizedMore"!==this._lastGridData.narrowTagsArea){var t=this._tagsScroll.scroller$.innerWidth(),r=-1;if(this._tagsScroll.contentWidth>t){this._tagsScroll.tags$.removeClass("hide");var i=e(this._tagsScroll.tags$[0]).offset().left;s.find(this._tagsScroll.tags$,(function(s,a){var l=e(s);if(l.offset().left-i+l.outerWidth()>t)return r=a,!0})),-1!==r&&(this._tagsScroll.tags$.addClass("hide"),this._tagsScroll.tags$.slice(0,r).removeClass("hide"),this._tagsScroll.lastVisibleIndex=r-1)}this._tagsScroll.scrollerHolder$.addClass("scrolling-disabled")}else this._tagsScroll.tags$.addClass("hide")},_setTagDivsSelected:function(e,s){var t=this.$el.find(".search-results-tag-tag-"+e+'[data-id="'+e+'"]');s?t.addClass("selected"):t.removeClass("selected")},_isTagSelectedInDetail:function(e){return this.$el.find(".search-results-detail-tag-tag-"+e).hasClass("selected")},handleDebugIdClick:function(s){if(this.gridOptions.debugSettings.cpAssetPathTemplate){s.stopImmediatePropagation();var t=e(s.currentTarget).data("id"),r=this.assetsById[t],i=n.getFormatInfo(r.app).app.getCPCommunity(),a=this.gridOptions.debugSettings.cpAssetPathTemplate.replace("{assetId}",t).replace("{community}",i);window.open(a,"_blank")}},handleTagClick:function(t){var r,i=e(t.currentTarget),a=i.data("id"),l=a;if(t.preventDefault(),t.stopImmediatePropagation(),this.tagsData.keysForTags){if(!(r=this.tagsData.tags[l])){var o=a.split("-");l=2===o.length?o[1]:o.slice(1).join("-"),r=this.tagsData.tags[l]}}else r=this.tagsData.tags[l];if(!this.tagsData.atMaxSelectedTags||!r||r.selected||r.isPremium){var n=[],h={selectedTags:s.map(this.tagsData.currentSelectedTags,(function(e){return n.push(e.srcKey||e.id),e.id})),selectedTagKeys:n};if(r)if(i.hasClass("search-results-grid-item-detail-tag")){var c=this._isTagSelectedInDetail(a);this._setTagDivsSelected(a,!c),//!tagData.selected would be if we show selected when displaying detail
h.changeSelectionValue=!c,this.gridOptions.tagClickHandler(r,h)}else this._setTagDivsSelected(a,!r.selected),this.gridOptions.tagClickHandler(r,h);else window.marvel.logger.debug("tagData not found for tag click:"+a)}},searchTriggered:function(){this._showingDetail&&this.closeDetail()},_setDetailRightSide:function(e){if(this.gridOptions.rightRailForDetail){var t=[],r=n.getFormatInfo(e.app);s.each(e.allTags,function(e){var r=!!s.find(this.tagsData.currentSelectedTags,(function(s){return s.id===e.id}));t.push(s.assign({},e,{selected:r}))}.bind(this));var i=s.assign({},e,{allTags:t,appLabel:r.formatLabel});this._extendDebugSettingsToTemplateSettings(i);var a=c.to_html(p,i);this.detailRightSide$.html(a)}else{var l=this.detailView$.find(".search-results-grid-item-detail-tags"),o=this.detailView$.find(".search-results-grid-item-detail-header-cta-favorite");e.favoriteData&&e.favoriteData.favDate>0?o.addClass("is-favorite"):o.removeClass("is-favorite"),l.html(c.to_html('{{#allTags}}{{^hideTag}}<div class="search-results-grid-item-detail-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-detail-tag-tag-{{id}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>{{/hideTag}}{{/allTags}}',this._extendDebugSettingsToTemplateSettings({allTags:e.allTags})))}},_hiRezDetailRequests:{hrefs:{},forceNext:!1,delay:1e3},_cancelDetailImageBackgroundNextLoad:function(){this._hiRezDetailRequests.timeout&&(clearTimeout(this._hiRezDetailRequests.timeout),this._hiRezDetailRequests.timeout=null)},_resetHiRezDetailRequests:function(e){this._cancelDetailImageBackgroundNextLoad(),s.isUndefined(e)||(this._hiRezDetailRequests.forceNext=e)},_requestDetailImageBackground:function(e,s){this._cancelDetailImageBackgroundNextLoad(),!this._hiRezDetailRequests.delay||this._hiRezDetailRequests.forceNext||this._hiRezDetailRequests.hrefs[s]?(this._hiRezDetailRequests.forceNext=!1,this._hiRezDetailRequests.hrefs[s]=!0,e.css("background-image","url("+s+")")):(e.css("background-image","none"),this._hiRezDetailRequests.timeout=setTimeout(function(){this._hiRezDetailRequests.hrefs[s]=!0,e.css("background-image","url("+s+")")}.bind(this),this._hiRezDetailRequests.delay))},_setDetailImage:function(e,s,t,r){var i,a,l=e.height,o=e.width,n=t,h=s,c=this.isRetina();l>n?o>s?h/o>=n/l?(i="height",a=n):(i="width",a=h):(i="height",a=n):o>h?(i="width",a=s):(i="width",a=o);var d,u,g=a*(c?2:1),p=this._getRenditionUrl(e.templatedImgHref,g,i),m=r&&r.detailImage$||this.detailImage$,v=r&&r.loader$||this.$el.find(".search-results-grid-item-detail-image-holder").find(".search-results-grid-item-detail-loading");r&&(r.renditionInfo={href:p,dim:g,isRetina:c,dimType:i},r.resizer$&&("width"===i?(d=a,u=Math.round(e.height*d/e.width)):(u=a,d=Math.round(e.width*u/e.height)),u=Math.min(u,t),d=Math.min(d,s),r.resizer$.css("width",d+"px"),r.resizer$.css("height",u+"px")));this._requestDetailImageBackground(m,p);var f=this.$el.find("#thumb_"+e.id);this._copyCss(f,v,["background-image"])},_copyCss:function(e,t,r){s.each(r,(function(s){t.css(s,e.css(s))}))},_setAssetDetailTagsForTagFilters:function(e){s.each(e.allTags,function(e){var s=this.tagsData.tags[e.keyword];s?(e.isFilter=s.isFilter,e.isSearchTerm=s.isSearchTerm,e.isFilter?(e.selected=!0,e.hideTag=!1):(e.hideTag=s.isSearchTerm,e.selected=!1)):window.marvel.logger.debug("no srcTag match in _setAssetDetailTagsForTagFilters")}.bind(this))},_detailAssetSet:function(e){e.itemsViewed.byId[e.asset.id]||(e.itemsViewed.byId[e.asset.id]=e.asset,e.itemsViewed.total++)},_setDetailAsset:function(e,s){s=s||{},this._setAssetDetailTagsForTagFilters(e),s.analytics&&this.gridOptions.assetDetailShownCallback&&this.gridOptions.assetDetailShownCallback({asset:e,analytics:s.analytics}),this._detailInfo.selectedThumbItem$&&this._detailInfo.selectedThumbItem$.removeClass("selected"),this._detailInfo.selectedThumbItem$=this.detailView$.find("#other-results-item-"+e.id).addClass("selected"),this._detailInfo.asset=e,this._detailInfo.index=e._orderedIndex,this.gridOptions.allowPremiumTemplates&&(e.isPremiumTemplate?this.detailView$.addClass("is-premium-template"):this.detailView$.removeClass("is-premium-template")),this._setDetailImage(e,this._detailInfo.maxW,this._detailInfo.maxH),this._setDetailRightSide(e),this._setShareTemplateHtml(e),this._detailAssetSet(this._detailInfo),s.noScroll||this._scrollDetailAssetIntoView()},_redrawCurrentConfirm:function(){if(this._detailConfirmInfo&&this._detailConfirmInfo.showing){var e=s.assign({},this._detailConfirmInfo.currentOptions,{isRedraw:!0});this._setDetailConfirmAsset(this._detailConfirmInfo.asset,e)}},_setDetailConfirmAsset:function(e,s){s=s||this._detailConfirmInfo.currentOptions||{},this._detailConfirmInfo.currentOptions=s,this._detailConfirmInfo.asset=e,this._detailConfirmInfo.index=e._orderedIndex;var t=this._detailConfirmInfo.detailImageContainer$.width(),r=this._detailConfirmInfo.detailImageContainer$.height();this.gridOptions.allowPremiumTemplates&&(e.isPremiumTemplate?this._detailConfirmInfo.detailView$.addClass("is-premium-template has-premium-ingredient-fonts"):this._detailConfirmInfo.detailView$.removeClass("is-premium-template has-premium-ingredient-fonts")),this._setDetailImage(e,t,r,this._detailConfirmInfo),this._detailAssetSet(this._detailConfirmInfo)},closeDetailConfirm:function(e){this._resetHiRezDetailRequests(),this._detailConfirmInfo&&(this._detailConfirmInfo.buttons$.off("click",this._detailConfirmInfo.buttonClickFunc),this._detailConfirmInfo.showing=!1,this._detailConfirmInfo.overlay$.addClass("hide"),e&&(this._detailConfirmInfo.overlay$.empty(),this._detailConfirmInfo.emptied=!0),this._detailConfirmInfo.keyEventElem$&&(this._detailConfirmInfo.keyEventElem$.off("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this._detailConfirmInfo.keyEventFunc),this._detailConfirmInfo.keyEventElem$=null))},_trackConfirmEvent:function(e,t){var r=this._detailConfirmInfo.analytics.context;"header"===r&&(r="search");var i={},a="npw"===r?"search":r;if("editor:post"===a&&(a="editorPost"),a="previewLocation:"+a,"templatePreviewClosed"===e){var o=this._detailConfirmInfo.asset.locales;s.assign(i,{contextualData2:a,contextualData3:"isNav:"+(this._detailConfirmInfo.asset!==t.originalAsset),templateId:this._detailConfirmInfo.asset.id,contextualData1:"numPreviewed:"+this._detailConfirmInfo.itemsViewed.total,contextualData4:"templateType:"+(this._detailConfirmInfo.asset.premium?"premium":"free"),contextualData6:"tagNames:"+this.gridOptions.getTagNamesAnalyticValForAsset(this._detailConfirmInfo.asset),contextualData7:"templateLocale:"+o})}else"templatePreviewed"===e&&s.assign(i,{templateId:this._detailConfirmInfo.asset.id,contextualData5:a});var n=this._detailConfirmInfo.analytics[e];n&&(n.data&&s.assign(i,n.data),n.callback&&n.callback(i,t)),l.trackEvent(e,i,r)},showDetailConfirmForCurrentClickedThumb:function(t){var i=e(document.body).find(".search-results-grid-item-detail-confirm-overlay");i.length||(i=e('<div class="search-results-grid-item-detail-confirm-overlay search-results-grid-item-detail-confirm-button hide"></div>'),e(document.body).append(i)),t.analytics&&t.analytics.templatePreviewedClosed&&(t.analytics.templatePreviewClosed=t.analytics.templatePreviewedClosed),this._detailConfirmInfo={totalAssets:this.assets.length,canNav:t.showPreviewNav&&this.assets.length>1,assets:this.assets,maxW:600,maxH:600,closeDefer:r.defer(),overlay$:i,showing:!0,analytics:t.analytics,itemsViewed:{byId:{},total:0}};var a=function(i,a){var n,h,c,d;if(i){var u=e(i.currentTarget),g=e(i.target).hasClass("search-results-grid-item-detail-confirm-overlay");if(u.hasClass("detail-close-button")||g)n="close";else if(u.hasClass("search-results-grid-item-detail-nav"))n="nav";else{if(!u.hasClass("search-results-grid-item-detail-confirm-cta"))return;n="cta";var p=u.data("id");h=s.find(t.ctas,(function(e){return e.id===p}))}i.preventDefault(),i.stopPropagation()}else if(a===o.DOM_VK_ESCAPE)n="close";else{if(a!==o.DOM_VK_RETURN)return;if(1!==t.ctas.length)return;n="cta",h=t.ctas[0]}if("close"===n)d={cancelled:!0,closeDefer:c=r.defer(),originalAsset:t.asset},this._trackConfirmEvent("templatePreviewClosed",d),this._detailConfirmInfo.closeDefer.resolve(d);else if("cta"===n){if(d={closeDefer:c=r.defer(),cta:h,asset:this._detailConfirmInfo.asset,originalAsset:t.asset,detailRenditionInfo:this._detailConfirmInfo.renditionInfo,showUpgradeForPremium:this.gridOptions.showUpgradeForPremium},l.numCheckboxes){var m=s.reduce(this._detailConfirmInfo.detailView$.find(":checkbox"),(function(e,s){return e[s.id]=s.checked,e}),{});d.checkboxValues=m}this._trackConfirmEvent("templatePreviewClosed",d),this._detailConfirmInfo.closeDefer.resolve(d)}else{if("nav"!==n)return;this.handleDetailNavClick(i,{isConfirm:!0})}c&&c.promise.then(function(){this.closeDetailConfirm(!0)}.bind(this))}.bind(this);this._detailConfirmInfo.buttonClickFunc=a;var l=s.assign({},t);l.checkboxes&&l.checkboxes.length&&(l.numCheckboxes=l.checkboxes.length),t.stringsAreIds&&(l.title=h.getString(l.title),l.subtitle=h.getString(l.subtitle),s.each(l.ctas,(function(e){e.text=h.getString(e.text)})),l.checkboxes&&s.each(l.checkboxes,(function(e){e.text=h.getString(e.text)}))),l.canNav=l.previewNavType&&this.assets.length>1,"side"===l.previewNavType?l.showPreviewNavSide=!0:"bottom"===l.previewNavType&&(l.showPreviewNavBototm=!0);var n=h.mustacheRender(g,l);this._detailConfirmInfo.detailView$=e(n),this._detailConfirmInfo.detailImageContainer$=this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-image-and-tags-holder");var c=this._detailConfirmInfo.detailImageContainer$.find(".search-results-grid-item-detail-image-holder");this._detailConfirmInfo.resizer$=c,this._detailConfirmInfo.detailImage$=c.find(".search-results-grid-item-detail-image"),this._detailConfirmInfo.loader$=this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-loading"),i.append(this._detailConfirmInfo.detailView$),i.removeClass("hide"),this._resetHiRezDetailRequests(!0),this._setDetailConfirmAsset(t.asset,t);var d=".search-results-grid-item-detail-confirm-button";return this._detailConfirmInfo.buttons$=i.find(d).addBack(d),this._detailConfirmInfo.buttons$.on("click",a),this._detailConfirmInfo.keyEventFunc=function(e){-1!==[o.DOM_VK_LEFT,o.DOM_VK_RIGHT,o.DOM_VK_ESCAPE,o.DOM_VK_RETURN].indexOf(e.keyCode)&&(e.preventDefault(),"keyup"===e.type&&(e.keyCode===o.DOM_VK_LEFT||e.keyCode===o.DOM_VK_RIGHT?this.handleDetailNavClick(null,{isConfirm:!0,domKey:e.keyCode}):e.keyCode!==o.DOM_VK_ESCAPE&&e.keyCode!==o.DOM_VK_RETURN||a(null,e.keyCode)))}.bind(this),this._detailConfirmInfo.keyEventElem$=e(document),this._detailConfirmInfo.keyEventElem$.on("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this._detailConfirmInfo.keyEventFunc),this._trackConfirmEvent("templatePreviewed",{}),this._detailConfirmInfo.closeDefer.promise},_showDetailViewForAsset:function(t,r,i){this._detailInfo={totalAssets:r.length,canNav:r.length>1,assets:r,maxW:1e3,maxH:1e3,itemsViewed:{byId:{},total:0}},this._showingDetail||(this.detailView$.addClass("revealing"),this.detailView$.removeClass("hide"),s.delay(function(){this.detailView$.removeClass("revealing")}.bind(this),0)),this._resetHiRezDetailRequests(!0),this._setDetailAsset(t,{noScroll:!0,analytics:i}),this._detailInfo.canNav?(this.detailView$.addClass("can-nav"),this._setupDetailResultsScroll({current:!0})):(this.detailView$.removeClass("can-nav"),this._setupDetailResultsScroll({reset:!0})),this._showingDetail=!0,this.tagClickedSinceChangingToGridDetail=!1,e(document.body).find(".vb-search-header").addClass("short-header")},closeDetail:function(){this._showingDetail=!1,this.detailView$.addClass("hide"),this._resetHiRezDetailRequests(),e(document.body).find(".vb-search-header").removeClass("short-header")},handleDetailNavClick:function(s,t){var r=(t=t||{}).isConfirm&&this._detailConfirmInfo||this._detailInfo,i=0,a=r.index;s?i="right"===e(s.currentTarget).data("id")?1:-1:t.domKey===o.DOM_VK_LEFT?i=-1:t.domKey===o.DOM_VK_RIGHT&&(i=1);if(i){(a=r.index+i)<0?a=r.totalAssets-1:a>=r.totalAssets&&(a=0);var l=r.assets[a];t.isConfirm?this._setDetailConfirmAsset(l):this._setDetailAsset(l,{analytics:{context:"from-results-detail-nav"}})}},handleDetailBackArrowClick:function(e){this.closeDetail()},handleDetailCtaClick:function(s){var t=e(s.currentTarget).data("cta-type");if("create"===t){var r={context:"item-detail-create",alias:this._detailInfo.asset.alias||this._detailInfo.asset.id};this.gridOptions.createFromThumbClickHandler(this._detailInfo.asset,{analytics:r,event:s,detailRenditionInfo:this._detailInfo.renditionInfo})}else"share"===t?this.handleShareTemplateButton(s):"favorite"===t&&this.handleFavoriteIconClick(s)},handleDetailResultNavClick:function(s){var t=e(s.currentTarget),r=this._getAssetFromClickTarget(t,".search-results-grid-item-detail-other-results-item");this._setDetailAsset(r,{analytics:{context:"from-results-detail-thumb"}})},_scrollDetailAssetIntoView:function(e){e=e||{};this._detailResultsScroll.resultsSection$[0].scrollWidth;var s,t,r=this._detailResultsScroll.scroller$.innerWidth(),i=(s=e.asset?this.detailView$.find("#other-results-item-"+e.asset.id):this._detailInfo.selectedThumbItem$).offset().left,a=this._detailResultsScroll.scroller$.scrollLeft();if(i<0)t=i;else{var l=i+s.outerWidth();l>r&&(t=l-r)}t&&this._detailResultsScroll.scroller$.scrollLeft(a+t)},_setupDetailResultsScroll:function(e){e=e||{};var s=this.$el.find(".search-results-grid-item-detail-other-results-section-scroller-holder"),t=s.find(".search-results-grid-item-detail-other-results-section-scroller"),r=t.find(".search-results-grid-item-detail-other-results-section");this._detailResultsScroll={scrollerHolder$:s,scroller$:t,resultsSection$:r},e.current?this._scrollDetailAssetIntoView():e.reset?this._detailResultsScroll.scroller$.scrollLeft(0):e.asset&&this._scrollDetailAssetIntoView(e)},handleShareTemplateButton:function(e){this._shareModal$.removeClass("hide"),this._shareModalMenu$.removeClass("hide")},handleShareTemplateCtaClick:function(s){s.preventDefault(),s.stopImmediatePropagation();var t=e(s.currentTarget).data("share-type");"twitter"===t?this.onTwitterShare():"facebook"===t?this.onFacebookShare():"email"===t?this.onEmailShare():"copy"===t&&this.onCopyShare()},handleShareModalCloseClick:function(e){e.preventDefault(),this.closeModal()},onCopyShare:function(){if(this._supportsClipboard){var e=this._shareModal$.find(".js-copy-link"),s=e.data("copy-url");try{i.copyStringToClipboard(s),e.addClass("copied"),e.one("mouseleave",function(s){s.target===s.currentTarget&&e.removeClass("copied"),this.closeModal()}.bind(this))}catch(e){}}},popup:function(e,s,t,r){var i=screen.width/2-t/2,a=screen.height/2-r/2;window.open(e,s,"width="+t+",height="+r+",left="+i+",top="+a+",scrollbars=no,status=0")},closeModal:function(e){this._shareModal$.addClass("hide")},onEmailShare:function(){window.location.href=this._shareModal$.find(".js-email").attr("href"),this.closeModal()},onTwitterShare:function(){var e=this._shareModal$.find(".js-twitter-share").attr("href");this.popup(e,h.getString("npw-vb-search-results-detail-share-modal-title-twitter"),680,500),this.closeModal()},onFacebookShare:function(){var e=this._shareModal$.find(".js-facebook-share").attr("href");this.popup(e,h.getString("npw-vb-search-results-detail-share-modal-title-fb"),680,500),this.closeModal()},_setShareTemplateHtml:function(e){var s="https://spark.adobe.com/"+e.app+"/"+(e.alias||e.id);this._supportsClipboard=i.isClipboardSupported();var t={twitterShareUrl:"https://twitter.com/intent/tweet?url="+encodeURIComponent(s)+"&via=AdobeSpark&hashtags=adobespark",facebookShareUrl:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(s),mailtoString:this.getMailtoString(s,e),copyUrl:this._supportsClipboard&&s};this._extendDebugSettingsToTemplateSettings(t);var r=h.mustacheRender(v,t);this.share$=this.$el.find(".search-results-grid-item-detail-share"),this.share$.html(r),this._shareModal$=this.share$.find(".social-modal"),this._shareModalMenu$=this._shareModal$.find(".social-modal-menu")},getMailtoString:function(e,s){encodeURIComponent("\r\n\r\n");var t={format:n.getFormatInfo(s.app).type,url:e};return"mailto:"+h.formatMessage("npw-vb-search-results-detail-share-modal-mailto",t)}})}.apply(s,r))||(e.exports=i)},3052:function(e,s){e.exports='{{#detailData}}\n<div class="search-results-grid-item-detail-header">\n    <button class="npw-visual-browse-header-back-arrow grid-detail-header-back-arrow{{#detailBackArrowText}} has-text{{/detailBackArrowText}}" title="{{detailBackArrowText}}">{{detailBackArrowText}}</button>\n    <button class="search-results-grid-item-detail-header-create search-results-grid-item-detail-cta" data-cta-type="create">{{npw-vb-search-results-detail-create-btn}}</button>\n    <div class="search-results-grid-item-detail-header-ctas">\n        <div class="search-results-grid-item-detail-header-cta search-results-grid-item-detail-header-cta-share search-results-grid-item-detail-cta" data-cta-type="share">{{npw-vb-search-results-detail-share}}</div>\n        <div class="search-results-grid-item-detail-header-cta search-results-grid-item-detail-header-cta-favorite search-results-grid-item-detail-cta" data-cta-type="favorite"><span class="search-results-grid-item-detail-header-cta-favorite-is-not">{{npw-vb-search-results-detail-add-to-favorites}}</span><span class="search-results-grid-item-detail-header-cta-favorite-is">npw-vb-search-results-detail-favorited</span></div>\n    </div>\n</div>\n<div class="search-results-grid-item-detail-share"></div>\n<div class="search-results-grid-item-detail">\n    <div class="search-results-grid-item-detail-image-section">\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left" data-id="left">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n        <div class="search-results-grid-item-detail-image-and-tags-holder">\n            <div class="search-results-grid-item-detail-image-holder">\n                <div class="search-results-grid-item-thumb-premium-icon"></div>\n                <div class="search-results-grid-item-detail-loading"></div>\n                <div class="search-results-grid-item-detail-image"></div>\n            </div>\n            {{^detailsOnRight}}\n            <div class="search-results-grid-item-detail-tags">\n                {{#allTags}}\n                    {{^hideTag}}\n                    <div class="search-results-grid-item-detail-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-detail-tag-tag-{{id}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>\n                    {{/hideTag}}\n                {{/allTags}}\n            </div>\n            {{/detailsOnRight}}\n        </div>\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right" data-id="right">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n    </div>\n    <div class="search-results-grid-item-detail-other-results-section-scroller-holder">\n        <div class="search-results-grid-item-detail-other-results-section-scroller">\n            <div class="search-results-grid-item-detail-other-results-section" style="width:{{detailAssetsData.totalWidth}};max-width:{{detailAssetsData.maxTotalWidth}};{{#detailAssetsData.minTotalWidth}}min-width:{{.}};{{/detailAssetsData.minTotalWidth}}">\n            {{#detailAssetsData}}\n            {{#assets}}\n                <div class="search-results-grid-item-detail-other-results-item{{#selected}} selected{{/selected}}{{#isFavorite}} is-favorite{{/isFavorite}}{{#isPremiumTemplate}} is-premium-template{{/isPremiumTemplate}}" data-premium="{{isPremiumTemplate}}" style="width:{{detailResultWidth}};" id="other-results-item-{{id}}" data-id="{{id}}">\n                    {{#favoritesEnabled}}\n                    <div class="search-results-grid-item-thumb-favorite-icon"></div>\n                    {{/favoritesEnabled}}\n                    {{#isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-premium-icon"></div>\n                    {{/isPremiumTemplate}}\n                    <div class="search-results-grid-item-detail-other-results-item-thumb" style="width:100%;height:{{detailAssetsData.thumbHeight}};{{#detailAssetsData.minThumbHeight}}min-height:{{.}}{{/detailAssetsData.minThumbHeight}}" id="{{thumbId}}">\n                    <div class="search-results-grid-item-detail-other-results-item-thumb-loader">\n                    </div>\n                    </div>\n                    <div class="search-results-grid-item-detail-other-results-item-selection"></div>\n                    {{! not setting for now}}{{#showDetailThumbLabels}}{{#label}}<div class="search-results-grid-item-detail-other-results-item-label">{{.}}</div>{{/label}}{{/showDetailThumbLabels}}\n                </div>\n            {{/assets}}\n            {{/detailAssetsData}}\n            </div>\n        </div>\n    </div>\n</div>\n<div class="search-results-grid-item-detail-right">\n</div>\n{{/detailData}}\n'},3053:function(e,s){e.exports='<div class="search-results-grid-item-detail{{#canNav}} can-nav{{/canNav}}{{#cssClass}} {{.}}{{/cssClass}}" data-auto="search-results-detail-confirm">\n    <button class="detail-close-button search-results-grid-item-detail-confirm-button" data-auto="search-results-detail-confirm-close-btn"></button>\n    <div class="search-results-grid-item-detail-image-section{{#previewNavType}} show-preview-nav show-preview-nav-{{previewNavType}}{{/previewNavType}}">\n        {{#showPreviewNavSide}}\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left search-results-grid-item-detail-confirm-button" data-id="left">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n        {{/showPreviewNavSide}}\n        <div class="search-results-grid-item-detail-image-and-tags-holder">\n            <div class="search-results-grid-item-detail-image-holder">\n                <div class="search-results-grid-item-thumb-premium-icon hide-if-not-premium"></div>\n                <div class="search-results-grid-item-detail-loading"></div>\n                <div class="search-results-grid-item-detail-image"></div>\n            </div>\n        </div>\n        {{#showPreviewNavSide}}\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right search-results-grid-item-detail-confirm-button" data-id="right">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n        {{/showPreviewNavSide}}\n        {{#showPreviewNavBottom}}\n        <div class="search-results-grid-item-detail-preview-nav">\n            <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left  search-results-grid-item-detail-confirm-button" data-id="left">\n                <div class="search-results-grid-item-detail-nav-icon"></div>\n            </div>\n            <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right  search-results-grid-item-detail-confirm-button" data-id="right">\n                <div class="search-results-grid-item-detail-nav-icon"></div>\n            </div>\n        </div>\n        {{/showPreviewNavBottom}}\n    </div>\n    <div class="search-results-grid-item-detail-confirm-right">\n        <div class="search-results-grid-item-detail-premium-blurbs">\n            <div class="search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-template hide-if-not-premium">{{search-results-confirm-premium-template}}</div>\n            <div class="hide search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-blurb-fonts show-if-premium-ingredient-fonts">{{search-results-confirm-made-width-adobe-fonts}}</div>\n        </div>\n        <div class="search-results-grid-item-detail-message-and-ctas">\n            <h2 class="search-results-grid-item-detail-confirm-title">{{title}}</h2>\n            {{#subtitle}}\n            <h3 class="search-results-grid-item-detail-confirm-subtitle">{{{subtitle}}}</h3>\n            {{/subtitle}}\n            {{#numCheckboxes}}\n            {{#checkboxes}}\n            <label class="spectrum-Checkbox">\n                {{#checked}}\n                <input type="checkbox" class="spectrum-Checkbox-input" name="{{id}}" id="{{id}}" data-auto="search-results-detail-confirm-checkbox-{{id}}" checked>\n                {{/checked}}\n                {{^checked}}\n                <input type="checkbox" class="spectrum-Checkbox-input" name="{{id}}" id="{{id}}" data-auto="search-results-detail-confirm-checkbox-{{id}}">\n                {{/checked}}\n                <span class="spectrum-Checkbox-box-holder">\n                <span class="spectrum-Checkbox-box-border"></span>\n                <span class="spectrum-Checkbox-box-check"></span>\n                </span>\n                <span class="spectrum-Checkbox-label">{{text}}</span>\n            </label>\n            {{/checkboxes}}\n            {{/numCheckboxes}}\n            <div class="search-results-grid-item-detail-confirm-ctas">\n            {{#ctas}}\n                <button class="search-results-grid-item-detail-confirm-cta {{#primary}} primary-cta{{/primary}} search-results-grid-item-detail-confirm-button" data-id="{{id}}" data-auto="search-results-detail-confirm-cta-{{id}}">{{text}}</button>\n            {{/ctas}}\n            </div>\n        </div>\n    </div>\n</div>\n'},3054:function(e,s){e.exports='<div class="search-results-grid-item-detail-right-ctas">\n    <div class="search-results-grid-item-detail-right-cta search-results-grid-item-detail-cta" data-cta-type="create">Create a {{appLabel}} like this</div>\n\n    <div class="search-results-grid-item-detail-share">\n    </div>\n</div>\n<div class="search-results-grid-item-detail-right-tags">\n    {{#allTags}}\n        <div class="search-results-grid-item-detail-right-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>\n    {{/allTags}}\n</div>'},3055:function(e,s){e.exports='<div class="search-results-grid-view{{#favoritesEnabled}} favorites-enabled{{/favoritesEnabled}}" data-auto="search-reults-grid-view">\n{{#tagsAboveResults}}\n<div class="search-results-tags-container">\n    <div class="search-results-tags-scroller-holder{{#narrowTagsArea}} narrow-tags-area{{/narrowTagsArea}}" style="{{^narrowTagsArea}}max-width:{{maxRowWidth}};{{/narrowTagsArea}}">\n        <div class="search-results-tags-scroller">\n            <div class="search-results-tags{{#atMaxSelectedTags}} at-max-tags{{/atMaxSelectedTags}}" data-auto="search-results-grid-view-tags">\n                {{#tags}}\n                <button class="search-results-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" title="{{title}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{label}}</button>\n                {{/tags}}\n            </div>\n        </div>\n    </div>\n</div>\n{{/tagsAboveResults}}\n<div class="search-results-grid-item-detail-holder hide">\n    {{ > itemDetail}}\n</div>\n<div class="search-results-grid-holder">\n    <div class="search-results-grid{{#favoritesEnabled}} favorites-enabled{{/favoritesEnabled}}" style="max-width:{{maxRowWidth}}">\n    {{{assetsStyles}}}\n    {{#rows}}\n    <div class="search-results-grid-row{{#partialRow}} {{partialRow}}{{/partialRow}}{{#delayAllAssets}} hide-assets{{/delayAllAssets}}" style="{{#rowVSpace}}margin-top:{{rowVSpace}}px;{{/rowVSpace}}" data-auto="search-results-grid-view-row">\n        {{#assets}}\n            <div class="search-results-grid-item search-results-grid-item-{{type}}{{#isPremiumTemplate}} is-premium-template{{/isPremiumTemplate}}{{#isFavorite}} is-favorite{{/isFavorite}}{{#hideUntilLoaded}} not-loaded{{/hideUntilLoaded}}{{#hadLoadError}} had-load-error{{/hadLoadError}}{{#implicitCreateCta}} implicit-create-cta{{/implicitCreateCta}}{{#isEdge}} is-edge{{/isEdge}}{{#isIE}} is-IE{{/isIE}}" style="{{#marginRight}}margin-right:{{marginRight}};{{/marginRight}}" data-tags="{{tagsForData}}" data-id="{{id}}" data-cta="{{#implicitCreateCta}}create{{/implicitCreateCta}}"  data-cta-item-id="{{#implicitCreateCta}}{{ctaItemId}}{{/implicitCreateCta}}" data-premium="{{isPremiumTemplate}}" data-auto="search-results-grid-item">\n                <div class="search-results-grid-item-thumb-bg-load" style="width:{{bgLoadWidth}};height:{{bgLoadHeight}}"></div>\n                <div class="search-results-grid-item-thumb" id="{{thumbId}}">\n                    {{#favoritesEnabled}}\n                    <div class="search-results-grid-item-thumb-favorite-icon"></div>\n                    {{/favoritesEnabled}}\n                    {{#isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-premium-icon"></div>\n                    {{/isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-icon"></div>\n                    <div class="search-results-grid-item-hover-thang{{#isEdge}} is-edge{{/isEdge}}{{#isIE}} is-IE{{/isIE}}">\n                        <div class="search-results-grid-item-hover-thang-background"></div>\n                        {{#hoverCtas.numCtas}}\n                        <div class="search-results-grid-item-hover-ctas">\n                            {{#hoverCtas.ctas}}\n                            <div class="search-results-grid-item-hover-cta search-results-grid-item-hover-cta-{{id}}" data-id="{{id}}"></div>\n                            {{/hoverCtas.ctas}}\n                        </div>\n                        {{/hoverCtas.numCtas}}\n                        {{^implicitCreateCta}}\n                        <div class="search-results-grid-main-cta search-results-grid-main-cta-create" data-analytics-id="thumb-hover-create" data-auto="search-result-item-cta-create" data-cta="create" data-cta-item-id="{{ctaItemId}}">{{uiStrings.resultItemCreateFrom}}</div>\n                        {{/implicitCreateCta}}\n                        <div class="search-results-grid-item-hover-tags {{debugCssStr}}">\n                        {{#debugCssStr}}\n                        <div class="search-results-grid-item-hover-id {{debugCssStr}}" data-id="{{id}}">{{id}}</div>\n                        <div class="search-results-grid-item-hover-size {{debugCssStr}}">{{assetW}}x{{assetH}}({{assetAspectRatio}})</div>\n                        {{#score}}\n                        <div class="search-results-grid-item-hover-score {{debugCssStr}}">{{score}}</div>\n                        {{/score}}\n                        {{/debugCssStr}}\n                        {{#allTags}}\n                        <div class="search-results-grid-item-hover-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" title="{{#debugCssStr}}{{prefix}}{{/debugCssStr}}" data-id="{{id}}">{{label}}</div>\n                        {{/allTags}}\n                        </div>\n                    </div>\n                </div>\n                {{#label}}\n                <div class="search-results-grid-item-label {{debugCssStr}}">{{.}}</div>\n                {{/label}}\n            </div>\n        {{/assets}}\n    </div>\n    {{/rows}}\n    </div>\n    {{#pagination}}\n    <div class="search-results-pagination{{#hasMore}} has-more{{/hasMore}}">\n        <div class="search-results-pagination-pages-info">{{^total}}{{#fm}}npw-vb-search-results-pagination-none{{/fm}}{{/total}}{{#total}}{{#fm}}npw-vb-search-results-pagination-some{{/fm}}{{/total}}</div>\n\n        <button class="search-results-pagination-more load-more-toggle">{{npw-vb-search-results-see-more}}</button>\n\n    </div>\n    {{/pagination}}\n</div>\n</div>\n'},3056:function(e,s){e.exports='<div class="social-modal js-share-modal social-overlay-bg hide">\n            <div class="social-modal-bg">\n                <button class="x-close-btn js-close-modal">X</button>\n                <div class="social-modal-header">{{npw-vb-search-results-detail-share-modal-title}}</div>\n                <div class="social-modal-menu hide js-social-modal-menu">\n                    <div href="{{{ twitterShareUrl }}}" target="_blank" data-share-type="twitter" class="social-line twitter js-twitter-share">{{npw-vb-search-results-detail-share-modal-btn-tweet}}</div>\n                    <div href="{{{ facebookShareUrl }}}" target="_blank" data-share-type="facebook" class="social-line facebook js-facebook-share">{{npw-vb-search-results-detail-share-modal-btn-fb}}</div>\n\n                    <div href="{{ mailtoString }}" target="_blank" data-share-type="email" class="social-line email js-email">{{npw-vb-search-results-detail-share-modal-btn-email}}</div>\n                    {{#copyUrl}}\n                    <div class="social-line copy js-copy-link" data-copy-url="{{.}}"" data-share-type="copy"><span class="copy-span">{{npw-vb-search-results-detail-share-modal-btn-copy-link}}</span><span class="copied-span">{{npw-vb-search-results-detail-share-modal-link-copied}}</span></div>\n                    {{/copyUrl}}\n                </div>\n            </div>\n        </div>\n'},3057:function(e,s,t){var r,i;r=[t(1),t(0),t(3),t(2),t(37),t(8)],void 0===(i=function(e,s,t,r,i,a){"use strict";var l={};return r.Model.extend({initialize:function(e){e=e||{},l={},this.MAX_TEMPLATE_SEARCH_STRING_LENGTH=e.MAX_TEMPLATE_SEARCH_STRING_LENGTH,this.MAX_TEMPLATE_SEARCH_TERMS=e.MAX_TEMPLATE_SEARCH_TERMS,this.MAX_SUGGEST_IF_FILTERS=3,this.MAX_RESULTS_CACHE_TIME=e.MAX_RESULTS_CACHE_TIME||72e5,l[e.REMIX_PAID_MAP_TAG]={tag:e.REMIX_PAID_MAP_TAG,dflt:"hide"},l[e.GIPHY_TAG]={tag:e.GIPHY_TAG,dflt:"hide"},this._setupFilters(),this.searchServiceSuggestOptions=s.assign({},e.searchServiceSuggestOptions,{locale:a.getLocale()}),this.SearchRequestsController=e.SearchRequestsController},suggestAggsOnSpace:function(){return this.searchServiceSuggestOptions.suggestAggsOnSpace},_setupFilters:function(e){this._specialTagFilters=e&&e.specialTagFilters||l,s.each(this._specialTagFilters,(function(e){e.key=e.tag.split("-")[1]}))},_suggestedTagPrefixOrder:["spterm","spstyle","spcolor","spsize","spcase","explore","spingred","spinfluencer","spcollect","spmap"],_tagPrefixLabels:{explore:{singular:"category",plural:"categories"},spcase:{singluar:"use case",plural:"use cases"},spterm:{singular:"term",plural:"terms"},spstyle:{singular:"style",plural:"styles"},spcolor:{singular:"color",plural:"colors"},spsize:{singular:"size",plural:"sizes"},spmap:{singlar:"map",plural:"maps"},spingred:{singular:"ingredient",plural:"ingredients"},spinfluencer:{singular:"influencer",plural:"influencers"},spcollect:{singular:"collection",plural:"collections"},sploc:{singluar:"locale",plural:"locales"},all:{singular:"tag",plural:"tags"}},_getGroupedTagLinesForService:function(e){var t=e.prefix,r=e.aggs,i=r&&r.length&&r[0],a=i&&i.tagsInOrder,l=" "+t.toLowerCase()+" ";if(!a)return[];var o={},n=[];return s.each(a,function(s){var t,r;if(e.useKeys)s.label||window.marvel.logger.debug("[SearchSuggestController]no tabel for tag",s),t=s.label||s.keyword,r="all";else{var i=s.split("-");r=i[0],t=i[1]}var a=o[r];a||(a={prefix:r,groupId:r,id:r,keywordsById:{},items:[],label:this._tagPrefixLabels[r],isAddText:!0,numMoreItems:0},o[r]=a,n.push(a));var h=a.keywordsById[t];h||-1===l.indexOf(" "+t.toLowerCase()+" ")&&(h={id:t,label:t,count:s.numAssets},e.useKeys?(e.debug&&(h.itemTitle=s.tags.slice(0).sort().join(",")),h.key=t):h.tag=s,h.srcKey=s.srcKey||s.key,a.keywordsById[t]=h,a.items.push(h))}.bind(this)),n.sort(function(e,s){return this._suggestedTagPrefixOrder.indexOf(e.prefix)-this._suggestedTagPrefixOrder.indexOf(s.prefix)}.bind(this)),s.each(n,function(t){t.items.sort((function(e,s){return s.count-e.count})),e.maxItemsToDisplayInGroup&&t.items.length>e.maxItemsToDisplayInGroup&&(t.numMoreItems=t.items.length-e.maxItemsToDisplayInGroup,s.each(t.items.slice(e.maxItemsToDisplayInGroup),(function(e){e.ifShowingAll=!0})))}.bind(this)),n},_getNewTagGroup:function(e,s){return s=s||{},{prefix:e,groupId:e,id:e,items:[],label:this._tagPrefixLabels[e],numMoreItems:0,maxNumSelectedTags:s.maxNumSelectedTags||0,maxKeywordFiltersToDisplay:s.maxKeywordFiltersToDisplay||0,atMaxTags:!1,numMaxTagsSelected:0}},_applyMaxKewywordFiltersToDisplayForGroup:function(e,t){e.maxKeywordFiltersToDisplay&&(e.numMoreItems=0,s.each(e.items,(function(s,r){t&&(s.selected=!1),r<e.maxKeywordFiltersToDisplay?s.ifShowingAll=!1:(s.ifShowingAll=!0,e.numMoreItems++)})))},getSelectedTagsForNoResults:function(e,t){if(t){var r=!1;if(e&&e.length){var i=[],a=[],l={},o=0;s.each(e,(function(e){l[e.label]=!0})),s.each(t.items,(function(e){e.selected=!!l[e.label],e.selected?(a.push(e),e.isPremium||o++):i.push(e)})),t.items=a.concat(i),t.numSelected=a.length,t.maxNumSelectedTags&&(t.numMaxTagsSelected=o)}else r=!0,t.numSelected=0,t.numMaxTagsSelected=0,t.atMaxTags=!1;return this._applyMaxKewywordFiltersToDisplayForGroup(t,r),t}return this._getTagLinesForSelectedTags({tagFilters:e})},_getTagLinesForSelectedTags:function(e,t){var r,i=t&&t.tagsInOrder&&t.tagsInOrder.length&&t.tagsInOrder,a=e.tagFilters&&e.tagFilters.length&&e.tagFilters;if(i&&!e.showOnlySelectedKeywordFilters||a){r=this._getNewTagGroup("all",e);var l={};if(a){var o=0;s.each(a,(function(t){var i=t.label||t.keyword,a={label:i,id:i,count:t.numAssets,selected:!0,tags:t.tags&&s.clone(t.tags).sort().join(",")||""};e.debug&&(a.itemTitle=a.tags),t.isPremium||o++,r.items.push(a),l[a.label]=a})),r.numSelected=r.items.length,r.atMaxTags=r.maxNumSelectedTags>0&&o>=r.maxNumSelectedTags,r.numMaxTagsSelected=o}i&&!e.showOnlySelectedKeywordFilters&&(!e.maxKeywordFilters||r.items.length<e.maxKeywordFilters)&&s.find(i,(function(t){var i=t.label;if(!l[i]){l[i]=t;var a={label:i,id:i,count:t.numAssets,aggTag:t,tags:t.tags&&s.clone(t.tags).sort().join(",")||"",srcKey:t.srcKey||i};if(e.debug&&(a.itemTitle=a.tags),e.maxKeywordFiltersToDisplay&&r.items.length>=e.maxKeywordFiltersToDisplay&&(a.ifShowingAll=!0,r.numMoreItems++),r.items.push(a),e.maxKeywordFilters&&r.items.length>=e.maxKeywordFilters)return!0}}))}return r},_textLinesFromData:function(e,t){if(!t)return[];var r=[],i=t.toLowerCase();return s.each(e,(function(e,s){var a,l=t,o=e.str,n=o.toLowerCase(),h={chunks:[],key:o};if(n!==i&&(n.startsWith(i)?a=o.substring(t.length):(l="",a=o)),l){var c=t;t.split(" ");h.chunks.push({src:c})}a&&h.chunks.push({hint:a});var d={keysArray:[o.split(" | ").join(" ")],displayArray:[h],totalCount:e.numAssets,srcObj:e};r.push(d)})),r},_recalcNumberOfSplitLines:function(e,s,t){if(e.textLines.length+e.suggestionLines.length>s)if(e.suggestionLines.length<t){var r=s-e.suggestionLines.length;r<e.textLines.length&&(e.textLines=e.textLines.slice(0,r))}else if(s-e.textLines.length>t){var i=s-e.textLines.length;e.suggestionLines=e.suggestionLines.slice(0,i)}else{var a=Math.min(s-t);e.suggestionLines=e.suggestionLines.slice(0,t),e.textLines=e.textLines.slice(0,a)}},_cachedResults:{},_getCachedInfoForOptions:function(e,t){var r=t.cacheId,i=t.tagFilters&&t.tagFilters.length&&t.tagFilters;if(r||(e?r=e:i||(r="all")),r){var a={cacheId:r},l=this._cachedResults[r];return l&&Date.now()-l.timeStamp<this.MAX_RESULTS_CACHE_TIME&&(a.result=s.cloneDeep(l.result)),a}return{ignore:!0}},_cacheAResult:function(e,t){e.cacheId&&(this._cachedResults[e.cacheId]={result:s.cloneDeep(t),timeStamp:Date.now()})},_getAggsFromResultsTags:function(e,s){var t=this.SearchRequestsController.appendFragStringEmptyAggsToArray([],e,0);return t[0].tagsInOrder=s,t},_getMostCommonAggs:function(e,s){var r=this._getCachedInfoForOptions("",{cacheId:"_allCommonAggs"});if(r.result)return r.result[0].str=e[0],r.result=this.SearchRequestsController.appendFragStringEmptyAggsToArray(r.result,e,1),t(r.result);return this.SearchRequestsController.doAggregatesFromFragmentsQuery([""],{tagFilters:null,calcAggsForAllFragments:!0,prependPremium:!0,includeEnglishIfNonEnglish:!0}).then(function(s){return this._cacheAResult(r,s),s[0].str=e[0],s=this.SearchRequestsController.appendFragStringEmptyAggsToArray(s,e,1)}.bind(this))},_getCpPrefixDataFromService:function(e,r){var i=e.prefix,a=1*e.preferredNumSuggestedResults||5,l=1*e.maxTotalResultLinesToDisplay||8,o=e.lastSearchResults&&e.lastSearchResults.tagsData;l<a&&(a=l),i&&(i=this.SearchRequestsController.cleanUserString(i.replace(/  +/g," ").trim())).length>this.MAX_TEMPLATE_SEARCH_STRING_LENGTH&&(i=i.substring(0,this.MAX_TEMPLATE_SEARCH_STRING_LENGTH));var n=this._getCachedInfoForOptions(i,e),h=t.defer(),c=t.defer(),d=this.searchServiceSuggestOptions.numFragmentsToRequest,u=this.searchServiceSuggestOptions.calcAggsForAllFragments;if(n.result)c.resolve(n.result);else if(i){var g,p,m=i,v=i.split(" ");v.length>1&&(this.searchServiceSuggestOptions.multiWordBabel?g=!0:(m=v.pop(),p=v.join(" ")+" "));var f={prefix:m,numFragmentsToRequest:d};this._getSingleFragmentResults(f).then(function(e){if(e.length>0||!g)if(p){var t=s.map(e,(function(e){return p+e}));c.resolve(t)}else c.resolve(e);else f.prefix=v.pop(),this._getSingleFragmentResults(f).then((function(e){if(e.length){p=v.join(" ")+" ";var t=s.map(e,(function(e){return p+e}));c.resolve(t)}else c.resolve(e)})).catch((function(e){c.resolve({err:e})}))}.bind(this)).catch((function(e){c.resolve({err:e})}))}else c.resolve([]);return c.promise.then(function(r){r.err?r=[i]:n.result||this._cacheAResult(n,r);var c,d={},g=e.tagFilters,p=o&&o.tagsInOrder.length&&o.tagsInOrder;r.length||(r=[i]),(this.searchServiceSuggestOptions.updateKeysForUserStringUpdate||e.spaceAggsRecalc)&&(c=!0);var m,v={tagFilters:g,calcAggsForAllFragments:u,includeEnglishIfNonEnglish:!0};if(c){var f=t.defer();m=f.promise,this.SearchRequestsController.doAggregatesFromFragmentsQuery(r,v).then((function(e){f.resolve(e)}),function(s){p?f.resolve(this._getAggsFromResultsTags(r,p)):this._getMostCommonAggs(r,e,v).then((function(e){f.resolve(e)}),(function(){f.reject(s)}))}.bind(this))}else m=p?t(this._getAggsFromResultsTags(r,p)):this._getMostCommonAggs(r,e,v);m.then(function(t){if(e.spaceAggsRecalc&&p){var o=this._getAggsFromResultsTags(r,p);d.selectedTags=this._getTagLinesForSelectedTags(e,o[0])}else d.selectedTags=this._getTagLinesForSelectedTags(e,t[0]);var n=[],c=[];s.each(t,(function(e){var s={str:e.str,numAssets:e.totalResults};s.numAssets&&n.push(s)})),c.sort((function(e,s){return s.numAssets-e.numAssets})),d.splitLinesData={textLines:this._textLinesFromData(n,i),suggestionLines:this._textLinesFromData(c,i)},d.tagLinesGroups=this._getGroupedTagLinesForService({prefix:i,aggs:t,useKeys:!0,maxItemsToDisplayInGroup:e.maxItemsToDisplayInGroup,debug:e.debug}),e.tagFilters&&(d.srcTagFilters=s.cloneDeep(e.tagFilters)),this._recalcNumberOfSplitLines(d.splitLinesData,l,a),h.resolve(d)}.bind(this),(function(e){h.reject(e)}))}.bind(this)).done(),h.promise},_allowedFilterSettings:["hide","only","allow","ignore"],_specialTagFilters:l,remove:function(){},_getSingleFragmentResults:function(r){var a=t.defer(),l={locale:this.searchServiceSuggestOptions.locale,prefix:r.prefix,limit:r.numFragmentsToRequest},o=i.format({protocol:"https",host:this.searchServiceSuggestOptions.host,pathname:this.searchServiceSuggestOptions.pathPrefix,query:l});return e.ajax({type:"GET",url:o,headers:{"X-Api-Key":this.searchServiceSuggestOptions.apiKey,Accept:"application/hal+json"},success:function(e,t,r){e.length&&(e=s.uniqBy(e,(function(e){return e.toLowerCase()}))),a.resolve(e)}.bind(this),error:function(e,s,t){window.marvel.logger.error("[SearchView] Errored out while attempting to get suggestion: ["+e.status+"]",e.responseJSON||e.responseText||t),a.reject(e)}.bind(this)}),a.promise},getCpPrefixData:function(e,s){return this._getCpPrefixDataFromService(e,s)}})}.apply(s,r))||(e.exports=i)},554:function(e,s){},555:function(e,s){},889:function(e,s){e.exports='{{#inVbSearchHeader}}\n<div class="vb-search-header-background"></div>\n<button class="npw-visual-browse-header-back-arrow{{#backArrowText}} has-text{{/backArrowText}}" title="{{backArrowText}}" data-auto="npwfu-close-btn">{{backArrowText}}</button>\n<div class="vb-search-header-short-v-filler"></div>\n{{#showFavoritesInHeader}}\n<div class="npw-visual-browser-header-favorites" data-id="favorites">{{npw-vg-search-results-header-button-favorites}}</div>\n{{/showFavoritesInHeader}}\n<div class="npw-visual-browse-header-create-new-dropdown">\n</div>\n<div class="npw-visual-browse-header-create-new-dropdown-v-spacer"></div>\n{{#formatFilters}}\n{{#filtersInHeader}}\n<div class="vb-search-header-filters-background in-header {{#filtersInHeaderCss}}{{.}}{{/filtersInHeaderCss}}">\n<div class="vb-search-header-formats">\n{{#format}}\n{{^hide}}\n{{^sep}}\n<div class="vb-search-header-formats-format{{#selected}} selected{{/selected}}" data-id="{{id}}" data-app="{{#app}}{{.}}{{/app}}">{{label}}</div>\n{{/sep}}\n{{#sep}}\n<div class="vb-search-header-formats-format-sep">|</div>\n{{/sep}}\n{{/hide}}\n{{/format}}\n</div>\n</div>\n{{/filtersInHeader}}\n{{/formatFilters}}\n{{/inVbSearchHeader}}\n<div class="search-results-grid-view-holder hide {{#searchViewInContainer}} search-view-in-container search-view-common{{/searchViewInContainer}}" data-auto="search-results-grid-holder"></div>\n<div class="search-view hide{{^inMainSearchHeader}}{{#inVbSearchHeader}} in-vb-search-header{{/inVbSearchHeader}}{{/inMainSearchHeader}}{{#inMainSearchHeader}} in-main-search-header{{/inMainSearchHeader}}{{#searchViewInContainer}} search-view-in-container{{/searchViewInContainer}}{{#searchViewInHeader}} search-view-in-header{{/searchViewInHeader}}{{#searchViewBarOnly}} search-view-bar-only{{/searchViewBarOnly}}{{#searchParentHeightControl}} search-view-parent-height-control{{/searchParentHeightControl}}">\n    <div class="search-overlay hide" data-auto="search-view-search-overlay"></div>\n    <div class="search-top-container{{#formatFilters.filtersUnderScrollingSearch}} filters-in-search-top-container{{/formatFilters.filtersUnderScrollingSearch}}">\n        {{^searchViewNoBackground}}\n        <div class="search-bg-underlay{{#showUnderlay}} showing{{/showUnderlay}}"></div>\n        {{/searchViewNoBackground}}\n        <div class="search-bar{{#searchViewBarHasButton}} show-search-button{{/searchViewBarHasButton}}">\n            <div class="search-input-holder">\n                <div class="search-button" type="text" data-auto="search-view-search-input-search-button"></div>\n                <input class="search-input" placeholder="{{placeholder}}{{^placeholder}}{{npw-search-field-placeholder}}{{/placeholder}}" id="search-view-search-input" type="text" data-auto="search-view-search-input" autocomplete="off">\n                <div class="search-clear disabled" type="text" data-auto="search-view-search-input-search-button"></div>\n            </div>\n            <div class="search-input-tooltip-holder off">\n                <div class="search-input-tooltip">{{npw-search-input-tooltip}}</div>\n            </div>\n            <div class="search-input-disabled hide" type="text"></div>\n            <div class="search-results hide" data-auto="search-view-results-menu"></div>\n\n        {{#formatFilters}}\n        {{#filtersUnderScrollingSearch}}\n            <div class="vb-search-header-filters-background">\n                <div class="vb-search-header-formats">\n                {{#format}}\n                {{^sep}}\n                    <div class="vb-search-header-formats-format{{#selected}} selected{{/selected}}" data-id="{{id}}"{{#app}} data-app="{{.}}"{{/app}}>{{label}}</div>\n                {{/sep}}\n                {{#sep}}\n                    <div class="vb-search-header-formats-format-sep">|</div>\n                {{/sep}}\n                {{/format}}\n                </div>\n            </div>\n        {{/filtersUnderScrollingSearch}}\n        {{/formatFilters}}\n\n        </div>\n    </div>\n</div>\n'},900:function(e,s,t){var r,i;r=[t(1),t(0),t(2),t(3),t(22),t(37),t(3048),t(3049),t(2072),t(26),t(4),t(7),t(8),t(883),t(3051),t(3057),t(106)],void 0===(i=function(e,s,t,r,i,a,l,o,n,h,c,d,u,g,p,m,v){"use strict";var f={borderSpace:20,minHeight:80,maxHeight:300,targetNumRows:2.5,rowVSpace:32,maxWidth:1600,rowHMargin:32},w=(c.cpTemplateSearchRemixFeedTag,c.cpTemplateSearchRemixPaidTag,c.cpTemplateSearchMappedTagRemixPaid),b=w.split("-")[1],_=c.cpTemplateSearchGiphyTag,x=c.cpTemplateSearchMaxStringLength;return t.View.extend({events:{"click .search-button":this._handleSearchBtnClick,"click .search-input":this._handleSearchInputBoxClick,"click .search-term-link":this._handleSearchResultClick,"click .search-results":this._handleSearchResultClick},initialize:function(e){e=s.assign({},e||{}),s.bindAll(this,s.functionsIn(this)),this._debouncedGetSearch=s.debounce(this._getSearchResults.bind(this),500),this._debouncedContainerResized=s.debounce(this._containerResized.bind(this),500),this._initSearchSuggest(e),this._initializeOptions(e),this._options.doNotRenderOnInit||(this.render(),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData))},_initializeOptions:function(e){this._options=e,this._setSearchRequestsController(this._options.SearchRequestsController),this._gridDims=s.assign({},f,e.gridDims||{}),this._options.popularSearchStrings&&this._initPopularSearchesFromStrings(this._options.popularSearchStrings),this._options.debugTagging?this._debugSettings={debugCssStr:"debug-tagging",cpAssetPathTemplate:this._options.debugTaggingAssetPathTemplate}:this._debugSettings=null,this.preferredNumSuggestedResults=s.isUndefined(this._options.preferredNumSuggestedResults)?5:this._options.preferredNumSuggestedResults||0,this.maxTotalResultLinesToDisplay=s.isUndefined(this._options.maxTotalResultLinesToDisplay)?this._options.maxTotalResultLinesToDisplay||0:10,this.maxItemsToDisplayInGroup=8,this.maxKeywordFiltersToDisplay=8,this.maxKeywordFilters=50,this.maxNumSelectedTags=this._options.maxNumSelectedTags||6,this._options.enableSearchHistory&&(this._searchHistory=this.SearchRequestsController.getMySearchHistory(this))},_setSearchRequestsController:function(e){this.SearchRequestsController=e,this._boundSearchCallbacks||(this._boundSearchCallbacks=!0,this._setSearchingForResults=this._setSearchingForResults.bind(this),this.renderCpSearchResults=this.renderCpSearchResults.bind(this)),this.SearchRequestsController.setCallbacks({setSearchingForResults:this._setSearchingForResults,renderCpSearchResults:this.renderCpSearchResults})},isProjectPage:function(){var e=window.location.pathname;return!!(e.includes("/sp/project-search")||e.includes("/sp/shared")||e.includes("/sp/recents")||e.includes("/sp/projects")||e.includes("/sp/folders"))},doInitialRender:function(e){e&&(this._options.el=e,this.setElement(e)),this.render(),this._nextInitialRenderIsUpdate?(this.searchResultsGridView&&this._reapplyGridViewInitOptions(),this._nextInitialRenderIsUpdate=!1,this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered&&this.triggerAutoSearch(this._options.autoSearch)):this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData)},updateOptions:function(t){if(t.SearchRequestsController&&t.SearchRequestsController!==this.SearchRequestsController&&this._setSearchRequestsController(t.SearchRequestsController),t.reset){var r=s.assign({},t);delete r.reset,this._initializeOptions(r)}else s.assign(this._options,t);this._eventsBoundEl$&&(s.each(this._eventsBoundEl$.children(),(function(s){e(s).remove()})),this._eventsBoundEl$=null),this._options.doNotRenderOnInit?(this._nextInitialRenderIsUpdate=!0,this.searchResultsGridView&&(this._reapplyGridViewInitOptionsOnNextResults=!0)):(this.setElement(t.el),this.render(),this.searchResultsGridView&&this._reapplyGridViewInitOptions(),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData))},_initSearchSuggest:function(e){var s={MAX_TEMPLATE_SEARCH_STRING_LENGTH:c.cpTemplateSearchMaxStringLength,MAX_TEMPLATE_SEARCH_TERMS:c.cpTemplateSearchMaxSearchTerms,REMIX_PAID_MAP_TAG:c.cpTemplateSearchMappedTagRemixPaid,GIPHY_TAG:c.cpTemplateSearchGiphyTag,searchServiceSuggestOptions:e.searchServiceSuggestOptions,SearchRequestsController:e.SearchRequestsController};this._searchSuggest=new m(s)},_getAllAsCatSearch:function(e){var s={label:"All",labelG11n:u.getString("npw-vb-search-box-cat-all"),commandType:"searchAll"};return this._updateLineDataWithApp(s,e,!0),s},_getAllPremiumAsCatSearch:function(e){var s={label:b,labelG11n:u.getString("npw-vb-search-box-cat-all-premium"),commandType:"searchAllPremium"};return this._updateLineDataWithApp(s,e,!0),s},_initPopularSearchesFromStrings:function(e){var t=e.length-1;this.popularSearches=[],this.popularCategories=[];var r=e.categories;e=e.searchStrings,s.each(e,function(e,r){var i=[],a=[];s.each(e.tags,(function(e){i.push(e),a.push(e.substring(e.indexOf("-")+1))}));var l=a.join(" "),o=u.getString("npw-vb-search-box-popular-translation-"+a.join("-")),n=o||l,h={tags:i.join(":"),label:n,srcLabel:l};e.app&&this._updateLineDataWithApp(h,e.app),r===t&&(h.last=!0),this.popularSearches.push(h)}.bind(this)),s.each(r,function(e,s){var r=e.split("-")[1],i={tags:e,keywords:r,labelG11n:u.getString("npw-vb-search-box-category-"+r)||r,label:r};s===t&&(i.last=!0),this.popularCategories.push(i)}.bind(this))},_trackEvent:function(e,s){d.trackEvent(e,s||{},this._getAnalyticsPage())},_getAnalyticsPage:function(){var e=(this._options.context||"npw")+":search";return this._showingCpResults&&(e+="ResultsGrid"),e},_handleSearchBtnClick:function(e){this._handleKeyUp(e)},_setShowingResults:function(){this.$el.addClass("showing-results-grid"),this._showingCpResults=!0},_hideCpSearchResults:function(){this._showingCpResults=!1,this.$el.removeClass("showing-results-grid"),this._options.showFormatFilters&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.removeClass("hide-formats"),this.searchResultsGridView&&this.searchResultsGridView.hide(),this.hideTextForFieldIfNeeded()},hideTextForFieldIfNeeded:function(){this._options.showPlaceholderIfNotShowingResultsGrid&&!this._showingCpResults&&(this._restoreTextOnClick={text:this._$searchInput.val()},this._$searchInput.val(""),this._calcPlaceholderText(),this._setPlaceholderAttr({unfocused:!0}))},reshowForFieldOnly:function(){this._$searchInput.val(this._restoreTextOnClick.text),this._restoreTextOnClick=null},returningToHome:function(){this._showingCpResults&&(this._hideCpSearchResults(),this.setBackText())},_handleBrowseHeaderBackArrow:function(e){var t={showingCpResults:!(!this._showingCpResults||!this.searchResultsGridView),currentSearch:s.clone(this.SearchRequestsController.getCurrentSearch()),filters:this._searchFilters.current,searchFieldStr:this._$searchInput.val().trim(),searchView:this};this.searchResultsGridView&&this.searchResultsGridView._showingDetail?this.searchResultsGridView.closeDetail():this._options.backArrowClickHandler?this._options.backArrowClickHandler(e,t).then(function(){t.showingCpResults&&(this._hideCpSearchResults(),this.setBackText(null,{hidingResults:!0}))}.bind(this)):this._showingCpResults&&(this._hideCpSearchResults(),this.setBackText(null,{hidingResults:!0}))},_getCleanedSearchInput:function(e){if((e=("string"==typeof e?e:this._$searchInput.val()).replace(/\+/g," ").replace(/  +/g," ").trim()).length&&e.length>x){var s=e.substring(0,x);if(" "!==e[x]){var t=s.lastIndexOf(" ");-1!==t&&(s=s.substring(0,t))}e=s}return e},_handleReturnPressedForArrows:function(e){e.stopImmediatePropagation(),e.preventDefault();var s=this._getSelectedLine();if(this._waitingForInputParseReturn=null,this._doesInputFieldMatchBoxResults())this._handleSearchResultClick(null,s.line$,{selType:s.selType,fromArrowReturn:!0});else if(!s.line$||"returnField"===s.selType){if("returnField"===s.selType)return void this._handleSearchResultClick(null,s.line$,{selType:s.selType,fromArrowReturn:!0});this._waitingForInputParseReturn={text:this._getCleanedSearchInput().toLowerCase()}}},_getSelectedLine:function(){var s=this._arrowPresses.selectedLine$,t=s&&"lineReturn";return s||(t="returnField",s=e('<div class="empty-line search-result-line-can-arrow-nav"/>')),{selType:t,line$:s}},_handleArrowKeyPressed:function(e){if(this._arrowPresses.enabled){e.stopImmediatePropagation(),e.preventDefault();var s=e.keyCode===i.DOM_VK_UP;if(!this._arrowPresses.pressesSinceReset){var t=this._$searchInput.val();t!==this._arrowPresses.searchStr&&(this._arrowPresses.searchStr=t)}this._arrowPresses.pressesSinceReset++,this._incSelectedLine(s?-1:1)}},_getFirstGoodLine:function(){var s=this._$searchResults.find(".search-result-result-line");return s.length&&e(s[0])},_incSelectedLine:function(s){if(!this._arrowPresses.numLines)return!1;var t=this._arrowPresses.lineIndex+s;if(t>=this._arrowPresses.numLines?t=-1:t<-1&&(t=this._arrowPresses.numLines-1),t!=this._arrowPresses.lineIndex)if(this._arrowPresses.selectedLine$&&this._arrowPresses.selectedLine$.removeClass("arrow-selected"),this._arrowPresses.lineIndex=t,-1!==t){if(this._arrowPresses.selectedLine$=e(this._arrowPresses.lines$[t]),this._arrowPresses.selectedLine$.addClass("arrow-selected"),this._arrowPresses.selectedLine$.hasClass("search-add-text-tag")){if(!this._arrowPresses.selectedLine$.hasClass("show-more-tags-btn")){this._arrowPresses.hasCachedAddText||(this._arrowPresses.hasCachedAddText=!0,this._arrowPresses.cachedAddText=this._arrowPresses.searchStr);var r=this._arrowPresses.selectedLine$.data("text");this._setSearchInput(this._arrowPresses.cachedAddText+" "+r)}}else if(!this._arrowPresses.selectedLine$.hasClass("search-result-result-line-all")){var i=this._arrowPresses.selectedLine$.data("label");if(!i)i=this._arrowPresses.selectedLine$.data("keywords").split(":").join(" ");this._setSearchInput(i)}}else this._arrowPresses.selectedLine$=null,this._setSearchInput(this._arrowPresses.searchStr)},_handleKeyDown:function(e){this._debouncedGetSearch.cancel(),this._cancelCurrentGetSearchResults(),e.keyCode!==i.DOM_VK_UP&&e.keyCode!==i.DOM_VK_DOWN||e.preventDefault()},_recalculateSearchButtonActive:function(e){var s=!0;return(s=""!==(e=this._getCleanedSearchInput(e)))?this._$searchButton.addClass("active"):this._$searchButton.removeClass("active"),s},_handleKeyUp:function(t){var r=this._$searchInput.val().trim();if(r.length?this._$searchClear.removeClass("disabled"):this._$searchClear.addClass("disabled"),e(t.currentTarget).hasClass("search-button"))this._$searchResults.hasClass("hide")?(this._waitingForInputParseReturn={text:this._getCleanedSearchInput().toLowerCase()},this._handleInputFocusOrClearX({fromContext:"fromSearchBtn"})):(this._trackEvent("NPWSearchClickedSearchBtn",{searchTerm:r}),r.length&&this._arrowPresses.enabled&&this._handleReturnPressedForArrows(t));else if(t.keyCode==i.DOM_VK_RETURN){if(this._arrowPresses.lastTagKeydownEventTime&&t.timeStamp-this._arrowPresses.lastTagKeydownEventTime<500)return void(this._arrowPresses.lastTagKeydownEventTime=0);if(this._trackEvent("NPWSearchPressedReturnKey",{searchTerm:r}),this.isProjectPage())return void(r&&s.trim(r).length>0&&window.marvel.navigate("project-search?q="+r,{trigger:!0}));this._arrowPresses.enabled&&this._handleReturnPressedForArrows(t)}else if(t.keyCode==i.DOM_VK_ESCAPE)this._trackEvent("NPWSearchPressedEscKey",{searchTerm:r}),this._clearSearchResults({hideOverlay:!0});else if(t.keyCode===i.DOM_VK_UP||t.keyCode===i.DOM_VK_DOWN)this._handleArrowKeyPressed(t);else if(t.keyCode!==i.DOM_VK_LEFT&&t.keyCode!==i.DOM_VK_RIGHT){if(this.isProjectPage())return;this._recalculateSearchButtonActive(r),this._debouncedGetSearch(t,null,{ifDifferentThanLast:!0,keyWasSpace:t.keyCode===i.DOM_VK_SPACE}),this._arrowPresses.enabled&&(this._arrowPresses.hasCachedAddText=!1)}},_getLinesFromServerData:function(e){if(!e.mustacheData)if(e.splitLinesData){var t=e.splitLinesData.textLines.concat(e.splitLinesData.suggestionLines||[]);s.each(t,function(e){var t,r=[];r=e.keysArray,t=s.map(e.tagsData,(function(e){return e.tag||e})),e.keywords=r.join(":"),e.tags=t.length&&t.join(":")||"",(this._options.debugTagging||this._options.showNumbersInLines)&&(e.showAnyCounts=!0)}.bind(this)),e.mustacheData={textLines:e.splitLinesData.textLines,suggestionLines:e.splitLinesData.suggestionLines,tagLinesGroups:e.tagLinesGroups,selectedTags:e.selectedTags&&s.cloneDeep(e.selectedTags)}}else e.mustacheData={lines:[]};return e.mustacheData},_updateLineDataWithApp:function(e,s,t){if(this._options.searchHistoryAppSpecific){"object"==typeof s&&(s=s.typeName);var r=g.getFormatInfo(s);r?(e.app=r.type,e.appLabel=r.formatLabel):t||window.marvel.logger.debug("bad app id for search line:"+s,e)}},_searchHistoryForBox:function(e){var s={searches:[]};if(this._searchHistory&&this._searchHistory.searches.length){e=Math.min(e,this._searchHistory.searches.length);for(var t=0;t<e;t++){var r=this._searchHistory.searches[t],i={label:r.s};r.k&&(i.keywords=r.k.join(":")),r.t&&(i.tags=r.t.join(":")),r.app&&this._updateLineDataWithApp(i,r.app),s.searches.push(i)}}return s.numSearches=s.searches.length,s},_doesInputFieldMatchBoxResults:function(){return void 0!==this._lastDisplayedSearchBoxInput&&(!!this._arrowPresses.pressesSinceReset||this._$searchInput.val().trim().toLowerCase()===this._lastDisplayedSearchBoxInput.toLowerCase())},_lastDisplayedSearchBoxInput:void 0,_makeResultBoxFromNoSearchResults:function(e,t){this._$searchResults.empty();var r=this._searchHistoryForBox(5),i={searches:this.popularSearches},a=this.popularCategories;if(a){var n=[this._getAllAsCatSearch(this._searchFilters.current.format.app||"")];this._options.allowPremiumTemplates&&n.push(this._getAllPremiumAsCatSearch(this._searchFilters.current.format.app||"")),a=n.concat(a)}var h=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.templateOptions&&this._lastShownResultBoxSettings.templateOptions.selectedTags;h&&!h.items&&(h=null);var c={showPopular:i,showCategorySearches:!!a,categorySearches:a,historySearches:r.numSearches&&r,selectedTags:this._searchSuggest.getSelectedTagsForNoResults(t,h),fromNoResults:!0};this._extendDebugSettingsToTemplateSettings(c),this._$searchResults.html(u.mustacheRender(l,c,{lineLabels:o})),this._lastShownResultBoxSettings=s.assign({},this._lastShownResultBoxSettings,{searchInput:e,templateOptions:c,options:this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options||{}}),this._trackEvent("NPWSearchTermsResultsShown",{searchTerm:e,context:"noSearchResults"}),this._showSearchResults(e),this._focusInputIgnoreEvent()},_focusInputIgnoreEvent:function(){this._ignoreNextFocus=!0,this._$searchInput.focus()},_makeResultBoxFromSearchData:function(e,t){t=t||{};var r,i=this._getCleanedSearchInput(e).toLowerCase().split(" "),a=1===i.length&&""===i[0],n=!t.doNotShow;this._lastDisplayedSearchBoxInput=e,t.resultsFromServer?r=this._getLinesFromServerData(t.resultsFromServer):a?r={lines:[]}:(window.marvel.logger.debug("called _makeResultBoxFromSearchData with bad options",{options:t,searchInput:e}),r={lines:[]}),this._$searchResults.empty();var h=0;r.lines?h=r.lines.length:(r.suggestionLines&&(h+=r.suggestionLines.length),r.textLines&&(h+=r.textLines.length));var c=this._searchHistoryForBox(5),d=!h&&{searches:this.popularSearches},g=!h&&this.popularCategories;if(g){var p=[this._getAllAsCatSearch(this._searchFilters.current.format.app||"")];this._options.allowPremiumTemplates&&p.push(this._getAllPremiumAsCatSearch(this._searchFilters.current.format.app||"")),g=p.concat(g)}n&&0===h&&(e?this._trackEvent("NPWSearchTermsYieldedZeroResults",{searchTerm:e}):this._trackEvent("NPWSearchDefaultSuggestionBoxShown",{searchTerm:"searchTerm:none"}));var m={tagLinesGroups:r.tagLinesGroups,selectedTags:r.selectedTags,numResults:h,showPopular:d,showCategorySearches:!!g,categorySearches:g,historySearches:c.numSearches&&c,fromNoResults:!1};if(r.textLines||r.suggestionLines?(m.textLines=r.textLines,m.hasTextLines=m.textLines&&m.textLines.length,m.suggestionLines=r.suggestionLines,m.hasSuggestionLines=m.suggestionLines&&m.suggestionLines.length,m.hasTextOrSuggestionLines=m.hasTextLines||m.hasSuggestionLines):m.tagLines=r.lines&&r.lines.length&&r.lines,this._extendDebugSettingsToTemplateSettings(m),this._$searchResults.html(u.mustacheRender(l,m,{lineLabels:o})),n){var v=t.fromContext;v||(window.marvel.logger.warn("unknown context in _makeResultBoxFromSearchData",{searchInput:e,options:t}),v="unknownContext"),this._trackEvent("NPWSearchTermsResultsShown",{searchTerm:e,context:v});var f="fromFocus"===v&&this._$searchResults.hasClass("hide");this._showSearchResults(e),f&&this._scrollResults(0)}if(this._lastShownResultBoxSettings={searchInput:e,options:s.cloneDeep(t),templateOptions:m},this._waitingForInputParseReturn){if(this._waitingForInputParseReturn.text===this._lastDisplayedSearchBoxInput){var w=this._getFirstGoodLine();w&&this._handleSearchResultClick(null,w,{selType:"returnFieldDelayed"})}this._waitingForInputParseReturn=null}},_extendDebugSettingsToTemplateSettings:function(e){this._debugSettings&&(e.debugCssStr=this._debugSettings.debugCssStr)},_searchStringFromResultLine:function(e,s){if("noResultLineCategory"===s)return"";var t=e.data("label");return t||(e.hasClass("search-results-tag-button")?this._$searchInput.val():(e.data("keywords")||"").split(":").join(" "))},_setSearchInput:function(e){e=e||"",this._$searchInput.val(e),e.length?this._$searchClear.removeClass("disabled"):this._$searchClear.addClass("disabled"),this._recalculateSearchButtonActive(e)},_tagsAboveResultsEnabled:function(){return this._gridDims&&!this._gridDims.hideTagsAboveResults},_handleSearchResultClickClear:function(s){s.stopImmediatePropagation(),s.preventDefault(),this._handleClearFiltersClick(e(s.target))},_handleSearchResultClick:function(t,r,i){if(i=i||{},t&&(t.stopImmediatePropagation(),r=r||e(t.currentTarget)),r.hasClass("search-add-text-tag"))this.searchAddTextTagClicked(r,i);else{var a=i.fromTag,l=i.selType||"lineClick";if(this._inputTextOnFocus=void 0,r.hasClass("search-result-line-can-arrow-nav")||a){var o,n=this._$searchInput.val().trim(),c=r.data("tags"),d=r.data("keywords"),g=r.data("app"),p=r.data("command-type"),m=("searchAll"===p||"searchAllPremium"===p)&&p,v=r.data("use-case")||r.data("src-label")||r.data("label")||r.text();g&&(o=h.getAppByType(g)),!o&&this._searchFilters.current.format.app&&(o=h.getAppByType(this._searchFilters.current.format.app));var f,w,b,_="NPWSearchSelectedSuggestedResultLine",x=!0,y=!1;r.hasClass("search-result-result-line")?f="resultLine":r.hasClass("search-result-search-suggest-line-user-text")?(f="resultSuggestLine",w=!0):r.hasClass("search-result-search-suggest-line-history")?f="noResultLineHistory":r.hasClass("search-result-search-suggest-line-popular-category")?(f="noResultLineCategory",w=!0,b=c&&c.length&&c.split(":")):r.hasClass("search-result-search-suggest-line-popular-search")?f="noResultLinePopularTerm":r.hasClass("search-results-tag-button")?f=r.hasClass("search-results-selected-tag")?"resultSelectedTag":"resultSuggestedTag":r.hasClass("empty-line")&&(x=!0,y=!0,f="userStr"),x&&!this._options.allowFieldDefault&&0===l.indexOf("returnField")&&r.find(".search-result-result-line-span-hint").length&&(x=!1),x||(_="NPWVisualBrowseTemplateFieldReturnIgnored");var S=y?n:!m&&this._searchStringFromResultLine(r,f)||"",k=((y?n:this._arrowPresses.searchStr)||"").trim(),C={searchTerm:k,contextualData1:"userSearchStr:"+k,contextualData2:"searchStr:"+S,contextualData4:"suggestedTerms:"+v,type:f,trigger:l};if(o&&(C.sparkFormat=o.typeName),this._trackEvent(_,C),x){this._debouncedGetSearch.cancel(),C.type=f,m||""!==S||b||(m="searchAll");var T,R={findAllType:m,commandType:p,searchString:S,addHistory:!p,app:o};if(!w){var F=this._getLastResultsFromServer(),I=!this._$searchResults.hasClass("hide")&&F&&F.srcTagFilters;I?R.tagFilters=I:this._currentSelectedTags&&this._currentSelectedTags.length&&(R.tagFilters=this._currentSelectedTags)}if(!m&&!a){this._options.keysForTags&&c&&!b&&(d?c=null:(d=s.map(c.split(":"),(function(e){return c.split("-")[1]})).join(":"),c=null));var A="returnFieldDelayed"!==l;if(b)R.tagFilters=s.map(b,(function(e){var s=e.split("-").slice(1).join("-");return{assets:[],id:e,tag:e,key:s,keyword:s,tags:[e],selected:!0,label:u.getString("npw-vb-search-box-category-"+s),needsLabel:!0}})),c=null;else if(c){if(R.tags=c.split(":"),A){var D=s.map(R.tags,(function(e){return e.substring(e.indexOf("-")+1)}));this._getSearchResults(null,D.join(" "),{doNotShow:!0})}}else if(d)R.keywords=d.split(":"),A&&this._getSearchResults(null,R.keywords.join(" "),{doNotShow:!0});else if(y)R.keywords=S.split(" ");else{var P=r.data("label");if(!P)return void window.marvel.logger.debug("no data in search line:"+r.text(),r);R.keywords=P.split(" ")}}this._setSearchInput(R.searchString),"header"===this._options.context&&(T=this._options.SearchController.getHeaderBackInfo()),this.setBackText(T),R.analyticsData=C,R.backInfo=T,this._options.asHeader||this._options.editorApp?this.SearchRequestsController.isSearchDifferent(R)||!this.searchResultsGridView?this._getTemplateResults(R):0===this._numResultsLastSearch?this._makeResultBoxFromNoSearchResults(R.searchString,R.tagFilters):(this._blurFieldAndHideResults(),this._setShowingResults(),this._reapplyGridViewInitOptionsOnNextResults&&(this._reapplyGridViewInitOptionsOnNextResults=!1,this._reapplyGridViewInitOptions()),this.searchResultsGridView.render({isReRender:!0})):this._getTemplateResults(R)}}}},_cancelCurrentGetSearchResults:function(){this._currentGetSearchResultsCancellableObj&&(this._currentGetSearchResultsCancellableObj.cancel=!0,this._currentGetSearchResultsCancellableObj=null)},_sendAddTextTagClickedAnalytic:function(e,s){var t=s.inputText,r=s.newText,i=s.selType,a={searchTerm:t,contextualData2:"searchStr:"+r,contextualData4:"suggestedTerms:"+(e.data("src-key")||e.data("id")),type:"noResultLineAddText",trigger:i||"lineClick"};this._trackEvent("NPWSearchSelectedSuggestedResultLine",a)},searchAddTextTagClicked:function(e,t){if(e.hasClass("show-more-tags-btn")){var r;this._$searchResults.find(".search-add-text-tag.if-showing-all").addClass("show-more-tags-tags search-result-line-can-arrow-nav"),e.addClass("hide").removeClass("search-result-line-can-arrow-nav"),t.fromArrowReturn&&(r=this._arrowPresses.lineIndex);var i=this._arrowPresses.hasCachedAddText?this._arrowPresses.cachedAddText:this._arrowPresses.searchStr;return this._resetArrowNav(!0,i),void(t.fromArrowReturn&&(this._arrowPresses.lineIndex=r-1,this._incSelectedLine(1)))}var a=e.data("text"),l=this._$searchInput.val(),o="";(e.addClass("hide").removeClass("search-result-line-can-arrow-nav"),t.fromArrowReturn)?o=l:o=-1===l.toLowerCase().split(" ").indexOf(a.toLowerCase())?l.trim()+" "+a:l.trim();this._resetArrowNav(!0,o),this._$searchInput.val(o),this._focusInputIgnoreEvent(),t=s.assign({},t,{newText:o,inputText:l}),this._sendAddTextTagClickedAnalytic(e,t)},_handleClearFiltersClick:function(e){var t=this._lastShownResultBoxSettings.options.resultsFromServer.srcTagFilters;t||(t=[],this._lastShownResultBoxSettings.options.resultsFromServer.srcTagFilters=t),t.splice(0);var r=this._lastShownResultBoxSettings.options.resultsFromServer.mustacheData.selectedTags;s.each(r.items,(function(e){e.selected=!1})),e.parent().find(".search-result-group-line-tag").removeClass("selected"),this._setClearAllFiltersButtonEnabled(!1),this._focusInputIgnoreEvent()},_setClearAllFiltersButtonEnabled:function(e){this._$clearAllFiltersButton=this._$searchResults.find(".search-box-filters-clear-all"),e?(this._$clearAllFiltersButton.addClass("enabled"),this._$clearAllFiltersButton.prop("disabled","")):(this._$clearAllFiltersButton.removeClass("enabled"),this._$clearAllFiltersButton.prop("disabled",!0))},_getLastResultsFromServer:function(){return this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options&&this._lastShownResultBoxSettings.options.resultsFromServer},_setAtMaxSelectedTagsForSelect:function(e,s){e.maxNumSelectedTags&&(s.selected?e.numMaxTagsSelected++:e.numMaxTagsSelected--,e.atMaxTags=e.numMaxTagsSelected>=e.maxNumSelectedTags,e.atMaxTags?this._$searchResults.find(".search-result-group-line-tags-tags").addClass("at-max-tags"):this._$searchResults.find(".search-result-group-line-tags-tags").removeClass("at-max-tags"))},searchResultSelectedTagClicked:function(e){var t,r=this._getLastResultsFromServer();if(r){(t=r.srcTagFilters)||(t=[],r.srcTagFilters=t);var i=e.data("src-key")+"",a=r.mustacheData.selectedTags,l=s.find(a.items,(function(e){return e.srcKey===i}));if(l){var o=l.isPremium||l.aggTag&&l.aggTag.isPremium,n=-1,h=s.find(t,(function(e,s){if(e.srcKey===i)return n=s,!0}));l.selected?(l.selected=!1,e.removeClass("selected"),-1!==n&&t.splice(n,1)):!a.atMaxTags||o?(l.selected=!0,e.addClass("selected"),h||t.push(l.aggTag)):l=null,l&&!o&&this._setAtMaxSelectedTagsForSelect(a,l)}}else window.marvel.logger.warn("[SearchView] null lastResultsFromServer in searchResultSelectedTagClicked",this._lastShownResultBoxSettings),t=[];this._setClearAllFiltersButtonEnabled(t.length>0),this._focusInputIgnoreEvent()},_getSearchResults:function(e,t,r){var i={},a=!this._$searchResults.hasClass("hide")&&this._lastShownResultBoxSettings;this._currentGetSearchResultsCancellableObj&&(this._currentGetSearchResultsCancellableObj.cancel=!0),this._currentGetSearchResultsCancellableObj=i,r=r||{};var l=t;l||(l=this._$searchInput.val()),this._debouncedGetSearch.cancel();var o=r.keyWasSpace&&this._searchSuggest.suggestAggsOnSpace();if(o&&this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options&&this._lastShownResultBoxSettings.options.keyWasSpace&&(o=!1),l=this._getCleanedSearchInput(l),r.ifDifferentThanLast){var n=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.searchInput||"";if(l===n&&!o)return;delete r.ifDifferentThanLast}var h,c=r.fromContext;h=r.tagFilters?r.tagFilters:a&&a.options&&a.options.resultsFromServer?a.options.resultsFromServer.srcTagFilters:this._currentSelectedTags,e&&(c="fromKeyUp");var d={prefix:l,tagFilters:h,spaceAggsRecalc:o};d.keysForTags=this._options.keysForTags,this._options.searchPageAndVideoAsRelated?d.app="post":d.app=this._searchFilters.current.format.app,d.preferredNumSuggestedResults=this.preferredNumSuggestedResults,d.maxTotalResultLinesToDisplay=this.maxTotalResultLinesToDisplay,d.maxItemsToDisplayInGroup=this.maxItemsToDisplayInGroup,d.maxKeywordFiltersToDisplay=this.maxKeywordFiltersToDisplay,d.maxKeywordFilters=this.maxKeywordFilters,d.maxNumSelectedTags=this.maxNumSelectedTags,d.showOnlySelectedKeywordFilters=!this._tagsAboveResultsEnabled(),d.lastSearchResults=this._lastRenderedResults&&this._lastRenderedResults.results,d.debug=!!this._debugSettings,this._options.allowPremiumTemplates&&(d[w]="allow"),this._options.allowGiphyTemplates&&(d[_]="allow"),this._searchSuggest.getCpPrefixData(d,i).then(function(e){this._currentGetSearchResultsCancellableObj===i&&(this._currentGetSearchResultsCancellableObj=null,i.cancel||e.cancelled||this._makeResultBoxFromSearchData(l,s.assign({resultsFromServer:e,fromContext:c},r)))}.bind(this),(function(e){window.marvel.logger.warn("[SearchView] getCpPrefixData rejected:",e)}))},_handleSearchInputBoxClick:function(){this._trackEvent("NPWSearchBoxClicked",{}),this._setPlaceholderAttr({clear:!0})},setViewHeight:function(e){this._$searchView.css("height",e)},_handleInputFocusOrClearX:function(e){this._setPlaceholderAttr({remove:!0});var t,r,i=this._$searchInput.val().trim(),a=this._lastShownResultBoxSettings&&i==this._lastShownResultBoxSettings.searchInput,l=!this._$searchResults.hasClass("hide");if(a&&this._showingCpResults){var o;this._currentSelectedTags&&this._currentSelectedTags.length&&(t=this._currentSelectedTags),r=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.templateOptions&&this._lastShownResultBoxSettings.templateOptions.selectedTags&&this._lastShownResultBoxSettings.templateOptions.selectedTags.items;var n=0;r&&(o=s.reduce(r,(function(e,s){return s.selected&&(e[s.id]=!0,n++),e}),{})),a=t&&t.length?n===t.length&&!s.find(t,(function(e){return!o[e.id]})):!n}a&&l?(this._lastShownResultBoxSettings.options.doNotShow&&(this._lastShownResultBoxSettings.options.doNotShow=!1),this._makeResultBoxFromSearchData(this._lastShownResultBoxSettings.searchInput,s.assign({},this._lastShownResultBoxSettings.options,e))):this._getSearchResults(null,null,{fromContext:e.fromContext||"fromFocus"})},_arrowPresses:{enabled:!1},_resetArrowNav:function(e,s){this._arrowPresses.lines$=this._$searchResults.find(".search-result-line-can-arrow-nav"),this._arrowPresses.numLines=this._arrowPresses.lines$.length,this._arrowPresses.lines$.removeClass("arrow-selected"),this._arrowPresses.selectedLine$=null,this._arrowPresses.lineIndex=-1,this._arrowPresses.enabled=!!e,this._arrowPresses.searchStr=s,this._arrowPresses.pressesSinceReset=0,this._arrowPresses.hasCachedAddText=!1,this._arrowPresses.cachedAddText=""},_showSearchResults:function(e){this._$searchResults.removeClass("hide"),this._$searchView.addClass("searching"),this._$searchOverlay.addClass("overlay-showing").removeClass("hide"),this._resetArrowNav(!0,e),""===e&&this._setPlaceholderAttr()},_scrollResults:function(e){e=e||0,this._$searchResults.scrollTop(e)},_hideSearchResults:function(){this._$searchResults.addClass("hide"),this._$searchOverlay.addClass("hide").removeClass("overlay-showing"),this._$searchView.removeClass("searching")},_setSearchingForResults:function(e,t){if(t=t||{},e){var r;if("searchAll"===t.commandType||this._$searchInput.width()>300){var i,a={appId:t.app&&g.getAppType(t.app)||""};if("searchAll"===t.commandType)i="npw-search-field-progress-all";else this._$searchInput.val().trim()?(i="npw-search-field-progress",a.searchString=this._$searchInput.val().trim()):i="npw-search-field-progress-all";r=u.formatMessage(i,a)}else r=this._$searchInput.val().trim();this._$searchInput.addClass("hide"),this._$searchInputDisabled.removeClass("hide"),this._$searchInputDisabled.text(r),this._$searchResults.addClass("hide"),this._$searchView.removeClass("searching"),this._$searchButton.addClass("searching"),t.noProgressOverlay||(t.opaqueProgressOverlay&&this._$searchOverlay.addClass("overlay-opaque"),this._$searchOverlay.removeClass("hide").addClass("overlay-showing"))}else this._$searchInput.removeClass("hide"),this._$searchInputDisabled.addClass("hide"),this._$searchButton.removeClass("searching"),this._$searchOverlay.removeClass("overlay-showing"),this._$searchOverlay.removeClass("overlay-opaque"),t.showImmediately?this._$searchOverlay.addClass("hide"):s.delay(function(){this._$searchOverlay.addClass("hide")}.bind(this),300),this._calcPlaceholderText(),this._setPlaceholderAttr({unfocused:!0})},_blurFieldAndHideResults:function(){this._hideSearchResults(),this._$searchInput.blur()},_cacheInputTextForFocus:function(){this._$searchOverlay.hasClass("overlay-showing")||(this._inputTextOnFocus=this._$searchInput.val())},_applyInputTextForFocus:function(){s.isUndefined(this._inputTextOnFocus)||(this._setSearchInput(this._inputTextOnFocus),this._inputTextOnFocus=void 0)},_handleClearSearchClick:function(e){this._cacheInputTextForFocus(),this._setSearchInput(""),this.isProjectPage()||(this._handleInputFocusOrClearX({fromContext:"fromClearX"}),this._focusInputIgnoreEvent())},_clearSearchResults:function(e){(e=e||{}).hideOverlay&&this._$searchOverlay.addClass("hide").removeClass("overlay-showing"),this._setPlaceholderAttr({unfocused:!e.showResultsForEmpty}),e.showResultsForEmpty?this._makeResultBoxFromSearchData("",{fromContext:e.fromContext}):(this._$searchResults.addClass("hide"),this._$searchView.removeClass("searching"))},_setPlaceholderAttr:function(e){var s=this.placeholderText||"";if((e=e||{}).clear)s="";else if(e.remove)return void this._$searchInput.removeAttr("placeholder");e.unfocused&&(s=this.unfocusedPlaceholderText),this._$tooltipHolder.addClass("off"),this.isProjectPage()&&(s=u.getString("project-search-searchbar-placeholder"),g.shouldShowProjectSearchTooltip().then(function(e){e&&setTimeout(function(){this._$tooltipHolder.removeClass("off"),g.projectSearchTooltipShown()}.bind(this),3e3)}.bind(this))),this._$searchInput.attr("placeholder",s),this._$searchInput.attr("data-placeholder",s)},_calcPlaceholderText:function(){var e=this._searchFilters.current.format&&this._searchFilters.current.format.app||"marvel",s="npw-search-field-placeholder-templates-home";if(this._$searchInput){var t=this._$searchInput.width();t&&t<=300&&(s="npw-search-field-placeholder-templates-short")}this.placeholderText=u.formatMessage(s,{appId:e,numThousands:20}),this.unfocusedPlaceholderText=this.placeholderText},render:function(){if(this._options.template){var e=this._options.templateOptions||{};if(this._options.showFormatFilters){var t=[{id:"all",app:"marvel",label:u.formatMessage("npw-vb-format-marvel",{count:2})}];if(s.each(g.getOrderedApps(),function(e){t.push({id:e.id,app:e.type,label:e.formatLabel})}.bind(this)),this._options.favoritesEnabled){var r=!!this._options.showFavoritesInHeader;r||t.push({sep:!0}),t.push({id:"favorites",label:u.formatMessage("npw-vb-format-capitalized-plural",{appId:"favorite"}),hide:!!r})}s.each(t,function(e){e.id===this._options.defaultFilters.format.id&&(e.selected=!0,this._searchFilters.current.format=e)}.bind(this)),e.formatFilters={format:t,filtersUnderScrollingSearch:this._options.filtersUnderScrollingSearch,filtersInHeader:this._options.filtersInHeader,filtersInHeaderCss:this._options.filtersInHeaderCss},this._searchFilters.formatFilters={settings:t,hideInResults:this._options.searchPageAndVideoAsRelated}}this._extendDebugSettingsToTemplateSettings(e);var i=u.mustacheRender(this._options.template,e);this.$el.html(i.toString())}if(this._$searchView=this.$el.find(".search-view").removeClass("hide"),this._$searchInput=this.$el.find(".search-input"),this._$searchInputDisabled=this.$el.find(".search-input-disabled"),this._$searchOverlay=this.$el.find(".search-overlay"),this._$searchUnderlay=this.$el.find(".search-bg-underlay"),this._$searchResults=this.$el.find(".search-results"),this._$searchBar=this.$el.find(".search-bar"),this._$searchClear=this.$el.find(".search-clear"),this._$searchButton=this.$el.find(".search-button"),this._$backArrow=this.$el.find(".npw-visual-browse-header-back-arrow"),this._$tooltipHolder=this.$el.find(".search-input-tooltip-holder"),this._bindEvents(),this.dropdown$=this._options.getDropdownElem?this._options.getDropdownElem():this._options.dropdownSelectorStr&&this.$el.find(this._options.dropdownSelectorStr),this._options.asHeader&&(this.headerBackground$=this.$el.find(".vb-search-header-background ")),this.$el.removeClass("hide"),this._calcPlaceholderText(),this._setPlaceholderAttr(),this.dropdown$&&this.dropdown$[0]&&this._createDropdownAfterRender(this.dropdown$),this._options.rerenderingSearchForNonHeaderResults){var a=this._options.rerenderingSearchForNonHeaderResults;this._options.rerenderingSearchForNonHeaderResults=null,this.SearchRequestsController.redisplayingCachedSearchResults(a),this.redisplayCachedSearchResults(a)}return this._options.containerDims&&this._sizeResultsMaxHeightForContainer(),this},_bindEvents:function(){this._eventsBoundEl$&&this._eventsBoundEl$!==this.$el&&(s.each(this._eventsBoundEl$.children(),(function(s){e(s).remove()})),this._eventsBoundEl$=null),this._eventsBoundEl$||(this._eventsBoundEl$=this.$el,this._$searchInput.keyup(this._handleKeyUp),this._$searchInput.keydown(this._handleKeyDown),this._$searchInput.focus(function(){this._$tooltipHolder.addClass("off"),this.isProjectPage()||(this._restoreTextOnClick&&this.reshowForFieldOnly(),this._ignoreNextFocus?this._ignoreNextFocus=!1:(this._cacheInputTextForFocus(),this._handleInputFocusOrClearX({fromContext:"fromFocus"})))}.bind(this)),this._$searchOverlay.click(function(){this._$searchResults.is(":focus")||(this._applyInputTextForFocus(),this._clearSearchResults({hideOverlay:!0}),this.hideTextForFieldIfNeeded())}.bind(this)),this._options.handleSearchUnderlayClicked&&this._$searchUnderlay.click(function(){this._options.handleSearchUnderlayClicked()}.bind(this)),this._$searchResults.on("click","li",this._handleSearchResultClick),this._$searchResults.on("click",".search-box-filters-clear-all",this._handleSearchResultClickClear),this._$searchResults.on("click",".search-result-group-line-tag",this._handleTagClickInSearchGroup),this._$searchResults.on("keydown",".search-result-group-line-tag, .search-box-filters-clear-all",this._handleKeydownInTagSearchGroup),this._$searchClear.on("click",this._handleClearSearchClick.bind(this)),this._$searchButton.on("click",this._handleSearchBtnClick.bind(this)),this._$backArrow.on("click",this._handleBrowseHeaderBackArrow.bind(this)),this._options.showFormatFilters&&(this._searchFilters.formatFilters.holder$=this.$el.find(".vb-search-header-filters-background"),this._searchFilters.formatFilters.divs$=this.$el.find(".vb-search-header-formats-format"),this._options.formatFiltersWillMoveToNpw||this._searchFilters.formatFilters.divs$.on("click",this._handleFormatFilterClick),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.addClass("hide-formats")),this._options.showFavoritesInHeader&&(this._$favoritesBtn=this.$el.find(".npw-visual-browser-header-favorites"),this._$favoritesBtn.on("click",this._handleFavoritesBtnClick.bind(this)))),window.marvel.events.on("sp-route-change-for-search",function(){this._setPlaceholderAttr()}.bind(this))},moveFiltersToNpwDiv:function(e){var s=this._searchFilters.formatFilters,t=s.holder$;e.append(t),s.divs$.off("click",this._handleFormatFilterClick),s.divs$.on("click",this._handleFormatFilterClick)},_createMenuItemClick:function(){},_onCreateProjectMenuOpen:function(){},_onCreateProjectMenuClose:function(){},_navigateToBrandingFromCreateProjectMenu:function(){this._options.SearchController.navigateToBrandingFromCreateProjectMenu(this)},_createDropdownAfterRender:function(e){if(this._options.searchReact){var s=this._options.searchReact;if(this.wrappedCreateMenuModel=this.wrappedCreateMenuModel||new t.Model,this.wrappedCreateMenuModel.set({userProps:this._options.userProps,context:this._options.context+":createProjectMenu",onButtonClick:this._createMenuItemClick,onOpen:this._onCreateProjectMenuOpen,onClose:this._onCreateProjectMenuClose,hideViewAll:!0,el:e,dataAuto:"search-create-project-menu",handleNavigateToBranding:this._navigateToBrandingFromCreateProjectMenu.bind(this),handleHomeCreateFromScratch:function(e,s){e&&this._options.SearchController.handleHomeCreateFromScratchInSearch(this,e,s)}.bind(this)}),!this.wrappedReactCreateProjectsMenuCls){var r=s.reactWrapper.wrapComponentSpectrum(s.CreateProjectMenu,this.wrappedCreateMenuModel);this.wrappedReactCreateProjectsMenuCls=r.extend({cachename:"reactsearchcreatefromscratch",remove:function(){r.prototype.remove.call(this)}})}this.wrappedReactCreateFromScratch?this.wrappedReactCreateFromScratch.setElement(e):(this.wrappedReactCreateFromScratch=this._renderReactView(this.wrappedReactCreateProjectsMenuCls,e,this.wrappedCreateMenuModel),this.wrappedReactCreateFromScratch.listenToModelChange()),this.wrappedReactCreateFromScratch.render()}},viewCache:{},_renderReactView:function(e,s,r){var i,a=!1,l=!0;try{e.prototype.cachename&&this.viewCache[e.prototype.cachename]?i=this.viewCache[e.prototype.cachename]:a=!0,a&&((i=Object.create(e.prototype)).el=s,e.apply(i,Array.prototype.slice.call(arguments,1)),e.prototype.cachename&&(this.viewCache[e.prototype.cachename]=i)),r&&l&&(i.model=r),l&&i.render(t.history.fragment,{})}catch(s){window.marvel.logger.warn("render exception ["+s+"], View = "+e.prototype.cachename,s)}return i},hidingVisualBrowse:function(){this._options.asHeader&&this.$el.addClass("hide")},_getSearchOptionsFromUseCase:function(e){var t,r=e.searchTags||[],i=e.searchStr||e.matchedSearchStr||"",a={assetId:e.assetId,assetIdApp:e.app};return i.length&&!r.length&&(r=i.split(" ")),r.length||(a.findAllType="searchAll"),a.findAllType?t="":-1!==r[0].indexOf("-")?(a.tags=r,a.keywords=s.map(r,(function(e,s){return e.split("-")[1]})),t=a.keywords.join(" ")):(a.keywords=r,t=r.join(" ")),{options:a,fieldSearchStr:t}},getSearchQueryFromUseCase:function(e){var s=this._getSearchOptionsFromUseCase(e),t={assetId:e.alias||e.id};return s.options.findAllType?t.all=!0:t.keys=s.options.keywords.join(" "),t},doSearchFromUseCaseInfo:function(e,t){var r=this._getSearchOptionsFromUseCase(e.useCase);this._setSearchInput(r.fieldSearchStr),r.options.findAllType||this._getSearchResults(null,r.fieldSearchStr,{doNotShow:!0}),this._options.searchPageAndVideoAsRelated?"page"!==e.useCase.app&&"video"!==e.useCase.app||(r.options.assetId=null):this._setFormatFilter(e.useCase.app),r.options.analyticsData=s.assign({useCase:e.useCase.id,sparkFormat:e.useCase.app,searchTerm:r.fieldSearchStr,trigger:"seeMore"},t||{}),this._getTemplateResults(r.options)},_getTagNamesAnalyticValForAsset:function(e){return this._options.SearchController.getTagNamesAnalyticValForAsset(e)},_sendTemplatePressedAnalytics:function(e){var s=e.asset||e.detailOptions&&e.detailOptions.asset||{};if("post"===s.app){var t="none",r=this.SearchRequestsController.getLastTemplateResultsAnalyticsTriggerCategory();e.detailOptions?t=e.detailOptions.analytics.context:e.createOptions&&(t=e.createOptions.analytics.context);var i=this._options.context;"editor:post"===i?i="editorPost":"npw"!==i&&"header"!==i||(i="search");var a={contextualData5:"tagNames:"+this._getTagNamesAnalyticValForAsset(s),contextualData6:"templateType:"+(s.isPremiumTemplate?"paid":"free"),contextualData3:"categoryName:"+r,contextualData4:"templateLocation:"+i,templateId:s.id||"none",eventAction:t};this._options.extendTemplatePressed&&this._options.extendTemplatePressed(a),this._trackEvent("templatePressed",a)}},_finishSearchAfterError:function(e){this._setSearchingForResults(!1,{showImmediately:!0}),this._numResultsLastSearch=0,this._makeResultBoxFromNoSearchResults(e.searchString,e.tagFilters),e.resultsDefer&&e.resultsDefer.resolve()},_getTemplateResults:function(e){var s=e.app||this._searchFilters.current.format.app;s&&this._options.searchPageAndVideoAsRelated&&(s=null),e.app=s,this.SearchRequestsController.getTemplateResults(e).then(function(s){var t=this._options.asHeader;s.err?this._finishSearchAfterError(e):(s.assets.length||!this._showingCpResults?this.renderCpSearchResults(s,{jumpToDetailAssetId:e.jumpToDetailAssetId,backInfo:e.backInfo}):t=!0,t&&this._setSearchingForResults(!1,{showImmediately:!0}),s.assets.length?(this._numResultsLastSearch=s.assets.length,this._blurFieldAndHideResults()):(this._numResultsLastSearch=0,this._makeResultBoxFromNoSearchResults(e.searchString,e.tagFilters)),e.resultsDefer&&e.resultsDefer.resolve())}.bind(this)).done()},createFromSearchResultsThumb:function(e,s){var t=this.SearchRequestsController.getCurrentSearch().searchStr||"";s.analytics.searchTerm=t||"searchTerm:none",this._sendTemplatePressedAnalytics({createOptions:s,asset:e}),s.analyticsPage=s.analyticsPage||this._getAnalyticsPage(),s.analyticsFullTagNames=this._getTagNamesAnalyticValForAsset(e),s.searchStr=t,this._options.defaultCreateAction?this.handleDefaultCreateFromSearchResults(e,s):this._options.handleCreateFromSearchResultsThumbClick(e,s)},handleDefaultCreateFromSearchResults:function(e,s){"confirm"===this._options.defaultCreateAction&&this._showDefautCreateConfirm(e,s)},_showDefautCreateConfirm:function(e,s){var t=[];t.push({id:"create",text:"search-results-confirm-cta-create",primary:!0}),this.showDetailConfirmForCurrentClickedThumb({asset:e,previewNavType:"side",title:"search-results-confirm-title-branded",subtitle:void 0,ctas:t,stringsAreIds:!0,cssClass:"vertical-default",analytics:{templatePreviewed:{data:{}},templatePreviewClosed:{callback:function(e,s){var t;t=s.cancelled?"cancel":s.asset.premium&&s.showUpgradeForPremium?"createNeedUpgrade":"create",e.contextualData5="action:"+t}}}}).then(function(e){e.closeDefer.resolve(),e.cta&&(s.detailRenditionInfo=e.detailRenditionInfo,this.defaultCreateFromSearchResultsThumbClick(e.asset,s))}.bind(this))},_triggeringRemix:function(e){this._options.SearchController.vbTriggeringRemixFromSearchThumb(e,this)},defaultCreateFromSearchResultsThumbClick:function(e,s){e.isPremiumTemplate&&this._options.showUpgradeForPremium?this._options.SearchController.showPremiumUpgradeModalForPremiumTemplate(e,s):(this._options.SearchController.remixFromSearchThumb(e,this,s),"header"===this._options.context&&this._hideCpSearchResults())},getCurrentSearchAnalytics:function(){return this.SearchRequestsController.getCurrentSearchAnalytics()},showDetailConfirmForCurrentClickedThumb:function(e){var s="npw"===this._options.context?"search":this._options.context;return e.analytics||(e.analytics={}),e.analytics.context=e.analytics.context||s,this.searchResultsGridView.showDetailConfirmForCurrentClickedThumb(e)},getDataForReopenRedraw:function(e){var s={isResize:!!(e=e||{}).isResize,lastRenderedResults:this._lastRenderedResults,showingCpResults:this._showingCpResults,dataToRestore:this._getDataForRestoringAfterRedraw()};return s.showingCpResults&&(s.cpResultsRedrawData=this.searchResultsGridView.getDataForRedraw()),s},loadMoreFromResultsClicked:function(e){var s={searchTerm:this.SearchRequestsController.getCurrentSearch().searchStr,type:e.isClick?"click":"scroll",loadAssets:e.pagination.lastShowing,numAssets:e.pagination.total,contextualData16:"tagSelected:"+(e.selectedTags||"NULL")},t=this.SearchRequestsController.getCurrentSearch();this._trackEvent("NPWVisualBrowseSearchLoadMoreInTemplateResults",s),t.targetTotal+=40,this.SearchRequestsController.repeatSearch({loadNext:!0,targetTotal:t.targetTotal,noProgressOverlay:!0,splitQuery:t.splitQuery,totalPulled:t.totalPulled,extraResults:t.extraResults,aggregations:t.aggregations})},assetDetailShownInResults:function(e){this._sendTemplatePressedAnalytics({detailOptions:e})},_searchFilters:{current:{format:{}}},_setFormatFilter:function(t,r){if("object"==typeof t&&(t=t.typeName),this._searchFilters.formatFilters&&this._searchFilters.formatFilters.divs$){if(r)t=r.data("app");else{var i=s.find(this._searchFilters.formatFilters.divs$,(function(s){return e(s).data("app")===t}));r=e(i)}this._searchFilters.formatFilters.divs$.removeClass("selected"),r.addClass("selected")}return this._searchFilters.current.format=this._getFilterFormatFromApp(t),this._calcPlaceholderText(),this._setPlaceholderAttr(),r},_getFilterFormatFromApp:function(e){return s.find(this._searchFilters.formatFilters.settings,function(s){return s.app==e}.bind(this))},_handleFavoritesBtnClick:function(e){this._handleFormatFilterClick(e)},_handleFormatFilterClick:function(t){var r=e(t.currentTarget),i=this._searchFilters.current.format.app,a={format:{app:r.data("app"),id:r.data("id")}};this._setFormatFilter(a.format.app,r),"favorites"===a.format.id&&(this._searchFilters.current.format.app=i),this._options.handleFilterSelectedInSearch({filter:a,showingCpResults:this._showingCpResults,currentSearch:s.cloneDeep(this.SearchRequestsController.getCurrentSearch())}).startSearchTimer&&this._filterClickWantsRepeat()},_setFilterSelectedInSearchHandler:function(e){this._options.handleFilterSelectedInSearch=e},triggerAutoSearch:function(e){var t=function(e){var s=e.searchOptions&&e.searchOptions.fallbackSearch&&e.searchOptions.fallbackSearch.triggered,t=s?s.fieldSearchStr:e.fieldSearchStr,r=s?s.isFindAll:e.searchOptions.isFindAll;this._setSearchInput(t),r||this._getSearchResults(null,t,{doNotShow:!0}),e.appInfo&&(this._options.searchPageAndVideoAsRelated||this._setFormatFilter(e.searchQuery.app))}.bind(this);this.SearchRequestsController.triggerAutoSearch(e,t).then(function(t){var r="";e.fallbackSearch&&e.fallbackSearch.triggered&&(r=e.fallbackSearch.triggered.fieldSearchStr,this._setSearchInput(e.fallbackSearch.triggered.fieldSearchStr)),t.err?(s.assign({},e,{searchString:r}),this._finishSearchAfterError(e)):this.renderCpSearchResults(t,{hideProgressWhenRendered:!0,jumpToDetailAssetId:e.jumpToDetailAssetId,backInfo:e.backInfo})}.bind(this))},restoreSearchAfterReRender:function(e){e=e||{},s.assign(this,e.dataToRestore||{});var t,r=this.SearchRequestsController.restoreSearchAfterReRender(e);r&&(t=s.isUndefined(e.searchFieldStr)?r.userStr||r.searchStr:e.searchFieldStr,this._setSearchInput(t),e.showingCpResults&&(e.lastRenderedResults.options.hideProgressWhenRendered=!0,this.renderCpSearchResults(null,null,e.lastRenderedResults)))},_tagClickWantsRepeat:function(e){this._showingCpResults&&(this.searchResultsGridView.searchTriggered(),this._getTemplateResults(e))},_filterClickWantsRepeat:function(){this._showingCpResults&&(window.marvel.logger.debug("calling _filterClickWantsRepeat while showing results"),this.searchResultsGridView.searchTriggered(),this.SearchRequestsController.repeatSearch({targetTotal:80,forceApp:{app:this._searchFilters.current.format.app}}))},_handleKeydownInTagSearchGroup:function(s){s.keyCode==i.DOM_VK_RETURN&&(s.stopImmediatePropagation(),s.preventDefault(),this._arrowPresses.lastTagKeydownEventTime=s.timeStamp,e(s.currentTarget).hasClass("search-box-filters-clear-all")?this._handleSearchResultClickClear(s):this._handleTagClickInSearchGroup(s))},_handleTagClickInSearchGroup:function(s){var t=e(s.currentTarget),r=t.hasClass("show-more-tags-btn");if(s.stopImmediatePropagation(),s.preventDefault(),r)t.parents(".search-result-group-line").addClass("show-more-tags-tags"),this._focusInputIgnoreEvent();else if(t.hasClass("search-results-selected-tag"))this.searchResultSelectedTagClicked(t);else{var i,a=this._getSelectedLine(),l=this._options.keysForTags,o=t.data("id"),n=h.getAppByType(this._searchFilters.current.format.app),c=a.line$&&a.line$.data(l?"keywords":"tags")||"",d=c&&c.split(":")||[],u=!0;if(l){var g=d.indexOf(o);-1===g?d.push(o):(d.splice(g,1),u=!1),i=d.join(" ")}else{var p=t.data("groupId")+"-"+o,m=d.indexOf(p);-1===m?d.push(p):(d.splice(m,1),u=!1),i=this.SearchRequestsController.keysStrFromTagsArray(d)}var v={searchString:i,addHistory:!0,app:n};l?v.keys=d:v.tags=d,this._getSearchResults(null,v.searchString,{doNotShow:!0}),this._setSearchInput(v.searchString),this._handleSearchResultClick(null,t,{tagId:o,fromTag:!0,selType:u?"tagAddInSearchBox":"tagRemoveInSearchBox"})}},tagClickedInResults:function(e,t){var r=this.SearchRequestsController.getCurrentSearch(),i=r&&r.searchStr||"";t=t||{};var a=this._$searchInput.val(),l=!1,o=!0,n=!s.isUndefined(t.changeSelectionValue),h=s.isUndefined(t.changeSelectionValue)?!e.selected:t.changeSelectionValue;if(this.searchResultsGridView&&this.searchResultsGridView._showingDetail&&(this.searchResultsGridView.tagClickedSinceChangingToGridDetail||(this.searchResultsGridView.tagClickedSinceChangingToGridDetail=!0)),h)e.selected=!0,this._currentSelectedTags.push(e);else{var c=-1;s.find(this._currentSelectedTags,(function(s,t){if(s.id===e.id)return c=t,!0})),e.selected=!1,-1!==c?this._currentSelectedTags.splice(c,1):o=!1}this._trackEvent("NPWVisualBrowseSearchClickedTagInTemplateResults",{contextualData17:"tagId:"+(e.srcKey||e.id),contextualData16:"tagSelected:"+t.selectedTagKeys,trigger:e.selected?"tagClickAdd":"tagClickRemove",contextualData2:"searchStr:"+i}),(o||n)&&(a=r.searchStr,l=!0,this._tagClickWantsRepeat({userStr:a,searchStr:a,searchString:a,tagFilters:this._currentSelectedTags,analyticsData:{trigger:e.selected?"tagClickAdd":"tagClickRemove",contextualData17:"tagId:"+(e.srcKey||e.id)}})),l&&this._setSearchInput(a)},setFavoriteForAsset:function(e,s){return this._options.VisualBrowseUseCasesController.applyFavoriteStateToSearchResultAsset(e,s,this.SearchRequestsController.getCurrentSearch()).then(function(s){return this._options.loggedOutPromo&&this._options.loggedOutPromo.showPromoCb({type:"favoriting",asset:e}).done(),s}.bind(this))},redisplayCachedSearchResults:function(e){this._setCurrentSelectedTagsFromResults(e.results),this._setSearchInput(this.SearchRequestsController.getCurrentSearch().searchStr),this._setFormatFilter(e.currentFilter.format.app),this.renderCpSearchResults(e.results,e.originalOptions)},_getDataForRestoringAfterRedraw:function(){return this.SearchRequestsController.getDataForRestoringAfterRedraw()},_switchHeaderViewForFirstUse:function(e,s){this._options.afterSearchFirstUse.rerenderSearchForNonHeaderResults({results:e,originalOptions:s,currentFilter:this._searchFilters.current,returnOptions:this._getDataForRestoringAfterRedraw()})},setBackText:function(e,s){var t,r,i;if(s=s||{},e)t=this._options.SearchController.getBackArrowText(e.backType),r=e.backPath,i=e.backType;else if("npw"!==this._options.context)i="home",t=this._options.SearchController.getBackArrowText(i);else{var a=!s.hidingResults;if(e=this._options.SearchController.getBackInfoFromNPWCurrentPath(null,a))i=e.backId,t=e.text,r=e.backPath;else{var l=this.SearchRequestsController.getTriggeredAutoSearchOptions();i=l&&l.backType?l.backType:this._showingCpResults?"visualBrowse":"projects",t=this._options.SearchController.getBackArrowText(i)}}this._$backArrow.text(t),this._$backArrow.attr("title",t),this._$backArrow.addClass("has-text"),this._$backArrow.data("back-id",i),this._$backArrow.data("back-path",r||"")},_setCurrentSelectedTagsFromResults:function(e){this._currentSelectedTags=e.tagFilters||[],e.tagsData.currentSelectedTags=this._currentSelectedTags},renderCpSearchResults:function(e,t,r){var i=!1;r?(i=!0,e=r.results,t=r.options,this._lastRenderedResults=r):this._lastRenderedResults={results:s.cloneDeep(e),options:s.cloneDeep(t)},this._options.asHeader||this._options.editorApp?(this._setCurrentSelectedTagsFromResults(e),this._setShowingResults(),this._options.showFormatFilters&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.addClass("hide-formats"),this.setBackText(t.backInfo),(t=s.assign({},{analytics:{context:this._options.context},gridDims:this._gridDims,showLoadMoreButton:this._options.showLoadMoreButton,tagClickHandler:this.tagClickedInResults.bind(this),loadMoreClickHandler:this.loadMoreFromResultsClicked.bind(this),assetDetailShownCallback:this.assetDetailShownInResults.bind(this),createFromThumbClickHandler:this.createFromSearchResultsThumb.bind(this),favoritesEnabled:this._options.favoritesEnabled,setFavorite:this.setFavoriteForAsset.bind(this),detailViewEnabled:this._options.detailViewEnabled||t.enableDetailView,allowPremiumTemplates:this._options.allowPremiumTemplates,showUpgradeForPremium:this._options.showUpgradeForPremium,allowGiphyTemplates:this._options.allowGiphyTemplates,backArrowTextForDetail:this._options.detailViewEnabled&&this._options.SearchController.getBackArrowText("searchResults"),hideAssetUntilLoaded:this._options.hideAssetUntilLoaded,isReRender:i,maxResultsBeforeAutoLoadFromScroll:80,assetLoadFailed:this.SearchRequestsController.assetLoadFailed,uiStrings:this._options.uiStrings,containerDims:this._options.containerDims,preDetailViewCallback:this._options.preDetailViewCallback&&this.preDetailViewCallback.bind(this),maxNumSelectedTags:this.maxNumSelectedTags,maxNumTagsInResults:this._options.maxNumTagsInGridResults||8,getTagNamesAnalyticValForAsset:this._getTagNamesAnalyticValForAsset.bind(this)},t||{},this._options.resultsOptions||{})).debugSettings=this._debugSettings,this.searchResultsGridView?this._reapplyGridViewInitOptionsOnNextResults&&(this._reapplyGridViewInitOptionsOnNextResults=!1,this._reapplyGridViewInitOptions()):this.searchResultsGridView=new p({el:this._options.resultsHolder$||this.$el.find(".search-results-grid-view-holder"),parentRerendersOnResize:this._options.parentRerendersOnResize}),this.searchResultsGridView.renderResults(e,t),t.hideProgressWhenRendered&&this._setSearchingForResults(!1,{showImmediately:i})):this._switchHeaderViewForFirstUse(e,t)},_reapplyGridViewInitOptions:function(){this.searchResultsGridView.applyNewInitOptions({el:this._options.resultsHolder$||this.$el.find(".search-results-grid-view-holder"),parentRerendersOnResize:this._options.parentRerendersOnResize})},searchViewShown:function(e){(e=e||{}).gridDims&&s.assign(this._gridDims,e.gridDims),e.containerDims&&(this._options.containerDims=s.assign(this._options.containerDims||{},e.containerDims)),this._showingCpResults&&this.searchResultsGridView.searchViewShown(e),this._sizeResultsMaxHeightForContainer(),this._calcPlaceholderText(),this._setPlaceholderAttr()},containerResized:function(e){e.isWindowResize?this._debouncedContainerResized(e):this._containerResized(e)},_sizeResultsMaxHeightForContainer:function(){var e=this._$searchInput.offset().top-this.$el.offset().top+this._$searchInput.height(),s=this._options.containerDims.height-(e+48);this._$searchResults.css("max-height",s)},_containerResized:function(e){this._options.containerDims=s.assign(this._options.containerDims||{},e.containerDims),e.gridDims&&s.assign(this._gridDims,e.gridDims),s.isUndefined(e.showUnderlay)||(e.showUnderlay?this._$searchUnderlay.addClass("showing"):this._$searchUnderlay.removeClass("showing")),this._showingCpResults&&this.searchResultsGridView.containerResized({containerDims:e.containerDims,gridDims:this._gridDims}),this._sizeResultsMaxHeightForContainer(),this._calcPlaceholderText(),this._setPlaceholderAttr()},remove:function(){return this._options.doNotEmpty||(this.$el.empty(),this.$el.addClass("hide")),this.searchResultsGridView&&(this.searchResultsGridView.remove(),this.searchResultsGridView=null),this._searchSuggest&&this._searchSuggest.remove(),this},preDetailViewCallback:function(e){var t=this._options.preDetailViewCallback(e);return s.isEqual(t.containerDims,this._options.containerDims)?{resized:!1}:(this._options.containerDims=s.assign(this._options.containerDims||{},t.containerDims),t.gridDims&&s.assign(this._gridDims,t.gridDims),{resized:!0,containerDims:this._options.containerDims,gridDims:this._gridDims})},getLocStringForEditor:function(e){return u.getString(e)}})}.apply(s,r))||(e.exports=i)},901:function(e,s,t){var r,i;r=[t(1),t(0),t(3),t(2),t(8),t(7),t(5),t(6),t(4),t(26),t(37),t(556),t(570)],void 0===(i=function(e,s,t,r,i,a,l,o,n,h,c,d,u){"use strict";var g,p=n.cpTemplateSearchRemixFeedTag,m=n.cpTemplateSearchRemixPaidTag,v=n.cpTemplateSearchMappedTagRemixPaid,f=v.split("-")[1],w=n.cpTemplateSearchGiphyTag,b=w.split("-")[1],_={thumbClick:"useCaseSearch",seeMore:"useCaseSearch"},x=r.Model.extend({initialize:function(e){g=(e=e||{}).logger||window.marvel.logger,this.setCallbacks(e.callbacks),this._initializeLists(),this._options=e||{},this.dataId=this._options.dataId,window._searchViewTemplateSearchBadAssets||(window._searchViewTemplateSearchBadAssets={count:0,ids:{}}),this._badAssets=window._searchViewTemplateSearchBadAssets,this._boundFunctions||(this._boundFunctions=!0,this.assetLoadFailed=this.assetLoadFailed.bind(this)),this._sparkContentSearchAllFields=!l.hasFeature("npw-vb-search-spark-content-search-tags-only"),this._processOneSparkContentAsset=this._processOneSparkContentAsset.bind(this),this._options.enableSearchHistory&&this._initSearchHistory(),this._initSizeFilterMaps(this._options.sizeFilterInfo)},updateOptions:function(e){},_normalizeAspectRatio:function(e){return Math.floor(1e6*e)},_aspectRatioSearchString:function(e,s){return this._aspectRatioSearchStringMinMax(e,e,s)},_aspectRatioSearchStringMinMax:function(e,s,t){return"rendition.aspectRatio:["+(e-(t=t||0))+" TO "+(s+t)+"]"},_initSizeFilterMaps:function(e){if(e&&!e.unsupported){var t=e.sizeFilterMapsJSON.maps,r={},i=this._normalizeAspectRatio(e.sizeFilterMapsJSON.sizeRangeForEquality),a=i;this._sizeFilterMaps={sizesByLowerCaseId:r},this._sizeFilterMaps.sizes=s.reduce(e.pickerInfo.sizes,function(e,s){var i=t[s.id],l={id:s.id,aspectRatio:this._normalizeAspectRatio(s.aspectRatio),_baseWidth:s.width,_baseHeight:s.height};return r[l.id.toLowerCase()]=l,i&&(l.filters=i.filters,l.str=i.str,l.sizeQueryString=this._aspectRatioSearchString(l.aspectRatio,a)),e[l.id]=l,e}.bind(this),{});var l=[],o=s.reduce(this._sizeFilterMaps.sizes,(function(e,s){var t=s.aspectRatio+"",r=e[t];return r||(r={aspectRatio:s.aspectRatio,sizes:[],sizeQueryString:s.sizeQueryString},e[t]=r,l.push(r)),r.sizes.push(s),s.aspectGroup=r,e}),{});this._sizeFilterMaps.aspectGroups=o,l.sort((function(e,s){return e.aspectRatio-s.aspectRatio})),s.each(l,(function(e,s){e.index=s}));var n=l.length;s.each(l,(function(e,s){var t,r,a=[];if(s)for(r=s-1;r>=0&&(t=l[r],e.aspectRatio-t.aspectRatio<=i);r--)a.push(t);if(s<n-2)for(r=s+1;r<n&&(t=l[r]).aspectRatio-e.aspectRatio<=i;r++)a.push(t);e.related=a})),s.each(l,function(e){if(e.related&&e.related.length){var t={min:e.aspectRatio,max:e.aspectRatio};s.reduce(e.related,(function(e,s){return s.aspectRatio<e.min?e.min=s.aspectRatio:s.aspectRatio>e.max&&(e.max=s.aspectRatio),e}),t),e.relatedSizeQueryString=this._aspectRatioSearchStringMinMax(t.min,t.max,a)}else e.relatedSizeQueryString=e.sizeQueryString}.bind(this))}else this._sizeFilterMaps=null},_initializeLists:function(){this._fieldToTagMapsNoLoc=s.clone(this._fieldToTagMaps),delete this._fieldToTagMapsNoLoc.locales,this._nonLangTagFieldIds=s.keys(this._fieldToTagMapsNoLoc),this._nonLangTagToFieldMap=s.reduce(this._fieldToTagMapsNoLoc,(function(e,s,t){return e[s]=t,e}),{});var e=s.keys(this._fieldToTagMaps);this._allFieldsToSelect=e.concat(this._nonTagFieldsToSelect)},setCallbacks:function(e){this.callbacks=s.assign(this.callbacks||{},e||{}),s.each(this.requiredCallbackNames,(function(s){e[s]||(e[s]=function(){g.debugger("send "+s+" in in setCallbacks")})}))},assetLoadFailed:function(e){this._badAssets.ids[e.id]||(this._badAssets.count++,this._badAssets.ids[e.id]=!0)},_combineResultAssets:function(e){var t=s.reduce(e,(function(e,s){return e[s.id]=s,s.matched=!1,e}),{}),r=this._assets.assetsArray;return s.each(r,(function(e,s){var i=t[e.id];i&&(i.matched=!0,r[s]=i)})),s.each(e,function(e){e.matched||r.push(e)}.bind(this)),r},_setupOneAssetRenditionFromResult:function(e,s){e.width=e.width||e.w,e.height=e.height||e.h},_assets:{assetsById:{},assetsArray:[]},_allowedTagPrefixes:["explore","spcase","spterm","spstyle","spcolor","spsize","spingred","spinfluencer","spcollect","sploc","spmap","cpat"],_addAllTagsToAsset:function(e){e.allTags||(e.tags?(e.allTags=s.map(e.tags,(function(e){var s=e.split("-"),t=s.slice(1);return{label:t.join(" "),keyword:t.join("-"),prefix:s[0],id:e}})),e.allTags.sort((function(e,s){return e.label>=s.label?1:-1}))):e.allTags=[])},_assignTagsDataToResults:function(e,t,r){var i=e.tagsData,a=t.options.tagFilters;a||(a=[]),(i=this._tagsDataFromSparkContentResults(e,a,t.options)).tagsInOrder=i.tagFilters.concat(i.tagsInOrder);var l=[],o=s.reduce(e.assets,function(t,r){var i=s.isUndefined(r.isPremiumTemplate)?-1!==r.tags.indexOf(v):r.isPremiumTemplate,a=-1!==r.tags.indexOf(w);if(i){if(!this._options.allowPremiumTemplates)return g.debug("asset in result with premium when not allowed:"+r.id,r),t;r.isPremiumTemplate=!0}if(a){if(!this._options.allowGiphyTemplates)return g.debug("asset in result with giphy when not allowed:"+r.id,r),t;r.isGiphyTemplate=!0}return r.sploc?-1===r.sploc.indexOf("sploc-")&&(r.sploc="sploc-"+r.sploc):r.sploc="sploc-en",this._setupOneAssetRenditionFromResult(r,e),"post"===r.app&&s.isUndefined(r.remixable)&&(r.remixable=!0),r.templatedImgHref?(this._addAllTagsToAsset(r),r.tagsForData=r.tags.join(":"),r._orderedIndex=l.length,l.push(r),t[r.id]=r,t):(g.debug("asset with no rendition:"+r.id,r),t)}.bind(this),{});s.assign(e,{tagsData:i,tagFilters:i.tagFilters,hiddenTagsInOrder:i.hiddenTagsInOrder,assetsById:o,assets:l})},_getTokensArrayFromQueryStr:function(e,t){var r="+";-1!==e.indexOf("%20")?r="%20":-1!==e.indexOf(" ")&&(r=" ");var i=e.split(r);return t&&(i=s.map(i,this._cleanUserStringAllowColon)),i},_getValidPctFilterStringFromValue:function(e,s){var t="";if("string"==typeof e)if(e=e.toLowerCase(),-1!==["hide","only","allow"].indexOf(e))t=e;else if(s){var r=e.split("pct:");if(2===r.length)if(1===(r=r[1].split(":")).length){var i=1*r[0];0===i?t="hide":i>0&&i<=100&&(t="pct:"+i)}else if(2===r.length){var a=1*r[0],l=1*r[1];l>0&&a>0&&l<=10&&a<=10&&(t="pct:"+a+":"+l)}}return t},getTriggeredAutoSearchOptions:function(){return this._triggeredAutoSearchOptions},_getQueryBoolean:function(e,t){return s.isUndefined(e)?t:!0===e||"true"===e},_getAPremiumTag:function(e){var t=f,r={id:t,label:i.getString("npw-vb-search-box-cat-all-premium"),key:t,keyword:t,srcKey:t,tag:v,tags:[v],isPremium:!0};return e&&s.assign(r,e),r},triggerAutoSearch:function(e,r){var i=e.trigger||e.searchQuery&&e.searchQuery.trigger||this._triggeredAutoSearchCallbackOptions&&this._triggeredAutoSearchCallbackOptions.searchQuery.trigger||"autoSearch";if(e.needsToBeTriggered=!1,e.useController)return r&&r(this._triggeredAutoSearchCallbackOptions),e.searchPromise?e.searchPromise.then((function(e){return e})):t.resolve(this._lastProcessedData);var a,l,o=[],n=[],h=e.searchQuery,c=h.app&&this._options.VisualBrowseAndSearchAppsController.getFormatInfo(h.app),d={assetId:h.assetId};if(this._triggeredAutoSearchOptions=e,h.limit){var u=1*h.limit;isNaN(u)||(u>100&&(u=100),d.limit=u),this._getQueryBoolean(h.forceLowerLimit,!1)&&(d.forceLowerLimit=!0)}if(h.filters&&(n=this._getTokensArrayFromQueryStr(h.filters,!0)),"true"===h.all)d.isFindAll=!0;else{s.isUndefined(h.tag)?s.isUndefined(h.key)?s.isUndefined(h.keys)?s.isUndefined(h.tags)||(n=this._getTokensArrayFromQueryStr(h.tags)):o=this._getTokensArrayFromQueryStr(h.keys):o=s.isArray(h.key)?h.key:[h.key]:s.isArray(h.tag)?h.tag:[h.tag];var p={};o=s.reduce(o,function(e,s){return s=this.cleanUserString(s.split("-").join(" ")),p[s]||(p[s]=!0,e.push(s)),e}.bind(this),[])}if(h.sizeFilter)if(this._sizeFilterMaps){var v=this._sizeFilterMaps.sizesByLowerCaseId[h.sizeFilter.toLowerCase()];if(v){var w=v.str||"";d.sizeFilterMap=v,s.each(v.filters,(function(e){-1===n.indexOf(e)&&n.push(e)})),w&&(o=s.uniq(o.concat(w.split(" "))))}}else g.debug("requesting sizeFilter but unsupported:"+h.sizeFilter,e);if(h[m]){var b=this._getValidPctFilterStringFromValue(h[m],!0);if(""!==b&&(d.premiumFilter=b,n.length)){var _=n.indexOf(f);-1!==_&&n.splice(_,1)}}(n.length&&o.length&&(o=s.filter(o,(function(e){return-1===n.indexOf(e)}))),o.length?d.keywords=o:d.isFindAll=!0,n.length&&(d.tagFilters=s.map(n,function(e){var s=e.split(":"),t=s[0],r=s.length>1?s[1]:void 0;if(t===f)return this._getAPremiumTag({value:r});var i=t.split("-");if(i.length>1){var a=this._nonLangTagToFieldMap[i[0]];if(a)return{fields:[a],tag:t,tags:[t],id:t,keyword:i.slice(1).join("-"),value:r,needsLabel:!0,label:i.slice(1).join(" ")}}return{keyword:t,id:t,value:r}}.bind(this))),a=d.isFindAll?"":d.keywords.join(" "),d.analyticsData={searchTerm:a,trigger:i},c&&(this._options.searchPageAndVideoAsRelated&&("page"!==c.type&&"video"!==c.type||(d.assetId=null)),d.analyticsData.sparkFormat=c.type),s.isUndefined(h.fallbackThresh))||(l="default"===h.fallbackThresh?this._options.defaultFallbackThresh:1*h.fallbackThresh,!isNaN(l)&&l>=0&&(d.fallbackSearch={minResults:l}));return this._triggeredAutoSearchCallbackOptions={searchOptions:d,fieldSearchStr:a,appInfo:c,searchQuery:h},r&&r(this._triggeredAutoSearchCallbackOptions),this.getTemplateResults(d)},repeatSearch:function(e){var t=s.isUndefined(e.searchStr)?this._currentSearch.searchStr:e.searchStr,r=s.isUndefined(e.userStr)?this._currentSearch.userStr:e.userStr,i=e.forceApp?e.forceApp.app:this._currentSearch.app,a=e.options||this._currentSearch.options;e.deferForRender||this.callbacks.setSearchingForResults(!0,e),this._getSparkContentSearchResults(i,t,r,a,e).then(function(s){e.deferForRender?e.deferForRender.resolve(s):this.callbacks.renderCpSearchResults(s,{repeatOptions:e,hideProgressWhenRendered:!0})}.bind(this),(function(s){g.error("repeat search returned error",s),e.deferForRender&&e.deferForRender.reject(s)}))},getCurrentSearch:function(){return this._currentSearch},getSearchDataForRestore:function(e){return e},getCurrentSearchAnalytics:function(){return this._lastGetTemplateResultsAnalytics||{}},getLastTemplateResultsAnalyticsTriggerCategory:function(){this._lastGetTemplateResultsAnalytics||g.debug("no _lastGetTemplateResultsAnalytics in getLastTemplateResultsAnalyticsTriggerCategory");var e=this._lastGetTemplateResultsAnalytics.trigger;return _[e]||"templateSearch"},getDataForRestoringAfterRedraw:function(){return{_currentSearch:this._currentSearch,_tagsData:this._tagsData,_nextCursorHref:this._nextCursorHref,_remainingIds:this._remainingIds,_assets:this._assets,_lastGetTemplateResultsOptions:this._lastGetTemplateResultsOptions,_lastGetTemplateResultsAnalytics:this._lastGetTemplateResultsAnalytics}},restoreSearchAfterReRender:function(e){return e=e||{},s.assign(this,e.dataToRestore||{}),e.currentSearch||this._currentSearch},redisplayingCachedSearchResults:function(e){s.assign(this,e.returnOptions||{})},getTemplateResultsForOpeningEditor:function(e,t){var r={searchQuery:s.clone(t)};return r.searchQuery.app=e.typeName||e,this.triggerAutoSearch(r)},keysStrFromTagsArray:function(e,t){return s.map(e,(function(e){return e.split("-").slice(1).join(" ")})).join(s.isUndefined(t)?" ":t)},_getSearchTermForAnalytics:function(e,t){return s.isUndefined(e)&&(e=t||""),""===e?"searchTerm:none":e},_trackEvent:function(e,s){a.trackEvent(e,s||{},this._getAnalyticsPage())},_getAnalyticsPage:function(){var e=(this._options.context||"npw")+":search";return this._showingCpResults&&(e+="ResultsGrid"),e},_sendTemplateFeedViewedAnalyticsAndExtend:function(e,t,r){var i="notEntitled";if(this._options.allowPremiumTemplates&&(i=0,e.assets.length)){var a=0;if(s.each(e.assets,(function(e){e.isPremiumTemplate&&a++})),a)i=e.assets.length-a?Math.round(100*a/e.assets.length):100}var l="premiumToTotalTemplatePercent:"+i,o=_[r.trigger]||"templateSearch";this._trackEvent("templateFeedViewed",{contextualData3:"categoryName:"+o,contextualData4:l}),t.contextualData4=l},_areTagsListsDifferent:function(e,t){if(!e||!e.length)return!(!t||!t.length);if(!t||!t.length||t.length!==e.length)return!0;var r=s.reduce(e,(function(e,s){return e[s.keyword]=!0,e}),{});return!!s.find(t,(function(e){return!r[e.keyword]}))},isSearchDifferent:function(e){var s=!0;return this._lastGetTemplateResultsOptions&&((s=this._lastGetTemplateResultsOptions.searchString!==e.searchString)||(s=e.findAllType!==this._lastGetTemplateResultsOptions.findAllType||this._areTagsListsDifferent(e.tagFilters,this._lastGetTemplateResultsOptions.tagFilters))),s},getTemplateResults:function(e){var r=t.defer();this._lastGetTemplateResultsOptions=s.cloneDeep(e);var i,a,l=e.app,o="",n=!1;this._options.searchPageAndVideoAsRelated?l="post":l&&this._options.searchPageAndVideoAsRelated&&(l=null),e.user?(i=e.searchStr||"",o=e.userStr||i,a=e.user):e.findAllType?(i="",n=this._options.keysForTags):e.tags?(i=e.tags.join(" "),o=this.keysStrFromTagsArray(e.tags)):this._options.keysForTags?(n=!0,i=e.searchString||e.keywords&&e.keywords.join(" ")||""):i=o=e.keywords&&e.keywords.join(" ")||"",i=s.uniq(i.split(" ")).join(" "),this.callbacks.setSearchingForResults(!0,e);var h,c=s.assign({contextualData2:"searchStr:"+i},e.analyticsData);(c.searchTerm=this._getSearchTermForAnalytics(c.searchTerm,i),c.tagId?c.contextualData13="method:tag":c.contextualData13="method:search",e.tagFilters&&e.tagFilters.length)?h="["+s.map(e.tagFilters,(function(e){return e.keyword})).join(",")+"]":h="none";if(c.contextualData14="tagFilters:"+h,this._trackEvent("NPWVisualBrowseTemplateSearchTriggered",c),this._lastGetTemplateResultsAnalytics){var d=s.assign({},c,{numAssets:this._lastGetTemplateResultsAnalytics.numAssets,contextualData15:"prevTerm:"+this._lastGetTemplateResultsAnalytics.searchStr});this._showingCpResults&&this.searchResultsGridView&&this.searchResultsGridView.pagination&&(d.numSlides=this.searchResultsGridView.pagination.lastShowing),this._trackEvent("NPWVisualBrowseTemplateAdditionalSearch",d)}var u={field:"tags",keysOnly:n,assetId:e.assetId||e.jumpToDetailAssetId,sizeFilterMap:e.sizeFilterMap,user:a,tagFilters:e.tagFilters,contentSearch:!!e.contentSearch};if(e.limit&&(u.limit=e.limit,e.forceLowerLimit&&(u.forceLowerLimit=!0)),u.assetId&&e.assetIdApp&&(u.assetIdApp=e.assetIdApp),this._options.allowGiphyTemplates&&(u[w]="allow"),this._options.allowPremiumTemplates){var g,p,m=e.premiumFilter;if(i){var b=i.split(" ");g=-1!==b.indexOf(f)||-1!==b.indexOf(v)}else if("searchAllPremium"===e.findAllType)p=this._getAPremiumTag(),u.tagFilters?s.find(u.tagFilters,(function(e){return e.isPremium}))||u.tagFilters.push(p):u.tagFilters=[p];else if(u.tagFilters){var _=s.find(u.tagFilters,(function(e){return e.isPremium}));_&&(m="false"===_.value||!1===_.value?"hide":"only")}p||(m||(m="searchAllPremium"===e.findAllType?"only":this._options.premiumFilter),g&&"hide"!==m&&"only"!==m&&(m="pct:100"),u[v]=m)}else u[v]="hide";return this._getSparkContentSearchResults(l,i,o,u).then(function(i){var a,o;if(e.fallbackSearch&&i.total<=e.fallbackSearch.minResults){var n=e.fallbackSearch.fieldSearchStr||"";u.tagFilters=e.fallbackSearch.tagFilters||[],o=!0,e.fallbackSearch.triggered={fieldSearchStr:n,isFindAll:""===n},a=this._getSparkContentSearchResults(l,n,n,u)}else a=t(i);a.then(function(t){var i={numAssets:t.total};this._sendTemplateFeedViewedAnalyticsAndExtend(t,i,c),this._lastGetTemplateResultsAnalytics=s.assign({},c,i),this._trackEvent("NPWVisualBrowseTemplateSearchReturned",this._lastGetTemplateResultsAnalytics),e.addHistory&&!o&&this._addSearchHistoryAfterResults(t,e),r.resolve(t)}.bind(this))}.bind(this),(function(e){r.resolve({err:e||"unknown err"})})).done(),r.promise},_defaultSearchHistory:{searches:{}},_recalcSortedSearchHistory:function(){var e=s.map(this._searchHistory.savedHistory.searches,(function(e){return e}));e.sort((function(e,s){return s.d-e.d})),e.length>20&&e.splice(20),this._searchHistory.searches=e},getMySearchHistory:function(e){return this._initSearchHistory(),this._searchHistory},_initSearchHistory:function(){if(!this._searchHistoryInitted){try{var e=o.getProfile();e&&e.userId&&(this._storageKey="vb-tmpl-search-history-json_"+(new d).update(e.userId).digest("hex"))}catch(e){g.warn("error initting search history",e)}if(this._storageKey){var t;this._historyEnabled=!0;try{var r=window.localStorage.getItem(this._storageKey);r&&(t=JSON.parse(r))}catch(e){}t?t.searches=s.reduce(t.searches,(function(e,s,t){return t=t.toLowerCase(),(s.t||s.k)&&(e[t]=s),e}),{}):t=s.cloneDeep(this._defaultSearchHistory),this._searchHistory={savedHistory:t,searches:[]},this._recalcSortedSearchHistory()}}},_addSearchHistoryAfterResults:function(e,s){if(this._historyEnabled&&e.total&&s.searchString&&this._searchHistory){var t,r=s.searchString.toLowerCase(),i=this._searchHistory.savedHistory.searches[r],a={d:Date.now(),r:1,s:s.searchString};s.tags?a.t=s.tags:a.k=s.keywords,s.app&&(a.app="object"==typeof s.app?s.app.typeName:s.app),i&&(a.r=i.r+1),this._searchHistory.savedHistory.searches[a.s]=a,this._recalcSortedSearchHistory();try{t=JSON.stringify(this._searchHistory.savedHistory)}catch(e){g.error("error parsing json in addSearchHistory",{err:e,searchOptions:s})}if(t)try{window.localStorage.setItem(this._storageKey,t)}catch(e){g.warn("error saving to localStorage in addSearchHistory",e)}}},getHeroTemplateFromResults:function(e,t){if(!e||!e.assets||!e.assets.length)return null;if(this._options.allowPremiumTemplates&&"ifEntitled"===t.premium&&l.hasFeature("is-paid-user")){var r=s.find(e.assets,(function(e){return e.isPremiumTemplate}));return r||e.assets[0]}return s.find(e.assets,(function(e){return!e.isPremiumTemplate}))},_constantSearchType:"application/vnd.adobe.theo.document+dcx",_constantSearchTypeFilterString:'type:"application/vnd.adobe.theo.document+dcx"',_nonTagFieldsToSelect:["created","description","id","premium","remixCount","rendition","_score","title"],_fieldToTagMaps:{categories:"explore",colors:"spcolor",collections:"spcollect",influencers:"spinfluencer",ingredients:"spingred",locales:"sploc",styles:"spstyle",tasks:"spcase",topics:"spterm"},_aggsFieldsToRequest:["categories","colors","collections","influencers","ingredients","styles","tasks","topics"],getFieldToMapKey:function(e){return this._fieldToTagMaps[e]||"unk"},_labelFromTagKey:function(e){return e.split("-").join(" ")},_tagsDataFromSparkContentResults:function(e,t,r){r=r||{};var i,a={},l=0;t&&(i=s.reduce(t,(function(e,s,t){return s.selected=!0,s.isFilter=!0,s.needsLabel?(a[s.id]={tag:s,index:t},l++):e[s.id]={index:t,tag:s},e}),{}));var o,n=[],h={},c=(e.options.keysOnly,[]),d=[];if(e.aggregations){var u={};if(!e.aggregations.processed){var g=e.aggregations;g.length||(g=[g]),s.each(g,function(e){s.each(e,function(e,t){if(e.buckets&&e.buckets.length){var r=this._fieldToTagMapsNoLoc[t];r?s.each(e.buckets,function(e){var s=e.key.split(" ").join("-");if(s){var t=e.label||this._labelFromTagKey(s),o=u[t],n=r+"-"+s;if(o)o.numAssets+=e.docCount,-1===o.fields.indexOf(r)&&o.fields.push(r),-1===o.tags.indexOf(n)&&o.tags.push(n);else{var h={numAssets:e.docCount,id:t,label:t,key:s,srcKey:s,keyword:s,fields:[r],tags:[n],tag:n,aggregateType:"only",assets:[]};u[t]=h}if(l&&a[n]){var c=a[n];c.tag.id=t,c.tag.needsLabel=!1,i[c.tag.id]=c,--l&&delete a[n]}}}.bind(this)):window.marvel.logger.debug("unknown aggId in _tagsDataFromSparkContentResults")}}.bind(this))}.bind(this)),e.aggregations={aggTags:u,processed:!0}}o=s.cloneDeep(e.aggregations.aggTags),h=o}if(s.each(e.assets,function(e){e.originalTags=e.tags,e.tags=[],e.premium&&(d.push(e),e.isPremiumTemplate=!0),s.each(this._fieldToTagMaps,function(t,r){s.each(e[r],function(s){if(""!==s){s=s.split(" ").join("-");var i=t+"-"+s;"locales"!==r?e.tags.push(i):e.sploc=i}}.bind(this))}.bind(this))}.bind(this)),s.each(h,function(e,t){n.push(e),e.selected=!1,e.aggregateType?"inResult"===e.aggregateType&&(e.numAssets=Math.max(e.assets.length,e.numAssets)):e.numAssets=e.assets.length,e.fields=s.uniq(e.fields),this._calcTagSuggestPriority(e)}.bind(this)),c=s.compact(c),i&&(n=s.filter(n,(function(e){var s=i[e.id];return s?(t[s.index]=e,e.selected=!0,e.isFilter=!0):e.isFilter=!1,e.isSearchTerm=!1,!e.isFilter})),c=s.filter(c,(function(e){var s=i[e.id];return s?(t[s.index]=e,e.selected=!0,e.isFilter=!0):e.isFilter=!1,e.isSearchTerm=!e.isFilter,!e.isFilter})),s.each(t,(function(e){h[e.id]||(h[e.id]=e)}))),n.sort(this.sortTagsInOrder),d.length){var p=-1!==e.searchStr.split(" ").indexOf(f),m=i&&i[f]&&i[f].tag,v=m;v||(v=this._getAPremiumTag({selected:p})),v.assets=d,v.numAssets=d.length,h[f]=v,m||(v.selected?c.unshift(v):n.unshift(v))}return s.assign(e.tagsData,{tags:h,tagsInOrder:n,hiddenTagsInOrder:c,tagFilters:t}),e.tagsData},_processQueryPostResults:function(e){var t=0,r=0,i=[];return s.each(e,function(e){var s=e.srcPart;if(e.err)window.marvel.logger.error("Error with split query: "+s.sendOptions.q,e.err),s.data=this._getEmptyResultsObj();else if(s.doingNumFromFirst){s.doingNumFromFirst=!1;var a=s.data._embedded.results;s.data=e.value;var l={};s.data._embedded.results=a.concat(s.data._embedded.results).filter((function(e){if(!l[e.id])return l[e.id]=!0,!0})),s.data._embedded.count=s.data._embedded.results.length}else s.data=e.value,s.data._embedded.aggregations&&i.push(s.data._embedded.aggregations);s.total=s.data._embedded.total,t+=s.total,s.nextIndex=0,s.totalPulled+=s.data._embedded.count,s.numRemaining=s.total-s.totalPulled,s.nextHref=s.data._links&&s.data._links.next&&s.data._links.next.href,s.nextHref&&(s.nextBody=s.data._links.next.body),s.nextHref?s.numRemaining||(s.numRemaining=1):s.numRemaining=0,r+=s.numRemaining}.bind(this)),{total:t,numRemaining:r,aggregations:i.length&&i}},_setupSplitQueries:function(e,t,r,i,a){var l=t&&t[0],o=[],n=function(e,t){var a=t&&i.limit||1,n=s.cloneDeep(i),h={sendOptions:n,totalPulled:0},c={};if(e&&n.filters&&(n.filters=n.filters.replace(l,e)),r){var d=s.cloneDeep(n);n.filters?n.filters+=" AND premium:false":n.filters="premium:false",d.filters?d.filters+=" AND premium:true":d.filters="premium:true",h.interleave=r.free;var u=[h];u.push({sendOptions:d,interleave:r.premium,totalPulled:0}),s.each(u,function(e){o.push({sendOptions:this._getSparkContentQueryTotalSendOptions(e.sendOptions,a),srcPart:e})}.bind(this)),c.parts=u}else c.single=h,o.push({sendOptions:this._getSparkContentQueryTotalSendOptions(h.sendOptions,a),srcPart:h});return c}.bind(this),h=[];t?s.each(t,(function(e,s){h.push(n(e,!s))})):h.push(n(null,!0));var c={queries:h};return c.currentQuery=c.queries[0],a&&o.push({sendOptions:this._getAssetIdQueryData(a),srcPart:{assetId:a}}),this._sendSparkContentQueryPostArray(o).then(function(t){if(a){var r=t.pop(),l=r&&r.value._embedded.results[0];l&&(c.assetIdResult=this._processOneSparkContentAsset(l))}var o=this._processQueryPostResults(t);c.initialTotal=o.total,c.numRemaining=o.numRemaining,c.aggregations=o.aggregations,c.queries=s.filter(c.queries,function(e){return e===c.currentQuery||(e.single?!!e.single.total&&(e.single.numFromFirst=e.single.data._embedded.results.length,e.single.numRemaining+=e.single.numFromFirst,void(c.numRemaining+=e.single.numFromFirst)):(e.parts=s.filter(e.parts,(function(e){return!!e.total&&(e.numFromFirst=e.data._embedded.results.length,e.numRemaining+=e.numFromFirst,c.numRemaining+=e.numFromFirst,!0)})),!!e.parts.length&&(1===e.parts.length&&(e.single=e.parts[0],e.parts=null),!0)))}.bind(this)),e.splitQuery=c,e.targetTotal=i.limit}.bind(this))},_doNextSplitQuery:function(e,r,i){var a=i.splitQuery,l=r.targetTotal-this._assets.assetsArray.length;if(!a.currentQuery)return t.reject({errorMessage:"no more records for split query"});if(!a.currentQuery.single){var o=s.filter(a.currentQuery.parts,(function(e){return e.numRemaining>0&&e.nextHref}));a.currentQuery.parts=o,1===o.length&&(a.currentQuery.single=o[0])}var n=[];return a.currentQuery.single?n.push({sendOptions:this._getSplitCursorQuerySendOptions(a.currentQuery.single,l),srcPart:a.currentQuery.single}):s.each(a.currentQuery.parts,function(e){n.push({sendOptions:this._getSplitCursorQuerySendOptions(e,l),srcPart:e})}.bind(this)),this._sendSparkContentQueryPostArray(n).then(function(s){return this._processQueryPostResults(s),this._processSplitQuery(e,r,i)}.bind(this))},cleanUserString:function(e){return e.replace(/[.,\/#!$%\^&\*;:{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()},_cleanUserStringAllowColon:function(e){return e.replace(/[.,\/#!$%\^&\*;{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()},_getSingularIfPlural:function(e){if(u.isPlural(e)){var s=u.singular(e);if(s!==e)return s}return""},_requestFieldIdFromFieldId:function(e){return this._nonLangTagToFieldMap[e]||e},_getFiltersFromTagFilters:function(e){var t={filterDisplayStrArray:[]};return t.filters=s.reduce(e,function(e,r){if(r.isPremium)t.premiumTagFilter=r;else{var i=r.keyword.split("-"),a='"'+i.join(" ")+'"';if(r.fields)if(r.fields.length>1){var l=s.map(r.fields,function(e){return this._requestFieldIdFromFieldId(e)+":"+a}.bind(this));a="("+l.join(" OR ")+")"}else a=this._requestFieldIdFromFieldId(r.fields[0])+":"+a;t.filterDisplayStrArray.push(r.label||i.join(" ")),e.push(a)}return e}.bind(this),[]),t},_getSparkContentSearchResults:function(e,t,r,a,o){var n,d=l.hasFeature("npw-vb-search-scs-fuzzy")&&"~1";if((o=o||{isFirstQuery:!0,totalPulled:0}).extraResults)return this._preSparkContentSearchTemplateResults(a,this._currentSearch,o);"string"==typeof e&&(e=h.getAppByType(e)),a.user&&window.marvel.logger.debug("asking for user in _getSparkContentSearchResults:"+a.user),t&&(t=this.cleanUserString(t)),a.limit&&o.isFirstQuery?(n=a.limit)<1?n=1:n>100?n=100:a.forceLowerLimit||(n=Math.max(n,40)):n=o.isFirstQuery?80:o.targetTotal;var u,g,m,_,x={searchStr:t,userStr:r,app:e,options:a,splitQuery:o.splitQuery,totalPulled:o.totalPulled,targetTotal:n};if(this._currentSearch=x,o.splitQuery)return this._doNextSplitQuery(a,x,o);if(o.loadNext){var y=x.targetTotal-this._assets.assetsArray.length;y<40&&(y=40);var S=c.parse(this._nextCursorHref,!0);S.protocol="https",S.host=this._options.searchHost,S.query.limit=y,S.search="",u=c.format(S)}else{var k=!this._sparkContentSearchAllFields,C=a[v],T=[];if(t){var R=t.split(" "),F=R.indexOf(f);-1!==F&&R.splice(F,1),d&&(R=s.map(R,(function(e){return e.length>=3?e+d:e}))),t=R.join(" ")}var I=""!==t;if(a.tagFilters&&a.tagFilters.length){var A,D=[],P=s.reduce(a.tagFilters,function(e,t){if(t.isPremium)A=t;else if(t.tags){var r=s.reduce(t.tags,function(e,s){var t=s.split("-"),r=this._nonLangTagToFieldMap[t[0]],i=e[r];return i||(i=[],e[r]=i),i.push(t.slice(1).join("-")),e}.bind(this),{}),i=s.reduce(r,(function(e,s,t){var r=t+":";return 1===s.length?r+='"'+s[0]+'"':r+='("'+s.join('" OR "')+'")',e.push(r),e}),[]);1===i.length?e.push(i[0]):e.push("("+i.join(" OR ")+")"),D.push(t.label)}else{window.marvel.logger.debug("no tags for tag filter",t);var a=t.keyword.split("-"),l='"'+a.join(" ")+'"';if(t.fields)if(t.fields.length>1){var o=s.map(t.fields,(function(e){return e+":"+l}));l="("+o.join(" OR ")+")"}else l=t.fields[0]+":"+l;D.push(t.label||a.join(" ")),e.push(l)}return e}.bind(this),[]);A&&D.shift(A.label||A.keyword),D.length&&(x.filtersDisplayStr=D.join(", ")),P.length&&(T=T.concat(P)),A&&"hide"!==C&&"pct:0"!==C&&(C="only")}if(a.sizeFilterMap){var O=a.sizeFilterMap.aspectGroup?a.sizeFilterMap.aspectGroup.sizeQueryString:a.sizeFilterMap.sizeQueryString;O&&T.push(O)}-1!==(m={q:t||"",limit:x.targetTotal,select:this._allFieldsToSelect.join(",")}).q.indexOf(p)&&(m.q=m.q.split(p).join("")),k&&(m.searchIn=this._nonLangTagFieldIds.join(",")),m.aggs=this._aggsFieldsToRequest.join(","),m.aggsLimit=10;var $,L=I&&["-_score"]||[];if(l.hasFeature("npw-vb-search-scs-sort-score-by-remix-count-over-created")||L.push("-created"),L.push("-remixCount"),C&&"hide"!==C&&"pct:0"!==C){if("pct:100"===C||"only"===C)$="premium:true";else if(0===C.indexOf("pct:"))if(l.hasFeature("npw-vb-search-scs-no-split-query-for-premium-freq"))m.premiumFreq=2;else{var M=1,z=1,B=C.split(":");if(2===B.length){var E=1*B[1];isNaN(E)||E>0&&E<100&&50!==E&&(E<50?M=Math.min(Math.round(100/E)-1,10):z=Math.min(Math.round(100/(100-E))-1,10))}else 3===B.length&&(z=Math.round(1*B[1]),M=Math.round(1*B[2]),isNaN(z)||(z>10?z=10:z<1&&(z=1)),isNaN(M)||(M>10?M=10:M<1&&(M=1)));_={free:M,premium:z}}}else $="NOT premium:true";$&&T.push($),"allow"!==a[w]&&T.push("NOT ingredients:"+b);var N=i.getLocale(),V=N.split("-")[0],G=V+"*",H=!1;if(m.qLoc=N,"en"!==V&&!l.hasFeature("npw-vb-search-scs-no-en-fallback")&&((m.premiumFreq||_)&&l.hasFeature("npw-vb-search-scs-split-query-for-premium-locales")&&(H=!0),!H)){G="("+G+" OR en*)";var j="locales";V>"en"&&(j="-"+j),L.unshift(j)}G&&(H&&(g=["locales:"+G,"locales:en*"]),T.push("locales:"+G)),this._constantSearchTypeFilterString&&T.push(this._constantSearchTypeFilterString),T.length&&(m.filters=T.join(" AND ")),m.orderBy=L.join(","),m.q||(m.q="*"),u=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix,query:m})}return g||_?this._setupSplitQueries(o,g,_,m,a.assetId).then(function(){return this._processSplitQuery(a,x,o)}.bind(this)):(a.assetId&&!o.loadNext&&(this._fixSendOptionsJsonForPost(m),u={sendOptions:m,assetId:a.assetId}),this._doSparkContentQuery(u,a,x,o))},_getEmptyResultsObj:function(e){return{_embedded:{count:0,results:[],total:0},_links:{self:{href:e}}}},_addAssetAsFirstAsset:function(e,t){t.assetsArray.unshift(e),t.assetsById[e.id]=e,s.each(t.assetsArray,(function(e,s){e._orderedIndex=s})),this._addAllTagsToAsset(e)},_addMappedAssetToAssetsObj:function(e,s){s=s||this._assets;var t=this._options.VisualBrowseUseCasesController.getAssetFromData({asset:{id:e,app:"post"}});return t&&t.app&&this._addAssetAsFirstAsset(t,s),t},_cleanupSplitQueriesAfterProcess:function(e){var t=0;e.queries=s.filter(e.queries,(function(e){if(e.single)e.numRemaining=e.single.numRemaining;else{e.numRemaining=0;var r=s.filter(e.parts,(function(s){return e.numRemaining+=s.numRemaining,s.nextHref}));e.numRemaining&&(1===r.length?e.single=r[0]:e.parts=r)}return t+=e.numRemaining,e.numRemaining})),e.currentQuery=e.queries[0],e.hasMoreQueries=e.queries.length>1,e.numRemaining=t},_processSplitQuery:function(e,s,r){s.splitQuery=r.splitQuery;var i=t.defer();return this._preSparkContentSearchTemplateResults(null,s,r).then(function(t){if(this._assets={assetsArray:t.assets,assetsById:t.assetsById},e.assetId&&!t.assetsById[e.assetId])if(s.splitQuery&&s.splitQuery.assetIdResult)this._addAssetAsFirstAsset(s.splitQuery.assetIdResult,this._assets);else{var a=this._addMappedAssetToAssetsObj(e.assetId,this._assets);a&&(this._assets.assetsById[a.id]=a)}this._tagsData=t.tagsData,this._cleanupSplitQueriesAfterProcess(s.splitQuery),t.hasMore=!!s.splitQuery.currentQuery,t.total=this._assets.assetsArray.length+s.splitQuery.numRemaining,s.extraResults&&(t.total+=s.extraResults.assets.length),this._assets.assetsArray.length>=s.targetTotal?i.resolve(t):s.splitQuery.numRemaining?this._doNextSplitQuery(e,s,r).then((function(e){i.resolve(e)})):i.resolve(t)}.bind(this)),i.promise},_getAssetIdQueryData:function(e){return{limit:1,filters:'id:"'+e+'"'}},_moveAssetToBeginningOfArray:function(e,t){return s.find(t,(function(s,r){if(s.id===e){var i=t.splice(r,1);return t.unshift(i[0]),!0}}))},_doSparkContentQuery:function(e,s,r,i){var a,l=t.defer();if(e.assetId){var o={main:e.sendOptions,asset:this._getAssetIdQueryData(e.assetId)};a=this._sendSparkContentQueryPost(null,o).then(function(e){var s;try{if(s=e._embedded.asset._embedded.results[0])this._moveAssetToBeginningOfArray(s.id,e._embedded.main._embedded.results)||(e._embedded.main._embedded.results.unshift(s),e._embedded.main._embedded.total++)}catch(e){}return e._embedded.main}.bind(this))}else a=this._sendSparkContentQuery(e);return a.then(function(e){var t=this._nextCursorHref,a=(i.totalPulled||0)+e._embedded.count;this._nextCursorHref=e._links&&e._links.next&&e._links.next.href,e.hasMore=!!this._nextCursorHref,e.totalPulled=a,r.totalPulled=a,e.numRemaining=e._embedded.total-e.totalPulled,this._preSparkContentSearchTemplateResults(e,r,i).then(function(o){if(this._assets={assetsArray:e.assets,assetsById:e.assetsById},s.assetId&&!e.assetsById[s.assetId]&&this._addMappedAssetToAssetsObj(s.assetId,this._assets),this._tagsData=e.tagsData,i&&i.numRepeats&&i.numRepeats>3)t===this._nextCursorHref&&t&&(this._nextCursorHref=null,o.hasMore=!1,window.marvel.logger.error("[SearcRequestController] cursor not updating:"+t)),l.resolve(o);else if(this._assets.assetsArray.length>=r.targetTotal)l.resolve(o);else if(this._nextCursorHref){var n=i&&i.numRepeats||0;this.repeatSearch({loadNext:!0,numRepeats:n+1,deferForRender:l,targetTotal:r.targetTotal,totalPulled:a})}else l.resolve(o)}.bind(this))}.bind(this),function(e){l.reject(e)}.bind(this)).done(),l.promise},_sentUrls:[],_sendSparkContentQuery:function(s){var r=t.defer();return this._sentUrls.push(s),window.marvel.logger.debug("sendSparkContentQuery:"+s),e.ajax({type:"GET",url:s,headers:{"X-Api-Key":n.sparkContentSearchApiKey,Accept:"application/hal+json"},success:function(e,s,t){r.resolve(e)}.bind(this),error:function(e,s,t){window.marvel.logger.error("[SearcRequestController] Errored out while attempting to get query count from content service: ["+e.status+"]",e.responseJSON||e.responseText),r.reject(e)}.bind(this)},null,!0),r.promise},_sendSparkContentQueryPostArray:function(e){var r={},i=0,a=[],l=s.reduce(e,(function(e,s,t){var a=s.sendOptions;return a.fulfilledData?r["r"+t]=a.fulfilledData:(e["r"+t]=a,i++),e}),{});return i?this._sendSparkContentQueryPost(null,l).then(function(t){var i=t._links&&t._links.next&&t._links.next.body;return s.each(e,(function(e,s){var l="r"+s,o=r[l];if(!o){var n=(o=t._embedded[l]).nextBody||i&&i[l];n&&(o._links.next.body=n)}a.push({value:o,srcPart:e.srcPart})})),a}.bind(this),(function(e){return t.reject(e)})):(s.each(e,(function(e,s){a.push({value:r["r"+s],srcPart:e.srcPart})})),t.resolve(a))},_sendSparkContentQueryPostArraySimple:function(e){var r=[];if(!e.length)return t.resolve(r);var i=s.reduce(e,(function(e,s,t){return e["r"+t]=s,e}),{});return this._sendSparkContentQueryPost(null,i).then(function(t){var i=t._links&&t._links.next&&t._links.next.body;return s.each(e,(function(e,s){var a="r"+s,l=t._embedded[a];if(l){var o=l.nextBody||i&&i[a];o&&(l._links.next.body=o)}r.push(l)})),r}.bind(this),(function(e){return t.reject(e)}))},_sendSparkContentQueryPost:function(s,r){s||(s=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix}));var i=t.defer();return e.ajax({method:"POST",data:JSON.stringify(r),url:s,dataType:"json",contentType:"application/json",headers:{"X-Api-Key":n.sparkContentSearchApiKey,Accept:"application/hal+json"},success:function(e,s,t){i.resolve(e)}.bind(this),error:function(e,s,t){window.marvel.logger.error("[SearcRequestController] Errored out querying content service: ["+e.status+"]",{response:e.responseJSON||e.responseText||e.statusText,requestData:r}),i.reject(e)}.bind(this)},null,!0),i.promise},_sendBatchQuery:function(e){return this._sendSparkContentQuery(e,"POST")},doAggregatesFromFragmentsQuery:function(e,t){var r,a=(t=t||{}).locale||i.getLocale(),l=[],o=a,n={qLoc:a,limit:0,aggs:this._aggsFieldsToRequest,aggsLimit:t.aggsLimit||5};t.tagFilters&&(r=this._getFiltersFromTagFilters(t.tagFilters))&&r.filters&&r.filters.length&&(l=l.concat(r.filters)),t.langOnly?o.length>2&&(o=o.substring(0,2)+"*"):o=o.toLowerCase(),t.includeEnglishIfNonEnglish&&"en-us"!==a.toLowerCase()&&(t.langOnly?o+=" OR en*":o+=" OR en-us",o="("+o+")"),l.push("locales:"+o),this._options.allowPremiumTemplates||l.push("premium:false"),this._constantSearchTypeFilterString&&l.push(this._constantSearchTypeFilterString),n.filters=l.join(" AND ");var h=t.calcAggsForAllFragments?e:e.slice(0,1),c=s.map(h,(function(e){return s.assign({q:e||"*"},n)}));return this._sendSparkContentQueryPostArraySimple(c).then(function(r){var i=s.map(h,function(e,s){var i=r[s]._embedded;return{str:e,totalResults:i.total,tagsInOrder:this._tagsInOrderFromOneAggsSet(i.aggregations,!s&&t.prependPremium)}}.bind(this));return!t.calcAggsForAllFragments&&e.length>1&&(i=this.appendFragStringEmptyAggsToArray(i,e,1)),i}.bind(this))},appendFragStringEmptyAggsToArray:function(e,t,r){var i=e.slice(0);return s.map(t.slice(r),(function(e){i.push({str:e,totalResults:-1})})),0===r&&(i[0].tagsInOrder=[]),i},_calcTagSuggestPriority:function(e){1===e.fields.length&&"explore"===e.fields[0]?e.suggestSortPriority=-1:e.suggestSortPriority=1},sortTagsInOrder:function(e,s){return e.suggestSortPriority!==s.suggestSortPriority?e.suggestSortPriority>s.suggestSortPriority?-1:1:s.numAssets-e.numAssets},_tagsInOrderFromOneAggsSet:function(e,t){var r={},i=[],a={};return s.each(e,function(e,t){if(e.buckets&&e.buckets.length){var l=this._fieldToTagMapsNoLoc[t];l?s.each(e.buckets,function(e){var s=e.key.split(" ").join("-");if(s){var t=e.label||this._labelFromTagKey(s),o=r[t],n=l+"-"+s;if(o)o.numAssets+=e.docCount,-1===o.fields.indexOf(l)&&o.fields.push(l),-1===o.tags.indexOf(n)&&o.tags.push(n);else{var h={numAssets:e.docCount,id:t,label:t,key:s,keyword:s,srcKey:s,fields:[],tag:n,tags:[n]};r[h.id]=h,i.push(h),a[h.id]&&window.marvel.logger.debug("duped aggTag:"+h.id),a[h.id]=h,h.fields.push(l)}}}.bind(this)):window.marvel.logger.debug("unknown aggId in _tagsInOrderFromOneAggsSet")}}.bind(this)),i.forEach(this._calcTagSuggestPriority),i.sort(this.sortTagsInOrder),t&&i.unshift(this._getAPremiumTag()),i},_getSplitCursorQuerySendOptions:function(e,s){if(e.numFromFirst){if(!e.nextBody||e.numFromFirst>=s)return e.numFromFirst=0,{fulfilledData:e.data};s-=e.numFromFirst}return e.forceLowerLimit?s=Math.max(0,s):s<40&&(s=40),e.numFromFirst?(e.numPulled-=e.numFromFirst,e.numFromFirst=0,e.doingNumFromFirst=!0,this._extendSplitCursorQuerySendOptions(e.nextBody,s)):this._extendSplitCursorQuerySendOptions(e.nextBody,s)},_getSparkContentQueryTotal:function(e,t){(e=s.cloneDeep(e)).limit=t||1;var r=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix,query:e});return this._sendSparkContentQuery(r)},_fixSendOptionsJsonForPost:function(e){s.each(["orderBy","aggs","select"],(function(s){e[s]&&(e[s]=e[s].split(","))}))},_getSparkContentQueryTotalSendOptions:function(e,t){return e=s.cloneDeep(e),this._fixSendOptionsJsonForPost(e),e.limit=t||1,e},_extendSplitCursorQuerySendOptions:function(e,t){return(e=s.cloneDeep(e)).limit=t||1,e},_processOneSparkContentAsset:function(e){if(this._badAssets.count&&this._badAssets.ids[e.id])return null;e.tags=[],s.each(this._fieldToTagMaps,(function(t,r){s.each(e[r],(function(s){s&&e.tags.push(t+"-"+s)}))}));var t=this._constantSearchType||"";return e.app=this._options.VisualBrowseAndSearchAppsController.getAppType(e.type||t),e.templatedImgHref=e.rendition.href,e.width=e.rendition.maxWidth,e.height=e.rendition.maxHeight,e},_interleaveParts:function(e){for(var s=[],t=e;t.length>1;){for(var r=[],i=0;i<t.length;i++){var a=t[i];a.nextIndex<a.assets.length&&(1===a.interleave?(s.push(a.assets[a.nextIndex]),a.nextIndex++):(s=s.concat(a.assets.slice(a.nextIndex,a.nextIndex+a.interleave)),a.nextIndex+=a.interleave),a.nextIndex<a.assets.length&&r.push(a))}t=r}if(t.length){var l=t[0];s=s.concat(l.assets.slice(l.nextIndex)),l.nextIndex=l.assets.length}return s},_preSparkContentSearchTemplateResults:function(e,r,i){var a,l=(i=i||{}).extraResults;if(i.isFirstQuery?a=i.splitQuery?i.splitQuery.aggregations:e._embedded&&e._embedded.aggregations:(a=i.aggregations,this._badAssets.count&&(this._assets.assetsArray=s.filter(this._assets.assetsArray,function(e){return!this._badAssets.ids[e.id]&&e}.bind(this)))),l){e=l.resultsData;var o,n=i.targetTotal-this._assets.assetsArray.length;n>l.assets.length?(o=l.assets,i.extraResults=null,r.extraResults=null):(o=l.assets.splice(0,n),0===l.assets.length&&(i.extraResults=null,r.extraResults=null)),this._assets.assetsArray=this._assets.assetsArray.concat(o),e.assets=this._assets.assetsArray}else{if(i.splitQuery&&i.splitQuery.currentQuery?(i.splitQuery.currentQuery.single?(e=i.splitQuery.currentQuery.single.data).assets=s.filter(e._embedded.results,this._processOneSparkContentAsset):(e=i.splitQuery.currentQuery.parts[0].data,s.each(i.splitQuery.currentQuery.parts,function(e){e.assets=s.filter(e.data._embedded.results,this._processOneSparkContentAsset)}.bind(this)),e.assets=this._interleaveParts(i.splitQuery.currentQuery.parts)),e.hasMore=i.splitQuery.numRemaining>0):e.assets=s.filter(e._embedded.results,this._processOneSparkContentAsset),s.extend(e,r),e.tagsData={},i.isFirstQuery)e.tagsData.keysForTags=this._options.keysForTags,e.total=e._embedded.total,i.isFirstQuery=!1;else{var h=e._embedded.total-e._embedded.count;e.assets=this._combineResultAssets(e.assets),e.total=e.assets.length+h,e.tagsData=this._tagsData}e.assets.length>i.targetTotal?r.extraResults={assets:e.assets.splice(i.targetTotal),resultsData:s.clone(e)}:r.extraResults=null}var c=e.assets.length;return i.splitQuery?c+=i.splitQuery.numRemaining:e.numRemaining&&(c+=e.numRemaining),r.extraResults&&(c+=r.extraResults.assets.length),e.total=c,e.aggregations=a,this._assignTagsDataToResults(e,r,i),r.aggregations=e.aggregations,i.aggregations=e.aggregations,this._options.favoritesEnabled?this._options.VisualBrowseUseCasesController.applyFavoritesToSearchResults(e).then((function(e){return e})):t.resolve(e)}});return x.requiredCallbackNames=["setSearchingForResults","renderCpSearchResults"],x}.apply(s,r))||(e.exports=i)},902:function(e){e.exports=JSON.parse('{"sizeRangeForEquality":0.01,"maps":{"Instagram":{"filters":["instagram"]},"InstagramStory":{"filters":["instagram-story"]},"InstagramPortrait":{"filters":["instagram"]},"InstagramLandscape":{"filters":["instagram"]},"Facebook":{"filters":["facebook"]},"Pinterest":{"filters":["pinterest"]},"YouTubeThumbnail":{"filters":["youtube"],"str":"thumbnail"},"LinkedInBlogPost":{"filters":["linkedin"]},"SnapchatStory":{"filters":[],"str":"snapchat"},"Twitter":{"filters":["twitter"]},"Letter":{"filters":["letter"]},"Poster":{"filters":["poster"]},"Card":{"filters":["card"]},"A5":{},"A4":{},"A3":{},"FacebookProfileCover":{"filters":["facebook"],"str":"profile cover"},"FacebookPageCover":{"filters":["facebook"]},"FacebookEventCover":{"filters":["facebook"],"str":"event cover"},"YouTubeChannelArt":{"filters":["youtube"]},"TwitchBanner":{"filters":["twitch"]},"TwitterHeader":{"filters":["twitter"],"str":"header"},"EtsyCover":{"filters":["etsy"]},"LinkedInProfileCover":{"filters":["linkedin"],"str":"profile"},"EventbriteEventImage":{"filters":["eventbrite"]},"iPhone":{"filters":["iphone"]},"Square":{},"3:2":{},"4:3":{},"16:9":{},"2:3":{},"3:1":{},"2:1":{},"1:2":{},"SparkVideoSlide":{},"SparkVideoSlideSquare":{},"KindleCover":{"filters":["kindle"]},"BlogPost":{"filters":["blog"]}}}')}}]);
//# sourceMappingURL=search-controller-d680672a.js.map